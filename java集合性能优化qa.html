<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-10T01:07:28.8510573"><title>Java集合性能优化QA | 技术知识库</title><script type="application/json" id="virtual-toc-data">[{"id":"p99j0i_4","level":0,"title":"📋 知识结构","anchor":"#p99j0i_4"},{"id":"p99j0i_5","level":0,"title":"🎯 集合选择策略","anchor":"#p99j0i_5"},{"id":"p99j0i_6","level":0,"title":"💡 面试技巧","anchor":"#p99j0i_6"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Java集合性能优化QA | 技术知识库"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术知识库 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/java集合性能优化qa.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Java集合性能优化QA | 技术知识库"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/java集合性能优化qa.html#webpage",
    "url": "writerside-documentation/java集合性能优化qa.html",
    "name": "Java集合性能优化QA | 技术知识库",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术知识库 Help"
}</script><!-- End Schema.org --></head><body data-id="Java集合性能优化QA" data-main-title="Java集合性能优化QA" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Java集合面试大纲.md|Java集合面试大纲"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术知识库  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Java集合性能优化QA" id="Java集合性能优化QA.md">Java集合性能优化QA</h1><p id="p99j0i_3">深入探讨Java集合的性能优化策略，包括集合选择原则、容量规划、内存优化和并发性能调优等方面。</p><section class="chapter"><h2 id="p99j0i_4" data-toc="p99j0i_4">📋 知识结构</h2><svg aria-roledescription="mindmap" role="graphics-document document" viewBox="5 5 735.7496337890625 401.7503356933594" style="max-width: 735.7496337890625px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g></g><g class="mindmap-edges"><path class="edge section-edge-0 edge-depth-1" d="M 535.7699927570416,126.00579282375023 L 518.9935452878916,94.15559429017159 L502.2170978187416,62.30539575659296"></path><path class="edge section-edge-0 edge-depth-1" d="M 553.6957945230408,129.00991877167056 L 584.6300401908641,99.96511619052544 L615.5642858586873,70.9203136093803"></path><path class="edge section-edge-0 edge-depth-1" d="M 557.6752033973021,137.68000384886352 L 615.4776919960287,131.4896224804784 L673.2801805947554,125.2992411120933"></path><path class="edge section-edge-0 edge-depth-1" d="M 556.5847482959513,145.09880558470832 L 614.7732206133205,169.6024333944703 L672.9616929306898,194.10606120423228"></path><path class="edge section-edge-0 edge-depth-0" d="M 391.14170967799964,196.86442433155628 L 459.9397934975449,170.7338639103495 L528.7378773170901,144.60330348914277"></path><path class="edge section-edge-1 edge-depth-1" d="M 461.5805369573907,290.3243072913667 L 526.9039285917111,304.8711306954333 L592.2273202260315,319.41795409949987"></path><path class="edge section-edge-1 edge-depth-1" d="M 460.0817989233775,279.83392387289547 L 501.1816818443597,257.22439299894876 L542.2815647653418,234.61486212500208"></path><path class="edge section-edge-1 edge-depth-1" d="M 434.51062653900243,295.4621091636661 L 398.5601437428269,319.7547232617935 L362.60966094665133,344.0473373599209"></path><path class="edge section-edge-1 edge-depth-1" d="M 452.29571890206233,301.0748110988594 L 464.293478553877,332.45708495948725 L476.2912382056916,363.8393588201151"></path><path class="edge section-edge-1 edge-depth-0" d="M 386.64854983547184,213.77444616123597 L 412.0291383405656,244.62712998573383 L437.4097268456594,275.4798138102317"></path><path class="edge section-edge-2 edge-depth-1" d="M 232.1070894703787,287.8443088676103 L 222.7191950911627,320.44662395674686 L213.3313007119467,353.0489390458834"></path><path class="edge section-edge-2 edge-depth-1" d="M 232.88980843605992,258.8129822251695 L 226.35768994213578,230.46300254048344 L219.82557144821163,202.1130228557974"></path><path class="edge section-edge-2 edge-depth-1" d="M 221.63594046022078,270.082806855769 L 159.09920553532822,255.76699898532246 L96.56247061043567,241.45119111487594"></path><path class="edge section-edge-2 edge-depth-1" d="M 221.8043944430708,277.4426693090112 L 155.15885833299393,295.9454419260933 L88.51332222291705,314.44821454317537"></path><path class="edge section-edge-2 edge-depth-0" d="M 363.73357492467113,208.96005222739973 L 306.6884055694741,237.8102132651931 L249.64323621427712,266.6603743029865"></path><path class="edge section-edge-3 edge-depth-1" d="M 269.1173739833025,111.47120206410315 L 232.7360687854711,84.01407104735559 L196.3547635876397,56.55694003060804"></path><path class="edge section-edge-3 edge-depth-1" d="M 288.7157486944204,107.59007827376263 L 306.6540186615483,77.20360483190112 L324.5922886286762,46.817131390039606"></path><path class="edge section-edge-3 edge-depth-1" d="M 296.0583352262074,119.52872462241379 L 347.9071823035615,116.13928404430655 L399.7560293809156,112.74984346619931"></path><path class="edge section-edge-3 edge-depth-1" d="M 266.0915207257284,120.69984864036641 L 208.8510341871107,121.43502585310253 L151.61054764849303,122.17020306583865"></path><path class="edge section-edge-3 edge-depth-0" d="M 365.69345485609045,192.47164448271786 L 329.10468976423044,161.348818186454 L292.51592467237043,130.22599189019013"></path></g><g class="mindmap-nodes"><g transform="translate(318.0590944729604, 183.29042670910576)" class="mindmap-node section--1 section-root"><g transform="translate(59.060001373291016, 18.9)"><circle r="59.060001373291016" class="node-bkg node-circle" id="node-0"></circle></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">集合性能优化</tspan></tspan></text></g></g></g><g transform="translate(500.20580364883836, 120.37730111159328)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-1"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">选择原则</tspan></tspan></text></g></g></g><g transform="translate(404.38449333487983, 268.1638332623619)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-6"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">容量规划</tspan></tspan></text></g></g></g><g transform="translate(193.72171599460114, 254.52999982128048)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-11"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">内存优化</tspan></tspan></text></g></g></g><g transform="translate(238.05428438411377, 101.60720966380222)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-16"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">并发优化</tspan></tspan></text></g></g></g><g transform="translate(445.16409942694486, 30.13388746874989)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h90.125 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-2"></path><line y2="37.8" x2="100.125" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(50.0625, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">时间复杂度</tspan></tspan></text></g></g></g><g transform="translate(575.9370892328898, 41.75293126945758)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h91.125 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-3"></path><line y2="37.8" x2="101.125" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(50.5625, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">空间复杂度</tspan></tspan></text></g></g></g><g transform="translate(645.6402053432191, 104.80194384936351)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-4"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">使用场景</tspan></tspan></text></g></g></g><g transform="translate(644.2312625778027, 181.0275656773473)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-5"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">数据特征</tspan></tspan></text></g></g></g><g transform="translate(547.8086749752513, 303.77842812850474)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-7"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">初始容量设置</tspan></tspan></text></g></g></g><g transform="translate(496.3641814805485, 208.48495273553567)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-8"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">负载因子调整</tspan></tspan></text></g></g></g><g transform="translate(299.13310631508057, 333.5456132612252)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h92.09600067138672 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-9"></path><line y2="37.8" x2="102.09600067138672" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(51.04800033569336, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">预估数据量</tspan></tspan></text></g></g></g><g transform="translate(439.0930887728741, 358.95033665661265)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-10"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">扩容开销</tspan></tspan></text></g></g></g><g transform="translate(150.12067351633755, 348.56324809221326)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-12"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">对象开销分析</tspan></tspan></text></g></g></g><g transform="translate(157.8976632182837, 168.59600525968642)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h107.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-13"></path><line y2="37.8" x2="117.12000274658203" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(58.560001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">内存泄漏预防</tspan></tspan></text></g></g></g><g transform="translate(29.185378089971323, 219.20399814936445)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h95.51063537597656 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-14"></path><line y2="37.8" x2="105.51063537597656" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(52.75531768798828, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">GC影响减少</tspan></tspan></text></g></g></g><g transform="translate(15, 299.5608840309061)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-15"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">数据结构选择</tspan></tspan></text></g></g></g><g transform="translate(125.32185251544172, 28.620932430908965)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-17"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">线程安全集合</tspan></tspan></text></g></g></g><g transform="translate(281.1697533051938, 15)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h92.09600067138672 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-18"></path><line y2="37.8" x2="102.09600067138672" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(51.04800033569336, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">锁竞争减少</tspan></tspan></text></g></g></g><g transform="translate(371.68808162681785, 92.87135842481086)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-19"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">分片策略</tspan></tspan></text></g></g></g><g transform="translate(94.55709719201195, 103.46284204240283)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h74.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-20"></path><line y2="37.8" x2="84.109375" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(42.0546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">无锁算法</tspan></tspan></text></g></g></g></g></svg></section><section class="chapter"><h2 id="p99j0i_5" data-toc="p99j0i_5">🎯 集合选择策略</h2><section class="chapter"><h3 id="q1" data-toc="q1">Q1: 如何根据不同场景选择合适的集合类型？有哪些关键决策因素？</h3><p id="p99j0i_10"><span class="control" id="p99j0i_15">答案：</span></p><p id="p99j0i_11"><span class="control" id="p99j0i_16">集合选择决策树：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1250.7421875 1244.125" height="1244.125" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1250.7421875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M547.492,62L547.492,66.167C547.492,70.333,547.492,78.667,547.534,84.958C547.576,91.25,547.659,95.5,547.729,99.083C547.799,102.667,547.857,105.584,547.885,107.042L547.914,108.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M493.192,197.731L438.001,212.947C382.81,228.164,272.428,258.598,217.238,279.814C162.047,301.031,162.047,313.031,162.047,324.365C162.047,335.698,162.047,346.365,162.047,351.698L162.047,357.031"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_2" d="M596.695,203.828L629.253,218.029C661.811,232.229,726.927,260.63,759.527,277.956C792.126,295.281,792.21,301.531,792.284,307.115C792.359,312.698,792.424,317.615,792.457,320.073L792.49,322.532"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M751.448,409.436L725.777,422.369C700.107,435.301,648.766,461.166,623.096,480.099C597.426,499.031,597.426,511.031,597.426,522.365C597.426,533.698,597.426,544.365,597.426,549.698L597.426,555.031"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_F_4" d="M822.239,420.835L832.374,431.868C842.51,442.901,862.78,464.966,872.915,481.999C883.051,499.031,883.051,511.031,883.051,522.365C883.051,533.698,883.051,544.365,883.051,549.698L883.051,555.031"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_5" d="M162.047,415.031L162.047,427.031C162.047,439.031,162.047,463.031,162.089,478.156C162.13,493.281,162.214,499.531,162.288,505.115C162.362,510.698,162.428,515.615,162.461,518.073L162.494,520.532"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C2_6" d="M132.346,618.33L121.626,629.447C110.905,640.564,89.464,662.798,78.744,681.25C68.023,699.702,68.023,714.372,68.023,728.376C68.023,742.38,68.023,755.717,68.023,762.386L68.023,769.055"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C3_7" d="M192.748,618.33L203.301,629.447C213.855,640.564,234.963,662.798,245.558,677.039C256.154,691.281,256.237,697.531,256.311,703.115C256.386,708.698,256.451,713.615,256.484,716.073L256.517,718.532"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C3_C4_8" d="M220.62,842.628L210.147,854.703C199.675,866.778,178.73,890.928,168.258,910.338C157.785,929.749,157.785,944.419,157.785,958.423C157.785,972.427,157.785,985.764,157.785,992.433L157.785,999.102"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C3_C5_9" d="M292.521,842.628L302.827,854.703C313.132,866.778,333.744,890.928,344.05,910.338C354.355,929.749,354.355,944.419,354.355,958.423C354.355,972.427,354.355,985.764,354.355,992.433L354.355,999.102"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_10" d="M597.426,613.031L597.426,625.031C597.426,637.031,597.426,661.031,597.467,676.824C597.509,692.616,597.592,700.201,597.668,707.119C597.744,714.037,597.813,720.288,597.847,723.414L597.882,726.539"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_E2_11" d="M559.665,832.31L542.861,846.105C526.057,859.899,492.448,887.489,475.644,920.454C458.84,953.419,458.84,991.76,458.84,1030.102C458.84,1068.443,458.84,1106.784,459.515,1129.038C460.19,1151.292,461.539,1157.458,462.746,1162.974C463.954,1168.489,465.018,1173.353,465.551,1175.785L466.083,1178.217"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_E3_12" d="M640.602,827.894L663.331,842.425C686.06,856.955,731.518,886.017,754.289,904.34C777.06,922.663,777.143,930.247,777.219,937.165C777.295,944.083,777.364,950.335,777.398,953.46L777.433,956.586"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E3_E4_13" d="M786.958,1091.136L788.297,1100.134C789.636,1109.132,792.314,1127.129,793.653,1139.21C794.992,1151.292,794.992,1157.458,794.992,1162.958C794.992,1168.458,794.992,1173.292,794.992,1175.708L794.992,1178.125"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E3_E2_14" d="M741.073,1064.213L726.294,1077.699C711.515,1091.184,681.957,1118.154,657.376,1135.133C632.796,1152.112,613.194,1159.099,594.22,1165.863C575.246,1172.626,556.899,1179.165,547.726,1182.435L538.553,1185.705"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_F1_15" d="M883.051,613.031L883.051,625.031C883.051,637.031,883.051,661.031,883.092,677.492C883.134,693.952,883.217,702.872,883.295,711.126C883.372,719.38,883.443,726.968,883.478,730.761L883.513,734.555"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F1_F2_16" d="M839.461,818.465L799.532,834.567C759.604,850.669,679.747,882.874,639.819,906.311C599.891,929.749,599.891,944.419,599.891,958.423C599.891,972.427,599.891,985.764,599.891,992.433L599.891,999.102"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F1_F3_17" d="M923.325,822.78L950.92,838.163C978.515,853.546,1033.705,884.312,1061.341,902.82C1088.978,921.328,1089.061,927.578,1089.136,933.162C1089.21,938.745,1089.276,943.662,1089.308,946.12L1089.341,948.578"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F3_F4_18" d="M1054.035,1073.265L1043.956,1085.242C1033.877,1097.218,1013.72,1121.172,1003.641,1136.232C993.563,1151.292,993.563,1157.458,993.563,1162.958C993.563,1168.458,993.563,1173.292,993.563,1175.708L993.563,1178.125"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F3_F5_19" d="M1124.754,1073.265L1134.666,1085.242C1144.578,1097.218,1164.402,1121.172,1174.315,1136.232C1184.227,1151.292,1184.227,1157.458,1184.227,1162.958C1184.227,1168.458,1184.227,1173.292,1184.227,1175.708L1184.227,1178.125"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(162.046875, 289.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(792.04296875, 289.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(597.42578125, 487.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(883.05078125, 487.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(68.0234375, 685.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(256.0703125, 685.03125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(157.78515625, 915.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(354.35546875, 915.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(458.83984375, 1030.1015625)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(776.9765625, 915.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(794.9921875, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(652.3984375, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(599.890625, 915.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1088.89453125, 915.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(993.5625, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1184.2265625, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(547.4921875, 35)" id="flowchart-A-3284" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要集合</p></span></div></foreignObject></g></g><g transform="translate(547.4921875, 182.015625)" id="flowchart-B-3285" class="node default"><polygon transform="translate(-70.015625,70.015625)" class="label-container" points="70.015625,0 140.03125,-70.015625 70.015625,-140.03125 0,-70.015625"></polygon><g transform="translate(-43.015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="86.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要键值对?</p></span></div></foreignObject></g></g><g transform="translate(162.046875, 388.03125)" id="flowchart-C-3287" class="node default"><rect height="54" width="120.796875" y="-27" x="-60.3984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.3984375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="60.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>选择Map</p></span></div></foreignObject></g></g><g transform="translate(792.04296875, 388.03125)" id="flowchart-D-3289" class="node default"><polygon transform="translate(-62,62)" class="label-container" points="62,0 124,-62 62,-124 0,-62"></polygon><g transform="translate(-35, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="70"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>允许重复?</p></span></div></foreignObject></g></g><g transform="translate(597.42578125, 586.03125)" id="flowchart-E-3291" class="node default"><rect height="54" width="117.640625" y="-27" x="-58.8203125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.8203125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="57.640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>选择List</p></span></div></foreignObject></g></g><g transform="translate(883.05078125, 586.03125)" id="flowchart-F-3293" class="node default"><rect height="54" width="114.890625" y="-27" x="-57.4453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.4453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="54.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>选择Set</p></span></div></foreignObject></g></g><g transform="translate(162.046875, 586.03125)" id="flowchart-C1-3295" class="node default"><polygon transform="translate(-62,62)" class="label-container" points="62,0 124,-62 62,-124 0,-62"></polygon><g transform="translate(-35, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="70"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要排序?</p></span></div></foreignObject></g></g><g transform="translate(68.0234375, 800.0546875)" id="flowchart-C2-3297" class="node default"><rect height="54" width="120.046875" y="-27" x="-60.0234375" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-30.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="60.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>TreeMap</p></span></div></foreignObject></g></g><g transform="translate(256.0703125, 800.0546875)" id="flowchart-C3-3299" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要插入顺序?</p></span></div></foreignObject></g></g><g transform="translate(157.78515625, 1030.1015625)" id="flowchart-C4-3301" class="node default"><rect height="54" width="170.203125" y="-27" x="-85.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-55.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="110.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LinkedHashMap</p></span></div></foreignObject></g></g><g transform="translate(354.35546875, 1030.1015625)" id="flowchart-C5-3303" class="node default"><rect height="54" width="122.9375" y="-27" x="-61.46875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.46875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="62.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HashMap</p></span></div></foreignObject></g></g><g transform="translate(597.42578125, 800.0546875)" id="flowchart-E1-3305" class="node default"><polygon transform="translate(-70.015625,70.015625)" class="label-container" points="70.015625,0 140.03125,-70.015625 70.015625,-140.03125 0,-70.015625"></polygon><g transform="translate(-43.015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="86.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>随机访问多?</p></span></div></foreignObject></g></g><g transform="translate(472.84765625, 1209.125)" id="flowchart-E2-3307" class="node default"><rect height="54" width="123.875" y="-27" x="-61.9375" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-31.9375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="63.875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ArrayList</p></span></div></foreignObject></g></g><g transform="translate(776.9765625, 1030.1015625)" id="flowchart-E3-3309" class="node default"><polygon transform="translate(-70.015625,70.015625)" class="label-container" points="70.015625,0 140.03125,-70.015625 70.015625,-140.03125 0,-70.015625"></polygon><g transform="translate(-43.015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="86.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>插入删除多?</p></span></div></foreignObject></g></g><g transform="translate(794.9921875, 1209.125)" id="flowchart-E4-3311" class="node default"><rect height="54" width="132.84375" y="-27" x="-66.421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="72.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LinkedList</p></span></div></foreignObject></g></g><g transform="translate(883.05078125, 800.0546875)" id="flowchart-F1-3315" class="node default"><polygon transform="translate(-62,62)" class="label-container" points="62,0 124,-62 62,-124 0,-62"></polygon><g transform="translate(-35, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="70"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要排序?</p></span></div></foreignObject></g></g><g transform="translate(599.890625, 1030.1015625)" id="flowchart-F2-3317" class="node default"><rect height="54" width="114.140625" y="-27" x="-57.0703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.0703125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="54.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>TreeSet</p></span></div></foreignObject></g></g><g transform="translate(1088.89453125, 1030.1015625)" id="flowchart-F3-3319" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要插入顺序?</p></span></div></foreignObject></g></g><g transform="translate(993.5625, 1209.125)" id="flowchart-F4-3321" class="node default"><rect height="54" width="164.296875" y="-27" x="-82.1484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.1484375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="104.296875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LinkedHashSet</p></span></div></foreignObject></g></g><g transform="translate(1184.2265625, 1209.125)" id="flowchart-F5-3323" class="node default"><rect height="54" width="117.03125" y="-27" x="-58.515625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-28.515625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="57.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HashSet</p></span></div></foreignObject></g></g></g></g></g></svg><p id="p99j0i_13"><span class="control" id="p99j0i_17">性能优化的集合选择指南：</span></p><div class="code-block" data-lang="java">
// 集合选择性能优化指南
public class CollectionSelectionGuide {
    
    // 1. 基于操作频率的选择策略
    public void operationBasedSelection() {
        System.out.println(&quot;=== 基于操作频率的集合选择 ===&quot;);
        
        System.out.println(&quot;1. 频繁随机访问（get操作）:&quot;);
        System.out.println(&quot;   推荐：ArrayList&quot;);
        System.out.println(&quot;   原因：O(1)时间复杂度的索引访问&quot;);
        System.out.println(&quot;   避免：LinkedList（O(n)时间复杂度）&quot;);
        
        System.out.println(&quot;\n2. 频繁插入/删除（非尾部）:&quot;);
        System.out.println(&quot;   推荐：LinkedList&quot;);
        System.out.println(&quot;   原因：O(1)时间复杂度的节点操作&quot;);
        System.out.println(&quot;   避免：ArrayList（需要移动元素）&quot;);
        
        System.out.println(&quot;\n3. 频繁查找操作:&quot;);
        System.out.println(&quot;   推荐：HashMap/HashSet&quot;);
        System.out.println(&quot;   原因：平均O(1)时间复杂度&quot;);
        System.out.println(&quot;   避免：TreeMap/TreeSet（O(log n)时间复杂度）&quot;);
        
        System.out.println(&quot;\n4. 需要排序遍历:&quot;);
        System.out.println(&quot;   推荐：TreeMap/TreeSet&quot;);
        System.out.println(&quot;   原因：自动维护排序，避免额外排序成本&quot;);
        System.out.println(&quot;   避免：HashMap后排序（额外O(n log n)开销）&quot;);
    }
    
    // 2. 基于数据规模的选择策略
    public void dataSizeBasedSelection() {
        System.out.println(&quot;=== 基于数据规模的集合选择 ===&quot;);
        
        // 小数据量（&lt; 1000）
        System.out.println(&quot;小数据量（&lt; 1000元素）:&quot;);
        System.out.println(&quot;- 可以选择简单的ArrayList&quot;);
        System.out.println(&quot;- 性能差异不明显&quot;);
        System.out.println(&quot;- 优先考虑代码简洁性&quot;);
        
        // 中等数据量（1000 - 100,000）
        System.out.println(&quot;\n中等数据量（1000 - 100,000元素）:&quot;);
        System.out.println(&quot;- 需要考虑时间复杂度&quot;);
        System.out.println(&quot;- HashMap vs TreeMap 差异明显&quot;);
        System.out.println(&quot;- ArrayList vs LinkedList 需要根据操作类型选择&quot;);
        
        // 大数据量（&gt; 100,000）
        System.out.println(&quot;\n大数据量（&gt; 100,000元素）:&quot;);
        System.out.println(&quot;- 时间复杂度是关键因素&quot;);
        System.out.println(&quot;- 内存占用需要考虑&quot;);
        System.out.println(&quot;- 可能需要考虑分片或分布式方案&quot;);
        
        // 性能测试演示
        performanceComparisonBySize();
    }
    
    private void performanceComparisonBySize() {
        System.out.println(&quot;\n性能测试结果（仅供参考）:&quot;);
        
        int[] sizes = {1000, 10000, 100000};
        
        for (int size : sizes) {
            System.out.println(&quot;\n数据量: &quot; + size);
            
            // ArrayList vs LinkedList 随机访问
            List&lt;Integer&gt; arrayList = new ArrayList&lt;&gt;();
            List&lt;Integer&gt; linkedList = new LinkedList&lt;&gt;();
            
            // 填充数据
            for (int i = 0; i &lt; size; i++) {
                arrayList.add(i);
                linkedList.add(i);
            }
            
            // 测试随机访问
            long startTime = System.nanoTime();
            for (int i = 0; i &lt; 1000; i++) {
                arrayList.get(size / 2);
            }
            long arrayListTime = System.nanoTime() - startTime;
            
            startTime = System.nanoTime();
            for (int i = 0; i &lt; 1000; i++) {
                linkedList.get(size / 2);
            }
            long linkedListTime = System.nanoTime() - startTime;
            
            System.out.println(&quot;随机访问(1000次):&quot;);
            System.out.println(&quot;  ArrayList: &quot; + arrayListTime / 1_000_000 + &quot;ms&quot;);
            System.out.println(&quot;  LinkedList: &quot; + linkedListTime / 1_000_000 + &quot;ms&quot;);
            System.out.println(&quot;  性能比: &quot; + (double) linkedListTime / arrayListTime);
        }
    }
    
    // 3. 内存敏感场景的选择
    public void memoryConstrainedSelection() {
        System.out.println(&quot;=== 内存敏感场景的集合选择 ===&quot;);
        
        System.out.println(&quot;1. 内存开销对比:&quot;);
        System.out.println(&quot;   ArrayList: 数组 + 少量开销&quot;);
        System.out.println(&quot;   LinkedList: 节点对象 + 指针开销较大&quot;);
        System.out.println(&quot;   HashMap: Entry对象 + 数组开销&quot;);
        System.out.println(&quot;   TreeMap: TreeNode对象开销最大&quot;);
        
        System.out.println(&quot;\n2. 内存优化建议:&quot;);
        System.out.println(&quot;   - 优先选择ArrayList而非LinkedList&quot;);
        System.out.println(&quot;   - 使用primitive集合库（如Trove4j）&quot;);
        System.out.println(&quot;   - 合理设置初始容量&quot;);
        System.out.println(&quot;   - 及时调用trimToSize()&quot;);
        
        // 内存占用分析
        memoryUsageAnalysis();
    }
    
    private void memoryUsageAnalysis() {
        System.out.println(&quot;\n内存占用分析（大致估算）:&quot;);
        
        int elementCount = 10000;
        
        // ArrayList内存占用
        int arrayListMemory = elementCount * 4 + 32; // 4字节引用 + 对象头
        
        // LinkedList内存占用
        int linkedListMemory = elementCount * (4 + 16 + 8); // 引用 + Node对象 + 指针
        
        // HashMap内存占用
        int hashMapMemory = elementCount * (4 + 24) + 16 * 4; // Entry对象 + 数组
        
        System.out.println(String.format(&quot;10000个Integer元素的大致内存占用:&quot;));
        System.out.println(String.format(&quot;ArrayList: %d bytes&quot;, arrayListMemory));
        System.out.println(String.format(&quot;LinkedList: %d bytes&quot;, linkedListMemory));
        System.out.println(String.format(&quot;HashMap: %d bytes&quot;, hashMapMemory));
        System.out.println(String.format(&quot;LinkedList是ArrayList的 %.1f 倍&quot;, 
                                        (double)linkedListMemory / arrayListMemory));
    }
    
    // 4. 并发场景的选择
    public void concurrentScenarioSelection() {
        System.out.println(&quot;=== 并发场景的集合选择 ===&quot;);
        
        System.out.println(&quot;1. 读多写少场景:&quot;);
        System.out.println(&quot;   推荐：CopyOnWriteArrayList&quot;);
        System.out.println(&quot;   原因：读操作无锁，性能高&quot;);
        System.out.println(&quot;   注意：写操作成本高&quot;);
        
        System.out.println(&quot;\n2. 读写均衡场景:&quot;);
        System.out.println(&quot;   推荐：ConcurrentHashMap&quot;);
        System.out.println(&quot;   原因：分段锁，并发性好&quot;);
        System.out.println(&quot;   避免：Hashtable（全局锁）&quot;);
        
        System.out.println(&quot;\n3. 高并发写入场景:&quot;);
        System.out.println(&quot;   推荐：ConcurrentLinkedQueue&quot;);
        System.out.println(&quot;   原因：无锁算法，性能最优&quot;);
        System.out.println(&quot;   考虑：分片策略降低竞争&quot;);
        
        System.out.println(&quot;\n4. 有序并发场景:&quot;);
        System.out.println(&quot;   推荐：ConcurrentSkipListMap&quot;);
        System.out.println(&quot;   原因：跳表结构，支持并发和排序&quot;);
        System.out.println(&quot;   避免：TreeMap + 外部同步&quot;);
    }
    
    public static void main(String[] args) {
        CollectionSelectionGuide guide = new CollectionSelectionGuide();
        
        guide.operationBasedSelection();
        System.out.println();
        
        guide.dataSizeBasedSelection();
        System.out.println();
        
        guide.memoryConstrainedSelection();
        System.out.println();
        
        guide.concurrentScenarioSelection();
    }
}
</div></section><section class="chapter"><h3 id="q2" data-toc="q2">Q2: 如何进行集合的容量规划和参数调优？</h3><p id="p99j0i_18"><span class="control" id="p99j0i_23">答案：</span></p><p id="p99j0i_19"><span class="control" id="p99j0i_24">容量规划策略：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 2448 188"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="2448" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 24)" class="root"><g class="clusters"><g data-look="classic" id="并发集合调优" class="cluster"><rect height="124" width="739.46875" y="8" x="8" style=""></rect><g transform="translate(329.65625, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>并发集合调优</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C2_4" d="M201.656,70L207.906,70C214.156,70,226.656,70,236.031,70C245.406,70,251.656,70,257.24,70C262.823,70,267.74,70,270.198,70L272.656,70"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C2_C3_5" d="M494.844,70L501.094,70C507.344,70,519.844,70,529.219,70C538.594,70,544.844,70,550.427,70C556.01,70,560.927,70,563.385,70L565.844,70"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(123.578125, 70)" id="flowchart-C1-3485" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>评估并发级别</p></span></div></foreignObject></g></g><g transform="translate(385.75, 70)" id="flowchart-C2-3486" class="node default"><rect height="54" width="218.1875" y="-27" x="-109.09375" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-79.09375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="158.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>设置concurrencyLevel</p></span></div></foreignObject></g></g><g transform="translate(639.90625, 70)" id="flowchart-C3-3488" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>减少锁竞争</p></span></div></foreignObject></g></g></g></g><g transform="translate(789.46875, 0)" class="root"><g class="clusters"><g data-look="classic" id="HashMap容量规划" class="cluster"><rect height="172" width="829.359375" y="8" x="8" style=""></rect><g transform="translate(359.1640625, 8)" class="cluster-label"><foreignObject height="24" width="127.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HashMap容量规划</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B2_2" d="M201.656,94L207.906,94C214.156,94,226.656,94,236.031,94C245.406,94,251.656,94,257.24,94C262.823,94,267.74,94,270.198,94L272.656,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B2_B3_3" d="M536.656,94L542.906,94C549.156,94,561.656,94,571.031,94C580.406,94,586.656,94,592.24,94C597.823,94,602.74,94,605.198,94L607.656,94"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(123.578125, 94)" id="flowchart-B1-3481" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>预估元素数量</p></span></div></foreignObject></g></g><g transform="translate(406.65625, 94)" id="flowchart-B2-3482" class="node default"><rect height="102" width="260" y="-51" x="-130" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-100, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>计算初始容量<br>capacity = count / loadFactor + 1</p></span></div></foreignObject></g></g><g transform="translate(705.7578125, 94)" id="flowchart-B3-3484" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>选择合适负载因子<br>0.75平衡空间时间</p></span></div></foreignObject></g></g></g></g><g transform="translate(1668.828125, 12)" class="root"><g class="clusters"><g data-look="classic" id="ArrayList容量规划" class="cluster"><rect height="148" width="763.171875" y="8" x="8" style=""></rect><g transform="translate(325.6015625, 8)" class="cluster-label"><foreignObject height="24" width="127.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ArrayList容量规划</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A1_A2_0" d="M201.656,82L207.906,82C214.156,82,226.656,82,236.031,82C245.406,82,251.656,82,257.24,82C262.823,82,267.74,82,270.198,82L272.656,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A2_A3_1" d="M502.516,82L508.766,82C515.016,82,527.516,82,536.891,82C546.266,82,552.516,82,558.099,82C563.682,82,568.599,82,571.057,82L573.516,82"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(123.578125, 82)" id="flowchart-A1-3477" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>预估元素数量</p></span></div></foreignObject></g></g><g transform="translate(389.5859375, 82)" id="flowchart-A2-3478" class="node default"><rect height="78" width="225.859375" y="-39" x="-112.9296875" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-82.9296875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="165.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>设置初始容量<br>capacity = count * 1.25</p></span></div></foreignObject></g></g><g transform="translate(655.59375, 82)" id="flowchart-A3-3480" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>避免频繁扩容</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="p99j0i_21"><span class="control" id="p99j0i_25">容量规划和调优实践：</span></p><div class="code-block" data-lang="java">
// 集合容量规划和性能调优
public class CollectionCapacityPlanning {
    
    // 1. ArrayList容量规划
    public void arrayListCapacityPlanning() {
        System.out.println(&quot;=== ArrayList容量规划 ===&quot;);
        
        // 错误示例：不设置初始容量
        long startTime = System.nanoTime();
        List&lt;Integer&gt; badList = new ArrayList&lt;&gt;(); // 默认容量10
        for (int i = 0; i &lt; 100000; i++) {
            badList.add(i); // 会触发多次扩容
        }
        long badTime = System.nanoTime() - startTime;
        
        // 正确示例：设置合适的初始容量
        startTime = System.nanoTime();
        List&lt;Integer&gt; goodList = new ArrayList&lt;&gt;(100000); // 预设容量
        for (int i = 0; i &lt; 100000; i++) {
            goodList.add(i); // 无扩容
        }
        long goodTime = System.nanoTime() - startTime;
        
        System.out.println(&quot;不设置初始容量耗时: &quot; + badTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;设置初始容量耗时: &quot; + goodTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;性能提升: &quot; + (double) badTime / goodTime + &quot;倍&quot;);
        
        // 容量规划建议
        System.out.println(&quot;\nArrayList容量规划建议:&quot;);
        System.out.println(&quot;1. 预估元素数量，设置初始容量为 count * 1.25&quot;);
        System.out.println(&quot;2. 不确定时使用默认容量，但监控扩容频率&quot;);
        System.out.println(&quot;3. 数据稳定后调用trimToSize()节省内存&quot;);
        System.out.println(&quot;4. 避免频繁的add/remove操作导致的容量波动&quot;);
    }
    
    // 2. HashMap容量规划
    public void hashMapCapacityPlanning() {
        System.out.println(&quot;=== HashMap容量规划 ===&quot;);
        
        int elementCount = 10000;
        
        // 计算最优初始容量
        int optimalCapacity = calculateOptimalHashMapCapacity(elementCount, 0.75f);
        System.out.println(&quot;元素数量: &quot; + elementCount);
        System.out.println(&quot;最优初始容量: &quot; + optimalCapacity);
        
        // 对比不同初始容量的性能
        compareHashMapCapacities(elementCount);
        
        // 负载因子影响分析
        loadFactorAnalysis();
    }
    
    private int calculateOptimalHashMapCapacity(int expectedSize, float loadFactor) {
        // 确保容量是2的幂次方，且能容纳所有元素而不触发扩容
        int capacity = 1;
        int threshold = (int) (expectedSize / loadFactor) + 1;
        while (capacity &lt; threshold) {
            capacity &lt;&lt;= 1;
        }
        return capacity;
    }
    
    private void compareHashMapCapacities(int elementCount) {
        System.out.println(&quot;\n容量设置性能对比:&quot;);
        
        // 测试1：默认容量
        long startTime = System.nanoTime();
        Map&lt;Integer, String&gt; map1 = new HashMap&lt;&gt;();
        for (int i = 0; i &lt; elementCount; i++) {
            map1.put(i, &quot;value&quot; + i);
        }
        long defaultTime = System.nanoTime() - startTime;
        
        // 测试2：最优容量
        int optimalCapacity = calculateOptimalHashMapCapacity(elementCount, 0.75f);
        startTime = System.nanoTime();
        Map&lt;Integer, String&gt; map2 = new HashMap&lt;&gt;(optimalCapacity);
        for (int i = 0; i &lt; elementCount; i++) {
            map2.put(i, &quot;value&quot; + i);
        }
        long optimalTime = System.nanoTime() - startTime;
        
        // 测试3：过小容量
        startTime = System.nanoTime();
        Map&lt;Integer, String&gt; map3 = new HashMap&lt;&gt;(10); // 明显过小
        for (int i = 0; i &lt; elementCount; i++) {
            map3.put(i, &quot;value&quot; + i);
        }
        long smallTime = System.nanoTime() - startTime;
        
        System.out.println(&quot;默认容量(16)耗时: &quot; + defaultTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;最优容量(&quot; + optimalCapacity + &quot;)耗时: &quot; + optimalTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;过小容量(10)耗时: &quot; + smallTime / 1_000_000 + &quot;ms&quot;);
    }
    
    private void loadFactorAnalysis() {
        System.out.println(&quot;\n=== 负载因子影响分析 ===&quot;);
        
        float[] loadFactors = {0.5f, 0.75f, 1.0f};
        int elementCount = 10000;
        
        for (float loadFactor : loadFactors) {
            // 创建自定义负载因子的HashMap
            Map&lt;Integer, String&gt; map = new HashMap&lt;&gt;(16, loadFactor);
            
            long startTime = System.nanoTime();
            for (int i = 0; i &lt; elementCount; i++) {
                map.put(i, &quot;value&quot; + i);
            }
            long insertTime = System.nanoTime() - startTime;
            
            // 测试查找性能
            startTime = System.nanoTime();
            for (int i = 0; i &lt; 10000; i++) {
                map.get(i % elementCount);
            }
            long searchTime = System.nanoTime() - startTime;
            
            System.out.println(String.format(&quot;负载因子 %.2f: 插入 %dms, 查找 %dms&quot;, 
                                           loadFactor, 
                                           insertTime / 1_000_000,
                                           searchTime / 1_000_000));
        }
        
        System.out.println(&quot;\n负载因子选择建议:&quot;);
        System.out.println(&quot;0.75: 默认值，平衡时间和空间&quot;);
        System.out.println(&quot;0.5:  更少冲突，但浪费空间&quot;);
        System.out.println(&quot;1.0:  节省空间，但冲突增加&quot;);
    }
    
    // 3. ConcurrentHashMap并发级别调优
    public void concurrentHashMapTuning() {
        System.out.println(&quot;=== ConcurrentHashMap并发调优 ===&quot;);
        
        int threadCount = Runtime.getRuntime().availableProcessors();
        System.out.println(&quot;CPU核心数: &quot; + threadCount);
        
        // 测试不同concurrencyLevel的影响（JDK7概念，JDK8已改进）
        System.out.println(&quot;\nJDK8 ConcurrentHashMap改进:&quot;);
        System.out.println(&quot;1. 取消分段锁，使用CAS + synchronized&quot;);
        System.out.println(&quot;2. 使用Node数组 + 链表/红黑树&quot;);
        System.out.println(&quot;3. 并发度等于数组长度&quot;);
        System.out.println(&quot;4. 自动根据负载调整&quot;);
        
        // 并发性能测试
        concurrentPerformanceTest();
    }
    
    private void concurrentPerformanceTest() {
        System.out.println(&quot;\n并发性能测试:&quot;);
        
        final int THREAD_COUNT = 4;
        final int OPERATIONS_PER_THREAD = 10000;
        
        // 测试ConcurrentHashMap
        Map&lt;Integer, String&gt; concurrentMap = new ConcurrentHashMap&lt;&gt;();
        long startTime = System.nanoTime();
        
        Thread[] threads = new Thread[THREAD_COUNT];
        for (int i = 0; i &lt; THREAD_COUNT; i++) {
            final int threadId = i;
            threads[i] = new Thread(() -&gt; {
                for (int j = 0; j &lt; OPERATIONS_PER_THREAD; j++) {
                    int key = threadId * OPERATIONS_PER_THREAD + j;
                    concurrentMap.put(key, &quot;value&quot; + key);
                }
            });
            threads[i].start();
        }
        
        for (Thread thread : threads) {
            try {
                thread.join();
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }
        
        long concurrentTime = System.nanoTime() - startTime;
        
        // 测试同步HashMap
        Map&lt;Integer, String&gt; syncMap = Collections.synchronizedMap(new HashMap&lt;&gt;());
        startTime = System.nanoTime();
        
        for (int i = 0; i &lt; THREAD_COUNT; i++) {
            final int threadId = i;
            threads[i] = new Thread(() -&gt; {
                for (int j = 0; j &lt; OPERATIONS_PER_THREAD; j++) {
                    int key = threadId * OPERATIONS_PER_THREAD + j;
                    syncMap.put(key, &quot;value&quot; + key);
                }
            });
            threads[i].start();
        }
        
        for (Thread thread : threads) {
            try {
                thread.join();
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }
        
        long syncTime = System.nanoTime() - startTime;
        
        System.out.println(&quot;ConcurrentHashMap耗时: &quot; + concurrentTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;SynchronizedMap耗时: &quot; + syncTime / 1_000_000 + &quot;ms&quot;);
        System.out.println(&quot;性能提升: &quot; + (double) syncTime / concurrentTime + &quot;倍&quot;);
    }
    
    // 4. 内存优化策略
    public void memoryOptimization() {
        System.out.println(&quot;=== 集合内存优化策略 ===&quot;);
        
        System.out.println(&quot;1. 选择合适的数据结构:&quot;);
        System.out.println(&quot;   - 基本类型用专门的集合库（Trove4j, Eclipse Collections）&quot;);
        System.out.println(&quot;   - 小数组优于LinkedList&quot;);
        System.out.println(&quot;   - EnumSet优于HashSet&lt;Enum&gt;&quot;);
        
        System.out.println(&quot;\n2. 容量管理:&quot;);
        System.out.println(&quot;   - 设置合理的初始容量&quot;);
        System.out.println(&quot;   - 及时调用trimToSize()&quot;);
        System.out.println(&quot;   - 移除不再使用的引用&quot;);
        
        System.out.println(&quot;\n3. 避免内存泄漏:&quot;);
        System.out.println(&quot;   - 及时remove()过期元素&quot;);
        System.out.println(&quot;   - 使用WeakHashMap存储缓存&quot;);
        System.out.println(&quot;   - 注意Iterator使用后的清理&quot;);
        
        // 内存泄漏演示
        memoryLeakDemo();
    }
    
    private void memoryLeakDemo() {
        System.out.println(&quot;\n内存泄漏预防示例:&quot;);
        
        // 错误：保留过期数据
        Map&lt;String, Object&gt; cache = new HashMap&lt;&gt;();
        
        // 正确：使用WeakHashMap或及时清理
        Map&lt;String, Object&gt; betterCache = new WeakHashMap&lt;&gt;();
        
        // 正确：显式清理
        Map&lt;String, Object&gt; manualCache = new HashMap&lt;&gt;();
        
        System.out.println(&quot;1. 使用WeakHashMap做缓存&quot;);
        System.out.println(&quot;2. 定期清理过期数据&quot;);
        System.out.println(&quot;3. 使用LRU缓存限制大小&quot;);
        System.out.println(&quot;4. 监控内存使用情况&quot;);
    }
    
    public static void main(String[] args) {
        CollectionCapacityPlanning planning = new CollectionCapacityPlanning();
        
        planning.arrayListCapacityPlanning();
        System.out.println();
        
        planning.hashMapCapacityPlanning();
        System.out.println();
        
        planning.concurrentHashMapTuning();
        System.out.println();
        
        planning.memoryOptimization();
    }
}
</div></section></section><section class="chapter"><h2 id="p99j0i_6" data-toc="p99j0i_6">💡 面试技巧</h2><section class="chapter"><h3 id="p99j0i_26" data-toc="p99j0i_26">高频考点</h3><ol class="list _decimal" id="p99j0i_28" type="1"><li class="list__item" id="p99j0i_29"><p id="p99j0i_34"><span class="control" id="p99j0i_35">性能分析</span> ：时间复杂度、空间复杂度、具体场景的性能表现</p></li><li class="list__item" id="p99j0i_30"><p id="p99j0i_36"><span class="control" id="p99j0i_37">容量规划</span> ：初始容量设置、负载因子选择、扩容成本</p></li><li class="list__item" id="p99j0i_31"><p id="p99j0i_38"><span class="control" id="p99j0i_39">内存优化</span> ：数据结构选择、内存泄漏预防、GC影响</p></li><li class="list__item" id="p99j0i_32"><p id="p99j0i_40"><span class="control" id="p99j0i_41">并发优化</span> ：线程安全集合选择、锁竞争减少、分片策略</p></li><li class="list__item" id="p99j0i_33"><p id="p99j0i_42"><span class="control" id="p99j0i_43">实际应用</span> ：根据业务场景选择最优集合类型</p></li></ol></section><section class="chapter"><h3 id="p99j0i_27" data-toc="p99j0i_27">回答策略</h3><ol class="list _decimal" id="p99j0i_44" type="1"><li class="list__item" id="p99j0i_47"><p id="p99j0i_51"><span class="control" id="p99j0i_52">量化分析</span> ：能够给出具体的性能数据和对比结果</p></li><li class="list__item" id="p99j0i_48"><p id="p99j0i_53"><span class="control" id="p99j0i_54">场景结合</span> ：结合实际业务场景说明选择理由</p></li><li class="list__item" id="p99j0i_49"><p id="p99j0i_55"><span class="control" id="p99j0i_56">权衡考虑</span> ：理解不同方案的优缺点和适用条件</p></li><li class="list__item" id="p99j0i_50"><p id="p99j0i_57"><span class="control" id="p99j0i_58">持续优化</span> ：知道如何监控和调优集合性能</p></li></ol><p id="p99j0i_46"><span class="control" id="p99j0i_59">学习建议</span> ：性能优化需要结合实际测试来验证。重点掌握集合选择的基本原则，理解各种集合的性能特点。在实际项目中要根据具体场景进行选择和调优。</p></section></section><div class="last-modified">09 六月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="java集合源码分析qa.html" class="navigation-links__prev">Java集合源码分析QA</a><a href="java并发面试大纲.html" class="navigation-links__next">Java并发面试大纲</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>