<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-05-26T23:46:50.5650206"><title>Elasticsearch 技术特性考察重点 | 技术栈提升</title><script type="application/json" id="virtual-toc-data">[{"id":"qg4rcd_3","level":0,"title":"目录","anchor":"#qg4rcd_3"},{"id":"qg4rcd_4","level":0,"title":"核心概念","anchor":"#qg4rcd_4"},{"id":"qg4rcd_5","level":0,"title":"架构设计","anchor":"#qg4rcd_5"},{"id":"qg4rcd_6","level":0,"title":"索引与映射","anchor":"#qg4rcd_6"},{"id":"qg4rcd_7","level":0,"title":"查询与聚合","anchor":"#qg4rcd_7"},{"id":"qg4rcd_8","level":0,"title":"性能优化","anchor":"#qg4rcd_8"},{"id":"qg4rcd_9","level":0,"title":"集群管理","anchor":"#qg4rcd_9"},{"id":"qg4rcd_10","level":0,"title":"数据建模","anchor":"#qg4rcd_10"},{"id":"qg4rcd_11","level":0,"title":"监控与运维","anchor":"#qg4rcd_11"},{"id":"qg4rcd_12","level":0,"title":"安全特性","anchor":"#qg4rcd_12"},{"id":"ai","level":0,"title":"向量检索与AI集成","anchor":"#ai"},{"id":"qg4rcd_14","level":0,"title":"面试常见问题","anchor":"#qg4rcd_14"},{"id":"qg4rcd_15","level":0,"title":"学习建议","anchor":"#qg4rcd_15"},{"id":"qg4rcd_16","level":0,"title":"总结","anchor":"#qg4rcd_16"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Elasticsearch 技术特性考察重点 | 技术栈提升"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术栈提升 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/elasticsearch技术特性考察重点.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Elasticsearch 技术特性考察重点 | 技术栈提升"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/elasticsearch技术特性考察重点.html#webpage",
    "url": "writerside-documentation/elasticsearch技术特性考察重点.html",
    "name": "Elasticsearch 技术特性考察重点 | 技术栈提升",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术栈提升 Help"
}</script><!-- End Schema.org --></head><body data-id="Elasticsearch技术特性考察重点" data-main-title="Elasticsearch 技术特性考察重点" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术栈提升  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Elasticsearch技术特性考察重点" id="Elasticsearch技术特性考察重点.md">Elasticsearch 技术特性考察重点</h1><section class="chapter"><h2 id="qg4rcd_3" data-toc="qg4rcd_3">目录</h2><ul class="list _bullet" id="qg4rcd_17"><li class="list__item" id="qg4rcd_19"><p id="qg4rcd_30"><span id="qg4rcd_31">核心概念</span></p></li><li class="list__item" id="qg4rcd_20"><p id="qg4rcd_32"><span id="qg4rcd_33">架构设计</span></p></li><li class="list__item" id="qg4rcd_21"><p id="qg4rcd_34"><span id="qg4rcd_35">索引与映射</span></p></li><li class="list__item" id="qg4rcd_22"><p id="qg4rcd_36"><span id="qg4rcd_37">查询与聚合</span></p></li><li class="list__item" id="qg4rcd_23"><p id="qg4rcd_38"><span id="qg4rcd_39">性能优化</span></p></li><li class="list__item" id="qg4rcd_24"><p id="qg4rcd_40"><span id="qg4rcd_41">集群管理</span></p></li><li class="list__item" id="qg4rcd_25"><p id="qg4rcd_42"><span id="qg4rcd_43">数据建模</span></p></li><li class="list__item" id="qg4rcd_26"><p id="qg4rcd_44"><span id="qg4rcd_45">监控与运维</span></p></li><li class="list__item" id="qg4rcd_27"><p id="qg4rcd_46"><span id="qg4rcd_47">安全特性</span></p></li><li class="list__item" id="qg4rcd_28"><p id="qg4rcd_48"><span id="qg4rcd_49">向量检索与AI集成</span></p></li><li class="list__item" id="qg4rcd_29"><p id="qg4rcd_50"><span id="qg4rcd_51">高级特性</span></p></li></ul></section><section class="chapter"><h2 id="qg4rcd_4" data-toc="qg4rcd_4">核心概念</h2><section class="chapter"><h3 id="1" data-toc="1">1. 基础概念理解</h3><section class="chapter"><h4 id="qg4rcd_54" data-toc="qg4rcd_54">核心术语定义</h4><ul class="list _bullet" id="qg4rcd_57"><li class="list__item" id="qg4rcd_58"><p id="qg4rcd_65"><span class="control" id="qg4rcd_66">Index（索引）</span>: 类似数据库中的database，是文档的集合</p></li><li class="list__item" id="qg4rcd_59"><p id="qg4rcd_67"><span class="control" id="qg4rcd_68">Type（类型）</span>: 7.x版本后已废弃，每个索引只能有一个type</p></li><li class="list__item" id="qg4rcd_60"><p id="qg4rcd_69"><span class="control" id="qg4rcd_70">Document（文档）</span>: 基本数据单元，JSON格式</p></li><li class="list__item" id="qg4rcd_61"><p id="qg4rcd_71"><span class="control" id="qg4rcd_72">Field（字段）</span>: 文档中的属性</p></li><li class="list__item" id="qg4rcd_62"><p id="qg4rcd_73"><span class="control" id="qg4rcd_74">Mapping（映射）</span>: 定义文档结构和字段类型的schema</p></li><li class="list__item" id="qg4rcd_63"><p id="qg4rcd_75"><span class="control" id="qg4rcd_76">Shard（分片）</span>: 索引的水平分割单元</p></li><li class="list__item" id="qg4rcd_64"><p id="qg4rcd_77"><span class="control" id="qg4rcd_78">Replica（副本）</span>: 分片的备份</p></li></ul></section><section class="chapter"><h4 id="qg4rcd_55" data-toc="qg4rcd_55">常见面试题及标准回答</h4><p id="qg4rcd_79"><span class="control" id="qg4rcd_141">Q1: 请解释Elasticsearch中Index、Type、Document的关系，以及为什么Type被废弃？</span></p><p id="qg4rcd_80"><span class="control" id="qg4rcd_142">标准回答:</span></p><div class="code-block" data-lang="none">
在Elasticsearch中，Index、Type、Document的关系类似于：
- Index ≈ 数据库(Database)
- Type ≈ 表(Table) 
- Document ≈ 行(Row)

Type被废弃的原因详解：

1. 稀疏性问题（技术层面）：
   在同一个Index中，不同Type的字段会合并到同一个Lucene索引中。
   
   示例场景：
   Index: blog
   ├── Type: post (字段: title, content, author, publish_date)
   └── Type: comment (字段: title, content, comment_date, parent_id)
   
   实际存储结构：
   Document 1 (post): {title: &quot;文章&quot;, content: &quot;内容&quot;, author: &quot;张三&quot;, publish_date: &quot;2023-01-01&quot;, comment_date: null, parent_id: null}
   Document 2 (comment): {title: &quot;评论&quot;, content: &quot;回复&quot;, author: null, publish_date: null, comment_date: &quot;2023-01-02&quot;, parent_id: &quot;1&quot;}
   
   问题：
   - 大量null值造成存储空间浪费
   - 索引结构变得稀疏，影响压缩效率
   - 查询时需要处理大量无效字段

2. 相同映射限制（设计缺陷）：
   同一Index下不同Type的同名字段必须有完全相同的映射定义。
   
   错误示例：
   Type: product
   {
     &quot;title&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;standard&quot;}
   }
   
   Type: category  
   {
     &quot;title&quot;: {&quot;type&quot;: &quot;keyword&quot;}  // 错误！与product.title映射冲突
   }
   
   正确做法：
   两个Type的title字段必须有相同的映射：
   {
     &quot;title&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;standard&quot;}
   }
   
   这严重限制了数据建模的灵活性，不同业务实体的同名字段往往需要不同的处理方式。

3. 性能问题：
   - Lucene本身没有Type概念，ES需要额外的_type字段来区分
   - 查询时需要额外的过滤条件：{&quot;term&quot;: {&quot;_type&quot;: &quot;post&quot;}}
   - 增加了查询复杂度和处理开销

4. 路由和分片问题：
   - 不同Type的文档可能分布在同一分片上
   - 无法针对特定Type进行独立的分片策略优化
   - 影响了数据的局部性原理

解决方案演进：
- ES 6.0: 限制每个Index只能有一个Type
- ES 7.0: Type参数被废弃，默认使用_doc
- ES 8.0: 完全移除Type概念

最佳实践：
- 为不同的数据类型创建独立的Index
- 使用Index模板管理相似结构的多个Index
- 通过别名(Alias)实现跨Index查询
</div><p id="qg4rcd_82"><span class="control" id="qg4rcd_143">架构演进图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 986.921875 534"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="986.921875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M381.512,50.439L338.508,56.532C295.505,62.626,209.499,74.813,166.495,82.99C123.492,91.167,123.492,95.333,123.492,98.833C123.492,102.333,123.492,105.167,123.492,106.583L123.492,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M426.066,62L416.128,66.167C406.19,70.333,386.314,78.667,376.376,84.917C366.438,91.167,366.438,95.333,366.438,98.833C366.438,102.333,366.438,105.167,366.438,106.583L366.438,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M554.864,62L564.802,66.167C574.74,70.333,594.616,78.667,604.554,84.917C614.492,91.167,614.492,95.333,614.492,98.833C614.492,102.333,614.492,105.167,614.492,106.583L614.492,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M599.418,50.282L643.05,56.401C686.682,62.521,773.947,74.761,817.579,82.964C861.211,91.167,861.211,95.333,861.211,98.833C861.211,102.333,861.211,105.167,861.211,106.583L861.211,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_4" d="M123.492,166L123.492,170.167C123.492,174.333,123.492,182.667,123.492,188.917C123.492,195.167,123.492,199.333,123.492,202.833C123.492,206.333,123.492,209.167,123.492,210.583L123.492,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B2_5" d="M123.492,270L123.492,274.167C123.492,278.333,123.492,286.667,123.492,292.917C123.492,299.167,123.492,303.333,123.492,306.833C123.492,310.333,123.492,313.167,123.492,314.583L123.492,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B2_B3_6" d="M123.492,422L123.492,426.167C123.492,430.333,123.492,438.667,123.492,444.917C123.492,451.167,123.492,455.333,123.492,458.833C123.492,462.333,123.492,465.167,123.492,466.583L123.492,468"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_7" d="M366.438,166L366.438,170.167C366.438,174.333,366.438,182.667,366.438,188.917C366.438,195.167,366.438,199.333,366.438,202.833C366.438,206.333,366.438,209.167,366.438,210.583L366.438,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C2_8" d="M366.438,270L366.438,274.167C366.438,278.333,366.438,286.667,366.438,293.917C366.438,301.167,366.438,307.333,366.438,312.833C366.438,318.333,366.438,323.167,366.438,325.583L366.438,328"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_9" d="M614.492,166L614.492,170.167C614.492,174.333,614.492,182.667,614.492,188.917C614.492,195.167,614.492,199.333,614.492,202.833C614.492,206.333,614.492,209.167,614.492,210.583L614.492,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D1_D2_10" d="M614.492,270L614.492,274.167C614.492,278.333,614.492,286.667,614.492,294.917C614.492,303.167,614.492,311.333,614.492,318.833C614.492,326.333,614.492,333.167,614.492,336.583L614.492,340"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_11" d="M861.211,166L861.211,170.167C861.211,174.333,861.211,182.667,861.211,188.917C861.211,195.167,861.211,199.333,861.211,202.833C861.211,206.333,861.211,209.167,861.211,210.583L861.211,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_E2_12" d="M861.211,270L861.211,274.167C861.211,278.333,861.211,286.667,861.211,294.917C861.211,303.167,861.211,311.333,861.211,318.833C861.211,326.333,861.211,333.167,861.211,336.583L861.211,340"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(490.46484375, 35)" id="flowchart-A-21510" class="node default"><rect height="54" width="217.90625" y="-27" x="-108.953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-78.953125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="157.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Elasticsearch架构演进</p></span></div></foreignObject></g></g><g transform="translate(123.4921875, 139)" id="flowchart-B-21511" class="node default"><rect height="54" width="151.59375" y="-27" x="-75.796875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.796875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="91.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ES 5.x及之前</p></span></div></foreignObject></g></g><g transform="translate(366.4375, 139)" id="flowchart-C-21513" class="node default"><rect height="54" width="103.890625" y="-27" x="-51.9453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-21.9453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="43.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ES 6.0</p></span></div></foreignObject></g></g><g transform="translate(614.4921875, 139)" id="flowchart-D-21515" class="node default"><rect height="54" width="103.890625" y="-27" x="-51.9453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-21.9453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="43.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ES 7.0</p></span></div></foreignObject></g></g><g transform="translate(861.2109375, 139)" id="flowchart-E-21517" class="node default"><rect height="54" width="103.890625" y="-27" x="-51.9453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-21.9453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="43.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ES 8.0</p></span></div></foreignObject></g></g><g transform="translate(123.4921875, 243)" id="flowchart-B1-21519" class="node default"><rect height="54" width="141.15625" y="-27" x="-70.578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="81.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>多Type支持</p></span></div></foreignObject></g></g><g transform="translate(123.4921875, 371)" id="flowchart-B2-21521" class="node default"><rect height="102" width="209.515625" y="-51" x="-104.7578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-74.7578125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="149.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Index: blog<br>├── Type: post<br>└── Type: comment</p></span></div></foreignObject></g></g><g transform="translate(123.4921875, 499)" id="flowchart-B3-21523" class="node default"><rect height="54" width="230.984375" y="-27" x="-115.4921875" data-et="node" data-id="abc" style="fill:#ffcccc !important" class="basic label-container"></rect><g transform="translate(-85.4921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="170.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>问题: 稀疏性、映射冲突</p></span></div></foreignObject></g></g><g transform="translate(366.4375, 243)" id="flowchart-C1-21525" class="node default"><rect height="54" width="238.9375" y="-27" x="-119.46875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-89.46875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="178.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>限制: 一个Index一个Type</p></span></div></foreignObject></g></g><g transform="translate(366.4375, 371)" id="flowchart-C2-21527" class="node default"><rect height="78" width="176.375" y="-39" x="-88.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.1875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="116.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Index: blog<br>└── Type: _doc</p></span></div></foreignObject></g></g><g transform="translate(614.4921875, 243)" id="flowchart-D1-21529" class="node default"><rect height="54" width="157.171875" y="-27" x="-78.5859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.5859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="97.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Type参数废弃</p></span></div></foreignObject></g></g><g transform="translate(614.4921875, 371)" id="flowchart-D2-21531" class="node default"><rect height="54" width="158.015625" y="-27" x="-79.0078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-49.0078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="98.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>默认使用_doc</p></span></div></foreignObject></g></g><g transform="translate(861.2109375, 243)" id="flowchart-E1-21533" class="node default"><rect height="54" width="157.171875" y="-27" x="-78.5859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.5859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="97.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>完全移除Type</p></span></div></foreignObject></g></g><g transform="translate(861.2109375, 371)" id="flowchart-E2-21535" class="node default"><rect height="54" width="235.421875" y="-27" x="-117.7109375" data-et="node" data-id="abc" style="fill:#ccffcc !important" class="basic label-container"></rect><g transform="translate(-87.7109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="175.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Index直接包含Document</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_84"><span class="control" id="qg4rcd_144">Type稀疏性问题示意图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 635.8125 903"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="635.8125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="subGraph1" class="cluster"><rect height="330" width="619.8125" y="8" x="8" style=""></rect><g transform="translate(250.5625, 8)" class="cluster-label"><foreignObject height="24" width="134.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>新架构 - 独立Index</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D1_E1_4" d="M164,99.5L164,105.75C164,112,164,124.5,164,133.875C164,143.25,164,149.5,164,155.083C164,160.667,164,165.583,164,168.042L164,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D2_E2_5" d="M463.906,99.5L463.906,105.75C463.906,112,463.906,124.5,463.906,133.875C463.906,143.25,463.906,149.5,463.906,155.083C463.906,160.667,463.906,165.583,463.906,168.042L463.906,170.5"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(164, 72.5)" id="flowchart-D1-21546" class="node default"><rect height="54" width="179.5" y="-27" x="-89.75" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-59.75, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="119.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>blog_posts Index</p></span></div></foreignObject></g></g><g transform="translate(164, 237.5)" id="flowchart-E1-21547" class="node default"><rect height="126" width="242" y="-63" x="-121" data-et="node" data-id="abc" style="fill:#ccffcc !important" class="basic label-container"></rect><g transform="translate(-91, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="182"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>title: 文章<br>content: 内容<br>author: 张三<br>publish_date: 2023-01-01</p></span></div></foreignObject></g></g><g transform="translate(463.90625, 72.5)" id="flowchart-D2-21548" class="node default"><rect height="54" width="216.140625" y="-27" x="-108.0703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-78.0703125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="156.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>blog_comments Index</p></span></div></foreignObject></g></g><g transform="translate(463.90625, 237.5)" id="flowchart-E2-21549" class="node default"><rect height="126" width="257.8125" y="-63" x="-128.90625" data-et="node" data-id="abc" style="fill:#ccffcc !important" class="basic label-container"></rect><g transform="translate(-98.90625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="197.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>title: 评论<br>content: 回复<br>comment_date: 2023-01-02<br>parent_id: 1</p></span></div></foreignObject></g></g></g></g><g transform="translate(0, 380)" class="root"><g class="clusters"><g data-look="classic" id="subGraph0" class="cluster"><rect height="507" width="619.8125" y="8" x="8" style=""></rect><g transform="translate(226.015625, 8)" class="cluster-label"><foreignObject height="24" width="183.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>旧架构 - 同一Index多Type</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A1_B1_0" d="M251.182,99.5L236.652,105.75C222.121,112,193.061,124.5,178.53,133.875C164,143.25,164,149.5,164,155.083C164,160.667,164,165.583,164,168.042L164,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A1_B2_1" d="M376.724,99.5L391.255,105.75C405.785,112,434.846,124.5,449.376,133.875C463.906,143.25,463.906,149.5,463.906,155.083C463.906,160.667,463.906,165.583,463.906,168.042L463.906,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_C1_2" d="M164,228.5L164,234.75C164,241,164,253.5,164,262.875C164,272.25,164,278.5,164,284.083C164,289.667,164,294.583,164,297.042L164,299.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B2_C2_3" d="M463.906,228.5L463.906,234.75C463.906,241,463.906,253.5,463.906,262.875C463.906,272.25,463.906,278.5,463.906,284.083C463.906,289.667,463.906,294.583,463.906,297.042L463.906,299.5"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(313.953125, 72.5)" id="flowchart-A1-21538" class="node default"><rect height="54" width="134.171875" y="-27" x="-67.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-37.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="74.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>blog Index</p></span></div></foreignObject></g></g><g transform="translate(164, 201.5)" id="flowchart-B1-21539" class="node default"><rect height="54" width="128.046875" y="-27" x="-64.0234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-34.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="68.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>post Type</p></span></div></foreignObject></g></g><g transform="translate(463.90625, 201.5)" id="flowchart-B2-21541" class="node default"><rect height="54" width="164.6875" y="-27" x="-82.34375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.34375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="104.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>comment Type</p></span></div></foreignObject></g></g><g transform="translate(164, 390.5)" id="flowchart-C1-21543" class="node default"><rect height="174" width="242" y="-87" x="-121" data-et="node" data-id="abc" style="fill:#ffcccc !important" class="basic label-container"></rect><g transform="translate(-91, -72)" style="" class="label"><rect></rect><foreignObject height="144" width="182"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>title: 文章<br>content: 内容<br>author: 张三<br>publish_date: 2023-01-01<br>comment_date: null<br>parent_id: null</p></span></div></foreignObject></g></g><g transform="translate(463.90625, 390.5)" id="flowchart-C2-21545" class="node default"><rect height="174" width="257.8125" y="-87" x="-128.90625" data-et="node" data-id="abc" style="fill:#ffcccc !important" class="basic label-container"></rect><g transform="translate(-98.90625, -72)" style="" class="label"><rect></rect><foreignObject height="144" width="197.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>title: 评论<br>content: 回复<br>author: null<br>publish_date: null<br>comment_date: 2023-01-02<br>parent_id: 1</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="qg4rcd_86"><span class="control" id="qg4rcd_145">Q2: 什么是分片(Shard)？主分片和副本分片有什么区别？</span></p><p id="qg4rcd_87"><span class="control" id="qg4rcd_146">标准回答:</span></p><div class="code-block" data-lang="none">
分片是Elasticsearch实现分布式存储和并行处理的核心机制，基于Lucene索引实现。

1. 分片的本质和作用：
   - 每个分片本质上是一个独立的Lucene索引
   - 将大索引水平切分为多个小索引，分布在不同节点上
   - 实现数据的分布式存储和并行查询处理
   - 突破单机存储和处理能力的限制

2. 主分片(Primary Shard)详解：
   
   特性：
   - 索引数据的主要存储单元，每个文档只存在于一个主分片
   - 数量在索引创建时确定，后续无法修改（这是设计限制）
   - 负责处理所有写入请求（索引、更新、删除）
   - 可以处理读取请求
   
   为什么主分片数量不能修改？
   - 分片路由算法依赖主分片数量：shard = hash(routing) % number_of_primary_shards
   - 如果改变主分片数量，会导致文档路由到错误的分片
   - 需要重建整个索引才能改变主分片数量
   
   示例配置：
   {
     &quot;settings&quot;: {
       &quot;number_of_shards&quot;: 3,        // 主分片数量，创建后不可修改
       &quot;number_of_replicas&quot;: 1       // 副本数量，可动态调整
     }
   }

3. 副本分片(Replica Shard)详解：
   
   特性：
   - 主分片的完整拷贝，包含相同的数据和索引结构
   - 数量可以动态调整：PUT /index/_settings {&quot;number_of_replicas&quot;: 2}
   - 提供数据冗余，防止数据丢失
   - 分担读取负载，提升查询性能
   - 主分片故障时自动提升为主分片（故障转移）
   
   分布策略：
   - 副本分片不会与对应的主分片分配在同一节点上
   - 确保节点故障时数据仍然可用
   - 集群会自动重新分配分片以维持副本策略

4. 分片路由机制详解：
   
   路由算法：
   shard = hash(document_id) % number_of_primary_shards
   
   自定义路由：
   PUT /index/_doc/1?routing=user123
   {
     &quot;user&quot;: &quot;user123&quot;,
     &quot;message&quot;: &quot;Hello&quot;
   }
   
   路由的重要性：
   - 确保相关文档存储在同一分片（提升查询性能）
   - 避免跨分片查询的网络开销
   - 实现数据的局部性原理

5. 分片分配和重平衡：
   
   分配原则：
   - 主分片和副本分片不在同一节点
   - 尽量均匀分布在所有数据节点上
   - 考虑节点的磁盘使用率和负载

   重平衡触发条件：
   - 节点加入或离开集群
   - 分片故障或恢复
   - 副本数量调整
   - 手动触发重平衡

6. 分片大小最佳实践：
   
   推荐分片大小：20GB - 40GB
   - 太小：管理开销大，查询需要访问更多分片
   - 太大：故障恢复时间长，重平衡困难
   
   分片数量计算：
   分片数 = 预期数据量 / 目标分片大小
   
   示例：
   - 预期数据量：1TB
   - 目标分片大小：30GB
   - 建议分片数：1024GB / 30GB ≈ 34个分片

7. 分片状态和健康检查：
   
   分片状态：
   - STARTED：正常运行状态
   - INITIALIZING：初始化中
   - RELOCATING：重新分配中
   - UNASSIGNED：未分配到节点

   健康检查命令：
   GET _cat/shards?v                    // 查看所有分片状态
   GET _cluster/allocation/explain      // 分析分片分配问题
   GET _cat/indices?v&amp;health=yellow     // 查看异常索引

8. 分片相关的性能考虑：
   
   写入性能：
   - 主分片数量影响写入并发度
   - 更多主分片 = 更高写入并发
   - 但过多分片会增加协调开销
   
   查询性能：
   - 查询需要访问所有相关分片
   - 分片数量影响查询延迟
   - 副本分片可以分担查询负载
   
   存储开销：
   - 每个分片都有固定的内存开销（约10MB）
   - 过多小分片会浪费内存资源

9. 故障恢复机制：
   
   主分片故障：
   - 自动从副本分片中选择一个提升为主分片
   - 如果没有副本，该分片数据暂时不可用
   - 集群状态变为Yellow或Red
   
   副本分片故障：
   - 在其他节点上重新创建副本
   - 从主分片复制数据到新副本
   - 不影响数据可用性

10. 企业级节点角色分离架构：

    在企业生产环境中，通常采用节点角色分离的架构设计：
    
    主节点(Master Node)配置：
    - 角色：node.master: true, node.data: false, node.ingest: false
    - 职责：集群状态管理、分片分配决策、索引创建/删除
    - 硬件配置：CPU密集型，内存中等，存储空间较小(20-50GB)
    - 数量：通常3个节点，避免脑裂问题
    - 不存储分片数据，专注于集群管理
    
    数据节点(Data Node)配置：
    - 角色：node.master: false, node.data: true, node.ingest: false  
    - 职责：存储分片数据、执行查询和聚合、处理索引操作
    - 硬件配置：存储密集型，大内存，大磁盘空间(1TB-10TB+)
    - 数量：根据数据量和性能需求扩展
    - 承载所有的主分片和副本分片
    
    协调节点(Coordinating Node)配置：
    - 角色：node.master: false, node.data: false, node.ingest: false
    - 职责：请求路由、结果聚合、负载均衡
    - 硬件配置：CPU和内存密集型，存储空间最小
    - 通常作为客户端接入点
    
    摄取节点(Ingest Node)配置：
    - 角色：node.master: false, node.data: false, node.ingest: true
    - 职责：数据预处理、文档转换、管道处理
    - 硬件配置：CPU密集型，中等内存
    
    企业级架构示例：
    ```
    集群架构 (生产环境)：
    ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
    │   Master Node   │  │   Master Node   │  │   Master Node   │
    │   CPU: 4核      │  │   CPU: 4核      │  │   CPU: 4核      │
    │   RAM: 8GB      │  │   RAM: 8GB      │  │   RAM: 8GB      │
    │   Disk: 50GB    │  │   Disk: 50GB    │  │   Disk: 50GB    │
    └─────────────────┘  └─────────────────┘  └─────────────────┘
    
    ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
    │   Data Node 1   │  │   Data Node 2   │  │   Data Node 3   │
    │   CPU: 16核     │  │   CPU: 16核     │  │   CPU: 16核     │
    │   RAM: 64GB     │  │   RAM: 64GB     │  │   RAM: 64GB     │
    │   Disk: 2TB SSD │  │   Disk: 2TB SSD │  │   Disk: 2TB SSD │
    └─────────────────┘  └─────────────────┘  └─────────────────┘
    
    ┌─────────────────┐  ┌─────────────────┐
    │ Coordinating 1  │  │ Coordinating 2  │
    │   CPU: 8核      │  │   CPU: 8核      │
    │   RAM: 16GB     │  │   RAM: 16GB     │
    │   Disk: 100GB   │  │   Disk: 100GB   │
    └─────────────────┘  └─────────────────┘
    ```
    
    分片分配策略：
    - 所有分片(主分片+副本分片)只分配到数据节点上
    - 主节点不承载任何分片，专注于集群管理
    - 协调节点处理客户端请求，不存储数据
    - 通过分片分配过滤器确保分片分布：
    
    ```json
    {
      &quot;settings&quot;: {
        &quot;index.routing.allocation.include.node_type&quot;: &quot;data&quot;,
        &quot;index.routing.allocation.exclude.node_type&quot;: &quot;master&quot;
      }
    }
</div><p id="qg4rcd_89"><span class="control" id="qg4rcd_147">分析器组件结构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 2208.75 708"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="2208.75" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="subGraph2" class="cluster"><rect height="128" width="756.265625" y="572" x="1285.375" style=""></rect><g transform="translate(1569.125, 572)" class="cluster-label"><foreignObject height="24" width="188.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Token Filters (词项过滤器)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="128" width="777.734375" y="394" x="588.59375" style=""></rect><g transform="translate(910.7265625, 394)" class="cluster-label"><foreignObject height="24" width="133.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Tokenizer (分词器)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="128" width="665.65625" y="216" x="8" style=""></rect><g transform="translate(240.828125, 216)" class="cluster-label"><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters (字符过滤器)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M442.547,62L442.547,66.167C442.547,70.333,442.547,78.667,442.547,84.917C442.547,91.167,442.547,95.333,442.547,98.833C442.547,102.333,442.547,105.167,442.547,106.583L442.547,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M533.164,146.698L620.085,154.081C707.005,161.465,880.846,176.233,967.767,187.783C1054.688,199.333,1054.688,207.667,1054.688,214.917C1054.688,222.167,1054.688,228.333,1054.688,233.833C1054.688,239.333,1054.688,244.167,1054.688,246.583L1054.688,249"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M1119.063,285.821L1226.297,295.518C1333.531,305.214,1548,324.607,1655.234,338.47C1762.469,352.333,1762.469,360.667,1762.469,369C1762.469,377.333,1762.469,385.667,1762.469,392.917C1762.469,400.167,1762.469,406.333,1762.469,411.833C1762.469,417.333,1762.469,422.167,1762.469,424.583L1762.469,427"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M1838.469,470.928L1888.507,479.44C1938.544,487.952,2038.62,504.976,2088.658,517.655C2138.695,530.333,2138.695,538.667,2138.695,547C2138.695,555.333,2138.695,563.667,2138.695,570.917C2138.695,578.167,2138.695,584.333,2138.695,589.833C2138.695,595.333,2138.695,600.167,2138.695,602.583L2138.695,605"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_4" d="M351.93,153.825L314.059,160.021C276.188,166.217,200.445,178.608,162.574,188.971C124.703,199.333,124.703,207.667,124.703,213.917C124.703,220.167,124.703,224.333,124.703,227.833C124.703,231.333,124.703,234.167,124.703,235.583L124.703,237"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_5" d="M386.438,166L377.779,170.167C369.12,174.333,351.802,182.667,343.143,191C334.484,199.333,334.484,207.667,334.484,213.917C334.484,220.167,334.484,224.333,334.484,227.833C334.484,231.333,334.484,234.167,334.484,235.583L334.484,237"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B3_6" d="M498.656,166L507.315,170.167C515.974,174.333,533.292,182.667,541.951,191C550.609,199.333,550.609,207.667,550.609,213.917C550.609,220.167,550.609,224.333,550.609,227.833C550.609,231.333,550.609,234.167,550.609,235.583L550.609,237"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_7" d="M990.313,291.412L940.87,300.176C891.427,308.941,792.542,326.471,743.099,339.402C693.656,352.333,693.656,360.667,693.656,369C693.656,377.333,693.656,385.667,693.656,391.917C693.656,398.167,693.656,402.333,693.656,405.833C693.656,409.333,693.656,412.167,693.656,413.583L693.656,415"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_8" d="M990.313,302.797L970.921,309.664C951.529,316.531,912.745,330.266,893.353,341.299C873.961,352.333,873.961,360.667,873.961,369C873.961,377.333,873.961,385.667,873.961,391.917C873.961,398.167,873.961,402.333,873.961,405.833C873.961,409.333,873.961,412.167,873.961,413.583L873.961,415"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C3_9" d="M1054.688,307L1054.688,313.167C1054.688,319.333,1054.688,331.667,1054.688,342C1054.688,352.333,1054.688,360.667,1054.688,369C1054.688,377.333,1054.688,385.667,1054.688,391.917C1054.688,398.167,1054.688,402.333,1054.688,405.833C1054.688,409.333,1054.688,412.167,1054.688,413.583L1054.688,415"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C4_10" d="M1119.063,300.749L1141.427,307.958C1163.792,315.166,1208.521,329.583,1230.885,340.958C1253.25,352.333,1253.25,360.667,1253.25,369C1253.25,377.333,1253.25,385.667,1253.25,391.917C1253.25,398.167,1253.25,402.333,1253.25,405.833C1253.25,409.333,1253.25,412.167,1253.25,413.583L1253.25,415"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_11" d="M1686.469,470.931L1636.445,479.443C1586.422,487.954,1486.375,504.977,1436.352,517.655C1386.328,530.333,1386.328,538.667,1386.328,547C1386.328,555.333,1386.328,563.667,1386.328,569.917C1386.328,576.167,1386.328,580.333,1386.328,583.833C1386.328,587.333,1386.328,590.167,1386.328,591.583L1386.328,593"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D2_12" d="M1686.469,483.583L1667.448,489.986C1648.427,496.389,1610.385,509.194,1591.365,519.764C1572.344,530.333,1572.344,538.667,1572.344,547C1572.344,555.333,1572.344,563.667,1572.344,569.917C1572.344,576.167,1572.344,580.333,1572.344,583.833C1572.344,587.333,1572.344,590.167,1572.344,591.583L1572.344,593"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D3_13" d="M1762.469,485L1762.469,491.167C1762.469,497.333,1762.469,509.667,1762.469,520C1762.469,530.333,1762.469,538.667,1762.469,547C1762.469,555.333,1762.469,563.667,1762.469,569.917C1762.469,576.167,1762.469,580.333,1762.469,583.833C1762.469,587.333,1762.469,590.167,1762.469,591.583L1762.469,593"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D4_14" d="M1838.469,484.708L1856.155,490.923C1873.841,497.139,1909.214,509.569,1926.9,519.951C1944.586,530.333,1944.586,538.667,1944.586,547C1944.586,555.333,1944.586,563.667,1944.586,569.917C1944.586,576.167,1944.586,580.333,1944.586,583.833C1944.586,587.333,1944.586,590.167,1944.586,591.583L1944.586,593"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(442.546875, 35)" id="flowchart-A-21554" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e3f2fd !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>原始文本</p></span></div></foreignObject></g></g><g transform="translate(442.546875, 139)" id="flowchart-B-21555" class="node default"><rect height="54" width="181.234375" y="-27" x="-90.6171875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-60.6171875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="121.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters</p></span></div></foreignObject></g></g><g transform="translate(1054.6875, 280)" id="flowchart-C-21557" class="node default"><rect height="54" width="128.75" y="-27" x="-64.375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-34.375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="68.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Tokenizer</p></span></div></foreignObject></g></g><g transform="translate(1762.46875, 458)" id="flowchart-D-21559" class="node default"><rect height="54" width="152" y="-27" x="-76" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="92"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Token Filters</p></span></div></foreignObject></g></g><g transform="translate(2138.6953125, 636)" id="flowchart-E-21561" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>最终词项</p></span></div></foreignObject></g></g><g transform="translate(124.703125, 280)" id="flowchart-B1-21562" class="node default"><rect height="78" width="163.40625" y="-39" x="-81.703125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-51.703125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="103.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>html_strip<br>移除HTML标签</p></span></div></foreignObject></g></g><g transform="translate(334.484375, 280)" id="flowchart-B2-21563" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>mapping<br>字符映射替换</p></span></div></foreignObject></g></g><g transform="translate(550.609375, 280)" id="flowchart-B3-21564" class="node default"><rect height="78" width="176.09375" y="-39" x="-88.046875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.046875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="116.09375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>pattern_replace<br>正则表达式替换</p></span></div></foreignObject></g></g><g transform="translate(693.65625, 458)" id="flowchart-C1-21565" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>standard<br>标准分词器</p></span></div></foreignObject></g></g><g transform="translate(873.9609375, 458)" id="flowchart-C2-21566" class="node default"><rect height="78" width="120.484375" y="-39" x="-60.2421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.2421875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="60.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>keyword<br>不分词</p></span></div></foreignObject></g></g><g transform="translate(1054.6875, 458)" id="flowchart-C3-21567" class="node default"><rect height="78" width="140.96875" y="-39" x="-70.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.484375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>whitespace<br>空格分词</p></span></div></foreignObject></g></g><g transform="translate(1253.25, 458)" id="flowchart-C4-21568" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ik_max_word<br>中文最大分词</p></span></div></foreignObject></g></g><g transform="translate(1386.328125, 636)" id="flowchart-D1-21569" class="node default"><rect height="78" width="131.90625" y="-39" x="-65.953125" data-et="node" data-id="abc" style="fill:#fce4ec !important" class="basic label-container"></rect><g transform="translate(-35.953125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="71.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>lowercase<br>转小写</p></span></div></foreignObject></g></g><g transform="translate(1572.34375, 636)" id="flowchart-D2-21570" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>stop<br>移除停用词</p></span></div></foreignObject></g></g><g transform="translate(1762.46875, 636)" id="flowchart-D3-21571" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>synonym<br>同义词替换</p></span></div></foreignObject></g></g><g transform="translate(1944.5859375, 636)" id="flowchart-D4-21572" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>stemmer<br>词干提取</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_91"><span class="control" id="qg4rcd_148">分析器处理流程示例:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 276 1046"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="276" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M138,110L138,114.167C138,118.333,138,126.667,138,132.917C138,139.167,138,143.333,138,146.833C138,150.333,138,153.167,138,154.583L138,156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M138,214L138,218.167C138,222.333,138,230.667,138,236.917C138,243.167,138,247.333,138,250.833C138,254.333,138,257.167,138,258.583L138,260"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M138,342L138,346.167C138,350.333,138,358.667,138,364.917C138,371.167,138,375.333,138,378.833C138,382.333,138,385.167,138,386.583L138,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M138,446L138,450.167C138,454.333,138,462.667,138,468.917C138,475.167,138,479.333,138,482.833C138,486.333,138,489.167,138,490.583L138,492"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M138,574L138,578.167C138,582.333,138,590.667,138,596.917C138,603.167,138,607.333,138,610.833C138,614.333,138,617.167,138,618.583L138,620"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_5" d="M138,678L138,682.167C138,686.333,138,694.667,138,700.917C138,707.167,138,711.333,138,714.833C138,718.333,138,721.167,138,722.583L138,724"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_6" d="M138,806L138,810.167C138,814.333,138,822.667,138,828.917C138,835.167,138,839.333,138,842.833C138,846.333,138,849.167,138,850.583L138,852"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_7" d="M138,910L138,914.167C138,918.333,138,926.667,138,932.917C138,939.167,138,943.333,138,946.833C138,950.333,138,953.167,138,954.583L138,956"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(138, 59)" id="flowchart-A-21600" class="node default"><rect height="102" width="258.765625" y="-51" x="-129.3828125" data-et="node" data-id="abc" style="fill:#ffebee !important" class="basic label-container"></rect><g transform="translate(-99.3828125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="198.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>原始文本: '</p><p>Elasticsearch is POWERFUL!</p>'<p></p></span></div></foreignObject></g></g><g transform="translate(138, 187)" id="flowchart-B-21601" class="node default"><rect height="54" width="259.71875" y="-27" x="-129.859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-99.859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="199.71875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filter: html_strip</p></span></div></foreignObject></g></g><g transform="translate(138, 303)" id="flowchart-C-21603" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>处理后: 'Elasticsearch is POWERFUL!'</p></span></div></foreignObject></g></g><g transform="translate(138, 419)" id="flowchart-D-21605" class="node default"><rect height="54" width="202.109375" y="-27" x="-101.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-71.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="142.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Tokenizer: standard</p></span></div></foreignObject></g></g><g transform="translate(138, 535)" id="flowchart-E-21607" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>词项流: ['Elasticsearch', 'is', 'POWERFUL']</p></span></div></foreignObject></g></g><g transform="translate(138, 651)" id="flowchart-F-21609" class="node default"><rect height="54" width="228.15625" y="-27" x="-114.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-84.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="168.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Token Filter: lowercase</p></span></div></foreignObject></g></g><g transform="translate(138, 767)" id="flowchart-G-21611" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>处理后: ['elasticsearch', 'is', 'powerful']</p></span></div></foreignObject></g></g><g transform="translate(138, 883)" id="flowchart-H-21613" class="node default"><rect height="54" width="186.671875" y="-27" x="-93.3359375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.3359375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="126.671875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Token Filter: stop</p></span></div></foreignObject></g></g><g transform="translate(138, 999)" id="flowchart-I-21615" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>最终结果: ['elasticsearch', 'powerful']</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_93"><span class="control" id="qg4rcd_149">内置分析器对比图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1516 478"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1516" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M687.938,40.876L596.281,48.564C504.625,56.251,321.313,71.625,229.656,81.396C138,91.167,138,95.333,138,98.833C138,102.333,138,105.167,138,106.583L138,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M687.938,46.752L647.948,53.46C607.958,60.168,527.979,73.584,487.99,82.375C448,91.167,448,95.333,448,98.833C448,102.333,448,105.167,448,106.583L448,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M758,62L758,66.167C758,70.333,758,78.667,758,84.917C758,91.167,758,95.333,758,98.833C758,102.333,758,105.167,758,106.583L758,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M828.063,46.752L868.052,53.46C908.042,60.168,988.021,73.584,1028.01,82.375C1068,91.167,1068,95.333,1068,98.833C1068,102.333,1068,105.167,1068,106.583L1068,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_F_4" d="M828.063,40.876L919.719,48.564C1011.375,56.251,1194.688,71.625,1286.344,81.396C1378,91.167,1378,95.333,1378,98.833C1378,102.333,1378,105.167,1378,106.583L1378,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_5" d="M138,166L138,170.167C138,174.333,138,182.667,138,189.917C138,197.167,138,203.333,138,208.833C138,214.333,138,219.167,138,221.583L138,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B2_6" d="M138,330L138,336.167C138,342.333,138,354.667,138,362.917C138,371.167,138,375.333,138,378.833C138,382.333,138,385.167,138,386.583L138,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_7" d="M448,166L448,170.167C448,174.333,448,182.667,448,189.917C448,197.167,448,203.333,448,208.833C448,214.333,448,219.167,448,221.583L448,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C2_8" d="M448,330L448,336.167C448,342.333,448,354.667,448,362.917C448,371.167,448,375.333,448,378.833C448,382.333,448,385.167,448,386.583L448,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_9" d="M758,166L758,170.167C758,174.333,758,182.667,758,189.917C758,197.167,758,203.333,758,208.833C758,214.333,758,219.167,758,221.583L758,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D1_D2_10" d="M758,330L758,336.167C758,342.333,758,354.667,758,362.917C758,371.167,758,375.333,758,378.833C758,382.333,758,385.167,758,386.583L758,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_11" d="M1068,166L1068,170.167C1068,174.333,1068,182.667,1068,189.917C1068,197.167,1068,203.333,1068,208.833C1068,214.333,1068,219.167,1068,221.583L1068,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_E2_12" d="M1068,330L1068,336.167C1068,342.333,1068,354.667,1068,362.917C1068,371.167,1068,375.333,1068,378.833C1068,382.333,1068,385.167,1068,386.583L1068,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_F1_13" d="M1378,166L1378,170.167C1378,174.333,1378,182.667,1378,188.917C1378,195.167,1378,199.333,1378,202.833C1378,206.333,1378,209.167,1378,210.583L1378,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F1_F2_14" d="M1378,342L1378,346.167C1378,350.333,1378,358.667,1378,364.917C1378,371.167,1378,375.333,1378,378.833C1378,382.333,1378,385.167,1378,386.583L1378,388"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(758, 35)" id="flowchart-A-21621" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内置分析器</p></span></div></foreignObject></g></g><g transform="translate(138, 139)" id="flowchart-B-21622" class="node default"><rect height="54" width="122.625" y="-27" x="-61.3125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.3125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="62.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>standard</p></span></div></foreignObject></g></g><g transform="translate(448, 139)" id="flowchart-C-21624" class="node default"><rect height="54" width="106.828125" y="-27" x="-53.4140625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-23.4140625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="46.828125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>simple</p></span></div></foreignObject></g></g><g transform="translate(758, 139)" id="flowchart-D-21626" class="node default"><rect height="54" width="140.96875" y="-27" x="-70.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.484375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>whitespace</p></span></div></foreignObject></g></g><g transform="translate(1068, 139)" id="flowchart-E-21628" class="node default"><rect height="54" width="120.484375" y="-27" x="-60.2421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.2421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="60.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>keyword</p></span></div></foreignObject></g></g><g transform="translate(1378, 139)" id="flowchart-F-21630" class="node default"><rect height="54" width="124" y="-27" x="-62" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>language</p></span></div></foreignObject></g></g><g transform="translate(138, 279)" id="flowchart-B1-21632" class="node default"><rect height="102" width="234.65625" y="-51" x="-117.328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-87.328125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="174.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters: 无<br>Tokenizer: standard<br>Token Filters: lowercase</p></span></div></foreignObject></g></g><g transform="translate(138, 431)" id="flowchart-B2-21634" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>'Hello World!' → ['hello', 'world']</p></span></div></foreignObject></g></g><g transform="translate(448, 279)" id="flowchart-C1-21636" class="node default"><rect height="102" width="234.65625" y="-51" x="-117.328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-87.328125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="174.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters: 无<br>Tokenizer: simple<br>Token Filters: lowercase</p></span></div></foreignObject></g></g><g transform="translate(448, 431)" id="flowchart-C2-21638" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>'Hello-World!' → ['hello', 'world']</p></span></div></foreignObject></g></g><g transform="translate(758, 279)" id="flowchart-D1-21640" class="node default"><rect height="102" width="220.453125" y="-51" x="-110.2265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-80.2265625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="160.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters: 无<br>Tokenizer: whitespace<br>Token Filters: 无</p></span></div></foreignObject></g></g><g transform="translate(758, 431)" id="flowchart-D2-21642" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>'Hello World!' → ['Hello', 'World!']</p></span></div></foreignObject></g></g><g transform="translate(1068, 279)" id="flowchart-E1-21644" class="node default"><rect height="102" width="208" y="-51" x="-104" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-74, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="148"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters: 无<br>Tokenizer: keyword<br>Token Filters: 无</p></span></div></foreignObject></g></g><g transform="translate(1068, 431)" id="flowchart-E2-21646" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>'Hello World!' → ['Hello World!']</p></span></div></foreignObject></g></g><g transform="translate(1378, 279)" id="flowchart-F1-21648" class="node default"><rect height="126" width="260" y="-63" x="-130" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-100, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Character Filters: 无<br>Tokenizer: standard<br>Token Filters: lowercase, stop, stemmer</p></span></div></foreignObject></g></g><g transform="translate(1378, 431)" id="flowchart-F2-21650" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#fce4ec !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>'running quickly' → ['run', 'quick']</p></span></div></foreignObject></g></g></g></g></g></svg><div class="code-block" data-lang="none">为什么要进行节点角色分离？

1. 资源优化：
   - 主节点：轻量级管理任务，不需要大存储
   - 数据节点：重存储和计算，需要大磁盘和内存
   - 避免资源浪费和配置不当

2. 性能隔离：
   - 主节点专注集群管理，避免被数据操作影响
   - 数据节点专注数据处理，避免被管理任务干扰
   - 提升整体集群稳定性

3. 扩展灵活性：
   - 可以独立扩展数据节点来增加存储和计算能力
   - 主节点数量保持稳定(通常3个)
   - 根据业务需求灵活调整架构

4. 故障隔离：
   - 数据节点故障不影响集群管理
   - 主节点故障不影响数据存储
   - 提升系统可用性

配置示例：

主节点配置(elasticsearch.yml)：
```yaml
node.name: master-node-1
node.master: true
node.data: false
node.ingest: false
node.ml: false
cluster.name: production-cluster
discovery.seed_hosts: [&quot;master-1&quot;, &quot;master-2&quot;, &quot;master-3&quot;]
cluster.initial_master_nodes: [&quot;master-1&quot;, &quot;master-2&quot;, &quot;master-3&quot;]
```

数据节点配置(elasticsearch.yml)：
```yaml
node.name: data-node-1
node.master: false
node.data: true
node.ingest: false
node.ml: false
cluster.name: production-cluster
discovery.seed_hosts: [&quot;master-1&quot;, &quot;master-2&quot;, &quot;master-3&quot;]
```
</div><p id="qg4rcd_96">实际应用示例： 假设有一个电商索引，包含1000万商品的企业级部署：</p><ul class="list _bullet" id="qg4rcd_97"><li class="list__item" id="qg4rcd_150"><p id="qg4rcd_156">3个主节点：专门负责集群管理，小存储配置</p></li><li class="list__item" id="qg4rcd_151"><p id="qg4rcd_157">6个数据节点：每个节点2TB存储，承载所有分片</p></li><li class="list__item" id="qg4rcd_152"><p id="qg4rcd_158">2个协调节点：处理客户端请求，负载均衡</p></li><li class="list__item" id="qg4rcd_153"><p id="qg4rcd_159">设置5个主分片，2个副本，总共15个分片</p></li><li class="list__item" id="qg4rcd_154"><p id="qg4rcd_160">所有分片分布在6个数据节点上，主节点不存储数据</p></li><li class="list__item" id="qg4rcd_155"><p id="qg4rcd_161">支持高并发读写，具备故障容错和水平扩展能力</p></li></ul><div class="code-block" data-lang="none">

**分片架构图:**
```mermaid
graph TB
    subgraph &quot;Elasticsearch集群&quot;
        subgraph &quot;主节点层 (管理)&quot;
            M1[Master Node 1&lt;br/&gt;CPU: 4核, RAM: 8GB&lt;br/&gt;Disk: 50GB]
            M2[Master Node 2&lt;br/&gt;CPU: 4核, RAM: 8GB&lt;br/&gt;Disk: 50GB]
            M3[Master Node 3&lt;br/&gt;CPU: 4核, RAM: 8GB&lt;br/&gt;Disk: 50GB]
        end
        
        subgraph &quot;协调节点层 (请求处理)&quot;
            C1[Coordinating Node 1&lt;br/&gt;CPU: 8核, RAM: 16GB&lt;br/&gt;Disk: 100GB]
            C2[Coordinating Node 2&lt;br/&gt;CPU: 8核, RAM: 16GB&lt;br/&gt;Disk: 100GB]
        end
        
        subgraph &quot;数据节点层 (存储)&quot;
            D1[Data Node 1&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
            D2[Data Node 2&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
            D3[Data Node 3&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
            D4[Data Node 4&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
            D5[Data Node 5&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
            D6[Data Node 6&lt;br/&gt;CPU: 16核, RAM: 64GB&lt;br/&gt;Disk: 2TB SSD]
        end
    end
    
    subgraph &quot;分片分布&quot;
        D1 --&gt; S1[P0, R1, R4]
        D2 --&gt; S2[P1, R2, R0]
        D3 --&gt; S3[P2, R3, R1]
        D4 --&gt; S4[P3, R4, R2]
        D5 --&gt; S5[P4, R0, R3]
        D6 --&gt; S6[R1, R2, R3]
    end
    
    Client[客户端] --&gt; C1
    Client --&gt; C2
    C1 -.-&gt; D1
    C1 -.-&gt; D2
    C1 -.-&gt; D3
    C2 -.-&gt; D4
    C2 -.-&gt; D5
    C2 -.-&gt; D6
    
    style M1 fill:#e1f5fe
    style M2 fill:#e1f5fe
    style M3 fill:#e1f5fe
    style C1 fill:#f3e5f5
    style C2 fill:#f3e5f5
    style D1 fill:#e8f5e8
    style D2 fill:#e8f5e8
    style D3 fill:#e8f5e8
    style D4 fill:#e8f5e8
    style D5 fill:#e8f5e8
    style D6 fill:#e8f5e8
</div><p id="qg4rcd_99"><span class="control" id="qg4rcd_162">分片路由机制图:</span></p><p id="qg4rcd_101"><span class="control" id="qg4rcd_163">分片故障恢复流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1250 809" style="max-width: 1250px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="DataC" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="1000"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="1075"><tspan dy="0" x="1075">数据节点C</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DataB" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="800"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="875"><tspan dy="0" x="875">数据节点B (R0)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="DataA" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="600"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="675"><tspan dy="0" x="675">数据节点A (P0)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Master" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="400"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="475"><tspan dy="0" x="475">主节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="275"><tspan dy="0" x="275">协调节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="723" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="755.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="DataC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="1075" y1="5" x1="1075" id="actor1273"></line><g id="root-1273"><rect class="actor actor-top" ry="3" rx="3" name="DataC" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1000"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1075"><tspan dy="0" x="1075">数据节点C</tspan></text></g></g><g><line name="DataB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="875" y1="5" x1="875" id="actor1272"></line><g id="root-1272"><rect class="actor actor-top" ry="3" rx="3" name="DataB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="800"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="875"><tspan dy="0" x="875">数据节点B (R0)</tspan></text></g></g><g><line name="DataA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="675" y1="5" x1="675" id="actor1271"></line><g id="root-1271"><rect class="actor actor-top" ry="3" rx="3" name="DataA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="600"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="675"><tspan dy="0" x="675">数据节点A (P0)</tspan></text></g></g><g><line name="Master" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="475" y1="5" x1="475" id="actor1270"></line><g id="root-1270"><rect class="actor actor-top" ry="3" rx="3" name="Master" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="400"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="475"><tspan dy="0" x="475">主节点</tspan></text></g></g><g><line name="Coord" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="275" y1="5" x1="275" id="actor1269"></line><g id="root-1269"><rect class="actor actor-top" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="275"><tspan dy="0" x="275">协调节点</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="723" x2="75" y1="5" x1="75" id="actor1268"></line><g id="root-1268"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="75" x="600"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="675"><tspan x="675">主分片P0故障</tspan></text></g><g><rect class="note" height="39" width="210" stroke="#666" fill="#EDF2AE" y="568" x="370"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="573" x="475"><tspan x="475">集群状态: Yellow → Green</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="477">节点故障</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#crosshead)" stroke="none" stroke-width="2" class="messageLine1" y2="162" x2="279" y1="162" x1="674"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="177" x="374">报告节点故障</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="210" x2="471" y1="210" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="225" x="476">检测到P0不可用</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 476,258 C 536,248 536,288 476,278"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="303" x="674">提升R0为新的P0</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="336" x2="871" y1="336" x1="476"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="351" x="876">R0 → P0 (提升为主分片)</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 876,384 C 936,374 936,414 876,404"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="429" x="774">在DataC创建新的R0</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="462" x2="1071" y1="462" x1="476"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="477" x="974">复制数据到新R0</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="510" x2="1071" y1="510" x1="876"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="525" x="377">更新集群状态</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="558" x2="279" y1="558" x1="474"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="622" x="174">新的写入请求</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="655" x2="271" y1="655" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="670" x="574">路由到新的P0</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="703" x2="871" y1="703" x1="276"></line></svg><p id="qg4rcd_103"><span class="control" id="qg4rcd_164">Q3: 请详细说明Elasticsearch的文档存储和检索流程</span></p><p id="qg4rcd_104"><span class="control" id="qg4rcd_165">标准回答:</span></p><div class="code-block" data-lang="none">
写入流程：
1. 客户端发送请求到协调节点
2. 协调节点根据文档ID计算目标分片
3. 请求转发到主分片所在节点
4. 主分片写入文档到内存buffer
5. 同步复制到所有副本分片
6. 返回成功响应

检索流程：
1. 客户端发送查询请求到协调节点
2. 协调节点将查询广播到所有相关分片
3. 各分片执行查询并返回结果
4. 协调节点合并结果并排序
5. 返回最终结果给客户端

关键点：
- refresh操作使文档可搜索（默认1秒）
- flush操作将数据持久化到磁盘
- 副本分片可以处理读请求，提升性能
</div><p id="qg4rcd_106"><span class="control" id="qg4rcd_166">文档写入流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1176.5 1254" style="max-width: 1176.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Replica2" height="65" width="150" stroke="#666" fill="#eaeaea" y="1168" x="906"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1200.5" x="981"><tspan dy="0" x="981">副本分片2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Replica1" height="65" width="150" stroke="#666" fill="#eaeaea" y="1168" x="706"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1200.5" x="781"><tspan dy="0" x="781">副本分片1</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Primary" height="65" width="150" stroke="#666" fill="#eaeaea" y="1168" x="506"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1200.5" x="581"><tspan dy="0" x="581">主分片节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="1168" x="306"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1200.5" x="381"><tspan dy="0" x="381">协调节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="1168" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1200.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="Replica2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1168" x2="981" y1="5" x1="981" id="actor1278"></line><g id="root-1278"><rect class="actor actor-top" ry="3" rx="3" name="Replica2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="906"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="981"><tspan dy="0" x="981">副本分片2</tspan></text></g></g><g><line name="Replica1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1168" x2="781" y1="5" x1="781" id="actor1277"></line><g id="root-1277"><rect class="actor actor-top" ry="3" rx="3" name="Replica1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="706"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="781"><tspan dy="0" x="781">副本分片1</tspan></text></g></g><g><line name="Primary" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1168" x2="581" y1="5" x1="581" id="actor1276"></line><g id="root-1276"><rect class="actor actor-top" ry="3" rx="3" name="Primary" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="506"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="581"><tspan dy="0" x="581">主分片节点</tspan></text></g></g><g><line name="Coord" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1168" x2="381" y1="5" x1="381" id="actor1275"></line><g id="root-1275"><rect class="actor actor-top" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="306"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="381"><tspan dy="0" x="381">协调节点</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1168" x2="75" y1="5" x1="75" id="actor1274"></line><g id="root-1274"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><line class="loopLine" y2="405" x2="992" y1="405" x1="570"></line><line class="loopLine" y2="546" x2="992" y1="405" x1="992"></line><line class="loopLine" y2="546" x2="992" y1="546" x1="570"></line><line class="loopLine" y2="546" x2="570" y1="405" x1="570"></line><polygon class="labelBox" points="570,405 620,405 620,418 611.6,425 570,425"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="418" x="595">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="423" x="806"><tspan x="806">[并行复制到副本]</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="904" x="506"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="909" x="581"><tspan x="581">定期refresh (1秒)</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="1031" x="506"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1036" x="581"><tspan x="581">定期flush</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="227">PUT /index/_doc/1 {document}</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="377" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="382">计算路由: hash(doc_id) % shards</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 382,161 C 442,151 442,191 382,181"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="480">转发写入请求</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="577" y1="239" x1="382"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="582">写入内存buffer</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 582,287 C 642,277 642,317 582,307"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="582">写入translog</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 582,365 C 642,355 642,395 582,385"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="455" x="680">同步复制文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="488" x2="777" y1="488" x1="582"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="503" x="780">同步复制文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="536" x2="977" y1="536" x1="582"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="561" x="782">写入内存buffer + translog</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 782,594 C 842,584 842,624 782,614"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="639" x="982">写入内存buffer + translog</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 982,672 C 1042,662 1042,702 982,692"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="717" x="683">确认写入成功</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="750" x2="585" y1="750" x1="780"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="765" x="783">确认写入成功</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="798" x2="585" y1="798" x1="980"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="813" x="483">返回写入成功</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="846" x2="385" y1="846" x1="580"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="861" x="230">返回响应 {result: created}</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="894" x2="79" y1="894" x1="380"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="958" x="582">buffer → segment (可搜索)</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 582,991 C 642,981 642,1021 582,1011"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1085" x="582">translog → disk (持久化)</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 582,1118 C 642,1108 642,1148 582,1138"></path></svg><p id="qg4rcd_108"><span class="control" id="qg4rcd_167">文档检索流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1132 1519" style="max-width: 1132px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Shard3" height="65" width="150" stroke="#666" fill="#eaeaea" y="1433" x="881"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1465.5" x="956"><tspan dy="0" x="956">分片3</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Shard2" height="65" width="150" stroke="#666" fill="#eaeaea" y="1433" x="681"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1465.5" x="756"><tspan dy="0" x="756">分片2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Shard1" height="65" width="150" stroke="#666" fill="#eaeaea" y="1433" x="481"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1465.5" x="556"><tspan dy="0" x="556">分片1</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="1433" x="280"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1465.5" x="355"><tspan dy="0" x="355">协调节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="1433" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1465.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="Shard3" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1433" x2="956" y1="5" x1="956" id="actor1283"></line><g id="root-1283"><rect class="actor actor-top" ry="3" rx="3" name="Shard3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="881"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="956"><tspan dy="0" x="956">分片3</tspan></text></g></g><g><line name="Shard2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1433" x2="756" y1="5" x1="756" id="actor1282"></line><g id="root-1282"><rect class="actor actor-top" ry="3" rx="3" name="Shard2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="681"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="756"><tspan dy="0" x="756">分片2</tspan></text></g></g><g><line name="Shard1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1433" x2="556" y1="5" x1="556" id="actor1281"></line><g id="root-1281"><rect class="actor actor-top" ry="3" rx="3" name="Shard1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="481"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="556"><tspan dy="0" x="556">分片1</tspan></text></g></g><g><line name="Coord" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1433" x2="355" y1="5" x1="355" id="actor1280"></line><g id="root-1280"><rect class="actor actor-top" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="280"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="355"><tspan dy="0" x="355">协调节点</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1433" x2="75" y1="5" x1="75" id="actor1279"></line><g id="root-1279"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="123" x="280"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="355"><tspan x="355">Query Phase</tspan></text></g><g><line class="loopLine" y2="172" x2="967" y1="172" x1="344"></line><line class="loopLine" y2="361" x2="967" y1="172" x1="967"></line><line class="loopLine" y2="361" x2="967" y1="361" x1="344"></line><line class="loopLine" y2="361" x2="344" y1="172" x1="344"></line><polygon class="labelBox" points="344,172 394,172 394,185 385.6,192 344,192"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="185" x="369">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="190" x="680.5"><tspan x="680.5">[广播查询到所有分片]</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="905" x="280"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="910" x="355"><tspan x="355">Fetch Phase</tspan></text></g><g><line class="loopLine" y2="954" x2="967" y1="954" x1="344"></line><line class="loopLine" y2="1143" x2="967" y1="954" x1="967"></line><line class="loopLine" y2="1143" x2="967" y1="1143" x1="344"></line><line class="loopLine" y2="1143" x2="344" y1="954" x1="344"></line><polygon class="labelBox" points="344,954 394,954 394,967 385.6,974 344,974"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="967" x="369">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="972" x="680.5"><tspan x="680.5">[获取完整文档]</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="214">GET /index/_search {query}</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="351" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="222" x="454">执行查询</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="255" x2="552" y1="255" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="270" x="554">执行查询</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="303" x2="752" y1="303" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="318" x="654">执行查询</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="351" x2="952" y1="351" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="376" x="557">本地搜索 + 评分</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 557,409 C 617,399 617,439 557,429"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="454" x="757">本地搜索 + 评分</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 757,487 C 817,477 817,517 757,507"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="532" x="957">本地搜索 + 评分</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 957,565 C 1017,555 1017,595 957,585"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="610" x="457">返回文档ID + 评分</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="643" x2="359" y1="643" x1="555"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="658" x="557">返回文档ID + 评分</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="691" x2="359" y1="691" x1="755"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="706" x="657">返回文档ID + 评分</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="739" x2="359" y1="739" x1="955"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="754" x="356">合并结果 + 全局排序</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 356,787 C 416,777 416,817 356,807"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="832" x="356">选择top N文档ID</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 356,865 C 416,855 416,895 356,885"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1004" x="454">获取指定文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1037" x2="552" y1="1037" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1052" x="554">获取指定文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1085" x2="752" y1="1085" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1100" x="654">获取指定文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1133" x2="952" y1="1133" x1="356"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1158" x="457">返回完整文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1191" x2="359" y1="1191" x1="555"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1206" x="557">返回完整文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1239" x2="359" y1="1239" x1="755"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1254" x="657">返回完整文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1287" x2="359" y1="1287" x1="955"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1302" x="356">组装最终结果</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 356,1335 C 416,1325 416,1365 356,1355"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1380" x="217">返回搜索结果</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1413" x2="79" y1="1413" x1="354"></line></svg><p id="qg4rcd_110"><span class="control" id="qg4rcd_168">文档生命周期图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 439.859375 1390"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="439.859375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M247.191,62L247.191,66.167C247.191,70.333,247.191,78.667,247.191,84.917C247.191,91.167,247.191,95.333,247.191,98.833C247.191,102.333,247.191,105.167,247.191,106.583L247.191,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M247.191,166L247.191,170.167C247.191,174.333,247.191,182.667,247.191,188.917C247.191,195.167,247.191,199.333,247.191,202.833C247.191,206.333,247.191,209.167,247.191,210.583L247.191,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M247.191,270L247.191,274.167C247.191,278.333,247.191,286.667,247.191,292.917C247.191,299.167,247.191,303.333,247.191,306.833C247.191,310.333,247.191,313.167,247.191,314.583L247.191,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M247.191,374L247.191,378.167C247.191,382.333,247.191,390.667,247.191,396.917C247.191,403.167,247.191,407.333,247.191,410.833C247.191,414.333,247.191,417.167,247.191,418.583L247.191,420"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M247.191,502L247.191,506.167C247.191,510.333,247.191,518.667,247.191,524.917C247.191,531.167,247.191,535.333,247.191,538.833C247.191,542.333,247.191,545.167,247.191,546.583L247.191,548"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_5" d="M247.191,606L247.191,610.167C247.191,614.333,247.191,622.667,247.191,628.917C247.191,635.167,247.191,639.333,247.191,642.833C247.191,646.333,247.191,649.167,247.191,650.583L247.191,652"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_6" d="M247.191,710L247.191,714.167C247.191,718.333,247.191,726.667,247.191,732.917C247.191,739.167,247.191,743.333,247.191,746.833C247.191,750.333,247.191,753.167,247.191,754.583L247.191,756"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_7" d="M247.191,814L247.191,818.167C247.191,822.333,247.191,830.667,247.191,836.917C247.191,843.167,247.191,847.333,247.191,850.833C247.191,854.333,247.191,857.167,247.191,858.583L247.191,860"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_8" d="M180.653,942L173.544,946.167C166.435,950.333,152.218,958.667,145.109,964.917C138,971.167,138,975.333,138,978.833C138,982.333,138,985.167,138,986.583L138,988"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_K_9" d="M313.73,942L320.839,946.167C327.948,950.333,342.165,958.667,349.274,964.917C356.383,971.167,356.383,975.333,356.383,978.833C356.383,982.333,356.383,985.167,356.383,986.583L356.383,988"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_L_10" d="M138,1046L138,1050.167C138,1054.333,138,1062.667,138,1068.917C138,1075.167,138,1079.333,138,1082.833C138,1086.333,138,1089.167,138,1090.583L138,1092"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_M_11" d="M138,1150L138,1154.167C138,1158.333,138,1166.667,138,1172.917C138,1179.167,138,1183.333,138,1186.833C138,1190.333,138,1193.167,138,1194.583L138,1196"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M_N_12" d="M138,1278L138,1282.167C138,1286.333,138,1294.667,138,1300.917C138,1307.167,138,1311.333,138,1314.833C138,1318.333,138,1321.167,138,1322.583L138,1324"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(247.19140625, 35)" id="flowchart-A-21659" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>新文档</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 139)" id="flowchart-B-21660" class="node default"><rect height="54" width="168.8125" y="-27" x="-84.40625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-54.40625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="108.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>写入内存Buffer</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 243)" id="flowchart-C-21662" class="node default"><rect height="54" width="150.953125" y="-27" x="-75.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>写入Translog</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 347)" id="flowchart-D-21664" class="node default"><rect height="54" width="145.6875" y="-27" x="-72.84375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.84375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="85.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>等待Refresh</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 463)" id="flowchart-E-21666" class="node default"><rect height="78" width="145.6875" y="-39" x="-72.84375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.84375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="85.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Refresh操作<br>默认1秒</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 579)" id="flowchart-F-21668" class="node default"><rect height="54" width="192.15625" y="-27" x="-96.078125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-66.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="132.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Buffer → Segment</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 683)" id="flowchart-G-21670" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文档可搜索</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 787)" id="flowchart-H-21672" class="node default"><rect height="54" width="129.25" y="-27" x="-64.625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-34.625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="69.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>等待Flush</p></span></div></foreignObject></g></g><g transform="translate(247.19140625, 903)" id="flowchart-I-21674" class="node default"><rect height="78" width="183" y="-39" x="-91.5" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-61.5, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="123"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Flush操作<br>Translog满或定时</p></span></div></foreignObject></g></g><g transform="translate(138, 1019)" id="flowchart-J-21676" class="node default"><rect height="54" width="185.8125" y="-27" x="-92.90625" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-62.90625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="125.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Segment写入磁盘</p></span></div></foreignObject></g></g><g transform="translate(356.3828125, 1019)" id="flowchart-K-21678" class="node default"><rect height="54" width="150.953125" y="-27" x="-75.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>清空Translog</p></span></div></foreignObject></g></g><g transform="translate(138, 1123)" id="flowchart-L-21680" class="node default"><rect height="54" width="135.234375" y="-27" x="-67.6171875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-37.6171875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="75.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Merge操作</p></span></div></foreignObject></g></g><g transform="translate(138, 1239)" id="flowchart-M-21682" class="node default"><rect height="78" width="260" y="-39" x="-130" data-et="node" data-id="abc" style="fill:#fce4ec !important" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>小Segment合并为大Segment</p></span></div></foreignObject></g></g><g transform="translate(138, 1355)" id="flowchart-N-21684" class="node default"><rect height="54" width="169.796875" y="-27" x="-84.8984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-54.8984375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="109.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>删除旧Segment</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_112"><span class="control" id="qg4rcd_169">Q4: Mapping的作用是什么？动态映射和静态映射的区别？</span></p><p id="qg4rcd_113"><span class="control" id="qg4rcd_170">标准回答:</span></p><div class="code-block" data-lang="none">
Mapping的作用：
1. 定义字段数据类型（text、keyword、date等）
2. 指定分析器和索引选项
3. 控制字段的存储和索引行为
4. 设置字段的格式和约束

动态映射 vs 静态映射：

动态映射：
- 自动推断字段类型
- 灵活但可能不准确
- 可能导致映射爆炸问题
- 适合快速原型开发

静态映射：
- 明确定义字段类型和属性
- 更好的性能和控制
- 避免意外的类型推断
- 生产环境推荐使用

示例：
{
  &quot;mappings&quot;: {
    &quot;dynamic&quot;: &quot;strict&quot;,  // 禁止动态映射
    &quot;properties&quot;: {
      &quot;title&quot;: {&quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;ik_max_word&quot;},
      &quot;price&quot;: {&quot;type&quot;: &quot;double&quot;},
      &quot;tags&quot;: {&quot;type&quot;: &quot;keyword&quot;}
    }
  }
}
</div><p id="qg4rcd_115"><span class="control" id="qg4rcd_171">Q5: 解释text和keyword字段类型的区别及使用场景</span></p><p id="qg4rcd_116"><span class="control" id="qg4rcd_172">标准回答:</span></p><div class="code-block" data-lang="none">
text类型：
- 用于全文搜索
- 会被分析器分词
- 支持模糊匹配和相关性评分
- 不支持聚合和排序（除非开启fielddata）
- 适用场景：文章内容、商品描述、评论等

keyword类型：
- 用于精确匹配
- 不会被分词，作为整体处理
- 支持聚合、排序和过滤
- 适用于结构化数据
- 适用场景：状态码、标签、ID、邮箱等

多字段映射示例：
{
  &quot;title&quot;: {
    &quot;type&quot;: &quot;text&quot;,
    &quot;analyzer&quot;: &quot;ik_max_word&quot;,
    &quot;fields&quot;: {
      &quot;keyword&quot;: {
        &quot;type&quot;: &quot;keyword&quot;,
        &quot;ignore_above&quot;: 256
      }
    }
  }
}

这样可以同时支持全文搜索(title)和精确匹配(title.keyword)
</div><p id="qg4rcd_118"><span class="control" id="qg4rcd_173">Mapping类型对比图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1538.9140625 454"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1538.9140625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M711.805,45.226L660.355,52.189C608.905,59.151,506.005,73.075,454.555,82.121C403.105,91.167,403.105,95.333,403.105,98.833C403.105,102.333,403.105,105.167,403.105,106.583L403.105,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M862.945,45.121L915.063,52.101C967.18,59.081,1071.414,73.04,1123.531,82.103C1175.648,91.167,1175.648,95.333,1175.648,98.833C1175.648,102.333,1175.648,105.167,1175.648,106.583L1175.648,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_2" d="M341.051,150.476L304.528,157.23C268.005,163.984,194.96,177.492,158.437,186.329C121.914,195.167,121.914,199.333,121.914,202.833C121.914,206.333,121.914,209.167,121.914,210.583L121.914,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_3" d="M355.825,166L348.529,170.167C341.232,174.333,326.64,182.667,319.343,188.917C312.047,195.167,312.047,199.333,312.047,202.833C312.047,206.333,312.047,209.167,312.047,210.583L312.047,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B3_4" d="M450.386,166L457.682,170.167C464.979,174.333,479.571,182.667,486.868,188.917C494.164,195.167,494.164,199.333,494.164,202.833C494.164,206.333,494.164,209.167,494.164,210.583L494.164,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B4_5" d="M465.16,150.158L503.018,156.965C540.875,163.772,616.59,177.386,654.447,186.276C692.305,195.167,692.305,199.333,692.305,202.833C692.305,206.333,692.305,209.167,692.305,210.583L692.305,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M1113.594,150.641L1077.738,157.368C1041.883,164.094,970.172,177.547,934.316,186.357C898.461,195.167,898.461,199.333,898.461,202.833C898.461,206.333,898.461,209.167,898.461,210.583L898.461,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_7" d="M1130.447,166L1123.471,170.167C1116.496,174.333,1102.545,182.667,1095.569,188.917C1088.594,195.167,1088.594,199.333,1088.594,202.833C1088.594,206.333,1088.594,209.167,1088.594,210.583L1088.594,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C3_8" d="M1220.85,166L1227.825,170.167C1234.801,174.333,1248.752,182.667,1255.728,188.917C1262.703,195.167,1262.703,199.333,1262.703,202.833C1262.703,206.333,1262.703,209.167,1262.703,210.583L1262.703,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C4_9" d="M1237.703,150.641L1273.559,157.368C1309.414,164.094,1381.125,177.547,1416.98,186.357C1452.836,195.167,1452.836,199.333,1452.836,202.833C1452.836,206.333,1452.836,209.167,1452.836,210.583L1452.836,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B5_10" d="M121.914,270L121.914,274.167C121.914,278.333,121.914,286.667,121.914,292.917C121.914,299.167,121.914,303.333,121.914,306.833C121.914,310.333,121.914,313.167,121.914,314.583L121.914,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C5_11" d="M898.461,270L898.461,274.167C898.461,278.333,898.461,286.667,898.461,292.917C898.461,299.167,898.461,303.333,898.461,306.833C898.461,310.333,898.461,313.167,898.461,314.583L898.461,316"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(787.375, 35)" id="flowchart-A-21690" class="node default"><rect height="54" width="151.140625" y="-27" x="-75.5703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.5703125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="91.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Mapping策略</p></span></div></foreignObject></g></g><g transform="translate(403.10546875, 139)" id="flowchart-B-21691" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#ffecb3 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>动态映射</p></span></div></foreignObject></g></g><g transform="translate(1175.6484375, 139)" id="flowchart-C-21693" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>静态映射</p></span></div></foreignObject></g></g><g transform="translate(121.9140625, 243)" id="flowchart-B1-21695" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>自动类型推断</p></span></div></foreignObject></g></g><g transform="translate(312.046875, 243)" id="flowchart-B2-21697" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>灵活性高</p></span></div></foreignObject></g></g><g transform="translate(494.1640625, 243)" id="flowchart-B3-21699" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>可能不准确</p></span></div></foreignObject></g></g><g transform="translate(692.3046875, 243)" id="flowchart-B4-21701" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>映射爆炸风险</p></span></div></foreignObject></g></g><g transform="translate(898.4609375, 243)" id="flowchart-C1-21703" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>明确类型定义</p></span></div></foreignObject></g></g><g transform="translate(1088.59375, 243)" id="flowchart-C2-21705" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能更好</p></span></div></foreignObject></g></g><g transform="translate(1262.703125, 243)" id="flowchart-C3-21707" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>严格控制</p></span></div></foreignObject></g></g><g transform="translate(1452.8359375, 243)" id="flowchart-C4-21709" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="fill:#a5d6a7 !important" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>生产环境推荐</p></span></div></foreignObject></g></g><g transform="translate(121.9140625, 383)" id="flowchart-B5-21711" class="node default"><rect height="126" width="227.828125" y="-63" x="-113.9140625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-83.9140625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="167.828125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>string → text/keyword<br>number → long/double<br>boolean → boolean<br>date → date</p></span></div></foreignObject></g></g><g transform="translate(898.4609375, 383)" id="flowchart-C5-21713" class="node default"><rect height="126" width="188.203125" y="-63" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>手动定义每个字段<br>指定分析器<br>设置索引选项<br>控制存储行为</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_120"><span class="control" id="qg4rcd_174">字段类型选择决策树:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1320.890625 1688.203125" height="1688.203125" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1320.890625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M556.023,62L556.023,66.167C556.023,70.333,556.023,78.667,556.065,84.958C556.107,91.25,556.19,95.5,556.26,99.083C556.331,102.667,556.388,105.584,556.416,107.042L556.445,108.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M493.635,205.658L424.373,222.223C355.111,238.788,216.587,271.917,147.325,295.817C78.063,319.717,78.063,334.388,78.063,348.392C78.063,362.396,78.063,375.733,78.063,382.402L78.063,389.07"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_2" d="M592.45,232.62L602.74,244.691C613.029,256.762,633.608,280.905,643.94,296.101C654.271,311.297,654.354,317.547,654.429,323.13C654.503,328.714,654.569,333.63,654.601,336.089L654.634,338.547"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M594.801,438.707L541.399,454.772C487.998,470.836,381.194,502.965,327.792,524.362C274.391,545.759,274.391,556.424,274.391,566.423C274.391,576.422,274.391,585.754,274.391,590.42L274.391,595.086"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_F_4" d="M689.988,463.293L699.861,475.26C709.734,487.227,729.48,511.16,739.395,526.252C749.31,541.344,749.393,547.594,749.468,553.177C749.542,558.761,749.608,563.677,749.64,566.136L749.673,568.594"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_5" d="M708.809,639.661L668.086,652.564C627.362,665.467,545.916,691.272,505.234,707.3C464.552,723.328,464.635,729.578,464.71,735.162C464.784,740.745,464.85,745.662,464.883,748.12L464.915,750.578"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_H_6" d="M787.354,642.95L815.87,655.305C844.386,667.66,901.418,692.369,929.975,709.851C958.533,727.333,958.616,737.589,958.694,747.177C958.772,756.766,958.844,765.688,958.88,770.149L958.917,774.61"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_I_7" d="M425.969,871.625L413.227,884.209C400.485,896.792,375,921.958,362.258,939.542C349.516,957.125,349.516,967.125,349.516,976.458C349.516,985.792,349.516,994.458,349.516,998.792L349.516,1003.125"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_J_8" d="M503.969,871.625L516.544,884.209C529.12,896.792,554.271,921.958,566.846,940.542C579.422,959.125,579.422,971.125,579.422,982.458C579.422,993.792,579.422,1004.458,579.422,1009.792L579.422,1015.125"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_K_9" d="M925.285,852.929L899.064,868.629C872.844,884.328,820.402,915.726,794.182,937.426C767.961,959.125,767.961,971.125,767.961,982.458C767.961,993.792,767.961,1004.458,767.961,1009.792L767.961,1015.125"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_L_10" d="M983.124,862.419L994.554,876.537C1005.983,890.655,1028.843,918.89,1040.315,936.132C1051.786,953.375,1051.87,959.625,1051.944,965.208C1052.019,970.792,1052.084,975.709,1052.117,978.167L1052.15,980.625"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_M_11" d="M1021.482,1077.904L1010.313,1089.107C999.144,1100.311,976.807,1122.718,965.638,1140.589C954.469,1158.461,954.469,1171.797,954.469,1184.466C954.469,1197.135,954.469,1209.138,954.469,1215.139L954.469,1221.141"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_N_12" d="M1082.924,1077.904L1093.926,1089.107C1104.929,1100.311,1126.933,1122.718,1137.977,1137.046C1149.021,1151.375,1149.104,1157.625,1149.179,1163.208C1149.253,1168.792,1149.319,1173.709,1149.351,1176.167L1149.384,1178.625"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_O_13" d="M1120.216,1293.435L1112.227,1304.388C1104.238,1315.342,1088.26,1337.249,1080.312,1351.328C1072.365,1365.406,1072.448,1371.656,1072.522,1377.24C1072.597,1382.823,1072.662,1387.74,1072.695,1390.198L1072.728,1392.657"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_P_14" d="M1184.715,1287.378L1196.866,1299.341C1209.016,1311.304,1233.317,1335.23,1245.467,1366.364C1257.617,1397.497,1257.617,1435.839,1257.617,1474.18C1257.617,1512.521,1257.617,1550.862,1256.942,1573.116C1256.267,1595.37,1254.918,1601.536,1253.711,1607.052C1252.503,1612.567,1251.439,1617.431,1250.906,1619.864L1250.374,1622.296"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_O_Q_15" d="M1062.216,1542.137L1060.891,1549.982C1059.566,1557.826,1056.916,1573.515,1055.591,1584.442C1054.266,1595.37,1054.266,1601.536,1054.266,1607.036C1054.266,1612.536,1054.266,1617.37,1054.266,1619.786L1054.266,1622.203"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_O_P_16" d="M1108.007,1517.478L1117.831,1529.432C1127.656,1541.386,1147.304,1565.295,1160.822,1580.332C1174.339,1595.37,1181.725,1601.536,1188.6,1607.276C1195.474,1613.015,1201.837,1618.327,1205.018,1620.983L1208.199,1623.64"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_17" d="M78.063,447.07L78.063,461.741C78.063,476.411,78.063,505.753,78.063,523.756C78.063,541.759,78.063,548.424,78.063,554.423C78.063,560.422,78.063,565.754,78.063,568.42L78.063,571.086"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_18" d="M274.391,653.086L274.391,663.751C274.391,674.417,274.391,695.747,274.391,711.748C274.391,727.749,274.391,738.419,274.391,748.423C274.391,758.427,274.391,767.764,274.391,772.433L274.391,777.102"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_I1_19" d="M349.516,1085.125L349.516,1095.125C349.516,1105.125,349.516,1125.125,349.516,1139.793C349.516,1154.461,349.516,1163.797,349.516,1172.466C349.516,1181.135,349.516,1189.138,349.516,1193.139L349.516,1197.141"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_K1_20" d="M767.961,1073.125L767.961,1085.125C767.961,1097.125,767.961,1121.125,767.961,1137.793C767.961,1154.461,767.961,1163.797,767.961,1172.466C767.961,1181.135,767.961,1189.138,767.961,1193.139L767.961,1197.141"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(78.0625, 305.046875)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(654.1875, 305.046875)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(274.390625, 535.09375)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(749.2265625, 535.09375)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(464.46875, 717.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(958.44921875, 717.078125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(349.515625, 947.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(579.421875, 947.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(767.9609375, 947.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1051.703125, 947.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(954.46875, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1148.9375, 1145.125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(1072.28125, 1359.15625)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1257.6171875, 1474.1796875)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g transform="translate(1054.265625, 1589.203125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>是</p></span></div></foreignObject></g></g><g transform="translate(1166.953125, 1589.203125)" class="edgeLabel"><g transform="translate(-8.015625, -12)" class="label"><foreignObject height="24" width="16.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>否</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(556.0234375, 35)" id="flowchart-A-21718" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>新字段</p></span></div></foreignObject></g></g><g transform="translate(556.0234375, 190.0234375)" id="flowchart-B-21719" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要全文搜索?</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 420.0703125)" id="flowchart-C-21721" class="node default"><rect height="54" width="121.578125" y="-27" x="-60.7890625" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-30.7890625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="61.578125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>text类型</p></span></div></foreignObject></g></g><g transform="translate(654.1875, 420.0703125)" id="flowchart-D-21723" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要精确匹配?</p></span></div></foreignObject></g></g><g transform="translate(274.390625, 626.0859375)" id="flowchart-E-21725" class="node default"><rect height="54" width="152.53125" y="-27" x="-76.265625" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-46.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="92.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>keyword类型</p></span></div></foreignObject></g></g><g transform="translate(749.2265625, 626.0859375)" id="flowchart-F-21727" class="node default"><polygon transform="translate(-53.9921875,53.9921875)" class="label-container" points="53.9921875,0 107.984375,-53.9921875 53.9921875,-107.984375 0,-53.9921875"></polygon><g transform="translate(-26.9921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="53.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>是数值?</p></span></div></foreignObject></g></g><g transform="translate(464.46875, 832.1015625)" id="flowchart-G-21729" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要范围查询?</p></span></div></foreignObject></g></g><g transform="translate(958.44921875, 832.1015625)" id="flowchart-H-21731" class="node default"><polygon transform="translate(-53.9921875,53.9921875)" class="label-container" points="53.9921875,0 107.984375,-53.9921875 53.9921875,-107.984375 0,-53.9921875"></polygon><g transform="translate(-26.9921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="53.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>是日期?</p></span></div></foreignObject></g></g><g transform="translate(349.515625, 1046.125)" id="flowchart-I-21733" class="node default"><rect height="78" width="207.28125" y="-39" x="-103.640625" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-73.640625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="147.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>numeric类型<br>long/double/integer</p></span></div></foreignObject></g></g><g transform="translate(579.421875, 1046.125)" id="flowchart-J-21735" class="node default"><rect height="54" width="152.53125" y="-27" x="-76.265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="92.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>keyword类型</p></span></div></foreignObject></g></g><g transform="translate(767.9609375, 1046.125)" id="flowchart-K-21737" class="node default"><rect height="54" width="124.546875" y="-27" x="-62.2734375" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-32.2734375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>date类型</p></span></div></foreignObject></g></g><g transform="translate(1051.703125, 1046.125)" id="flowchart-L-21739" class="node default"><polygon transform="translate(-62,62)" class="label-container" points="62,0 124,-62 62,-124 0,-62"></polygon><g transform="translate(-35, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="70"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>是布尔值?</p></span></div></foreignObject></g></g><g transform="translate(954.46875, 1252.140625)" id="flowchart-M-21741" class="node default"><rect height="54" width="148.90625" y="-27" x="-74.453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-44.453125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="88.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>boolean类型</p></span></div></foreignObject></g></g><g transform="translate(1148.9375, 1252.140625)" id="flowchart-N-21743" class="node default"><polygon transform="translate(-70.015625,70.015625)" class="label-container" points="70.015625,0 140.03125,-70.015625 70.015625,-140.03125 0,-70.015625"></polygon><g transform="translate(-43.015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="86.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>是嵌套对象?</p></span></div></foreignObject></g></g><g transform="translate(1072.28125, 1474.1796875)" id="flowchart-O-21745" class="node default"><polygon transform="translate(-78.0234375,78.0234375)" class="label-container" points="78.0234375,0 156.046875,-78.0234375 78.0234375,-156.046875 0,-78.0234375"></polygon><g transform="translate(-51.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>需要独立查询?</p></span></div></foreignObject></g></g><g transform="translate(1243.609375, 1653.203125)" id="flowchart-P-21747" class="node default"><rect height="54" width="138.5625" y="-27" x="-69.28125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-39.28125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="78.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>object类型</p></span></div></foreignObject></g></g><g transform="translate(1054.265625, 1653.203125)" id="flowchart-Q-21749" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>nested类型</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 626.0859375)" id="flowchart-C1-21753" class="node default"><rect height="102" width="140.125" y="-51" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>支持分词<br>模糊匹配<br>相关性评分</p></span></div></foreignObject></g></g><g transform="translate(274.390625, 832.1015625)" id="flowchart-E1-21755" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>精确匹配<br>聚合排序<br>过滤查询</p></span></div></foreignObject></g></g><g transform="translate(349.515625, 1252.140625)" id="flowchart-I1-21757" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数学运算<br>范围查询<br>聚合统计</p></span></div></foreignObject></g></g><g transform="translate(767.9609375, 1252.140625)" id="flowchart-K1-21759" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>日期范围<br>时间聚合<br>格式化</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_122"><span class="control" id="qg4rcd_175">Q6: 什么是倒排索引？请描述其构建过程</span></p><p id="qg4rcd_123"><span class="control" id="qg4rcd_176">标准回答:</span></p><div class="code-block" data-lang="none">
倒排索引是Elasticsearch的核心数据结构，实现了从词项到文档的快速映射。

构建过程：
1. 文档分析：使用分析器将文档分解为词项(terms)
2. 词项标准化：转换为小写、去除停用词等
3. 构建词典：收集所有唯一词项
4. 建立倒排表：记录每个词项出现的文档ID和位置信息

示例：
文档1: &quot;Elasticsearch is powerful&quot;
文档2: &quot;Elasticsearch is fast&quot;

倒排索引结构：
Term          | Document IDs | Term Frequency | Positions
------------- | ------------ | -------------- | ---------
elasticsearch | [1, 2]       | [1, 1]         | [[0], [0]]
is           | [1, 2]       | [1, 1]         | [[1], [1]]
powerful     | [1]          | [1]            | [[2]]
fast         | [2]          | [1]            | [[2]]

优势：
- 快速的词项查找（O(log n)）
- 支持复杂的布尔查询
- 高效的相关性计算
</div><p id="qg4rcd_125"><span class="control" id="qg4rcd_177">倒排索引构建流程图:</span></p><p id="qg4rcd_127"><span class="control" id="qg4rcd_178">倒排索引查询过程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1167 804" style="max-width: 1167px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Scorer" height="65" width="150" stroke="#666" fill="#eaeaea" y="718" x="916"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="750.5" x="991"><tspan dy="0" x="991">评分器</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PostingList" height="65" width="150" stroke="#666" fill="#eaeaea" y="718" x="699"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="750.5" x="774"><tspan dy="0" x="774">倒排列表</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TermDict" height="65" width="150" stroke="#666" fill="#eaeaea" y="718" x="474"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="750.5" x="549"><tspan dy="0" x="549">词项字典</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Analyzer" height="65" width="150" stroke="#666" fill="#eaeaea" y="718" x="255"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="750.5" x="330"><tspan dy="0" x="330">分析器</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Query" height="65" width="150" stroke="#666" fill="#eaeaea" y="718" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="750.5" x="75"><tspan dy="0" x="75">查询请求</tspan></text></g><g><line name="Scorer" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="718" x2="991" y1="5" x1="991" id="actor1288"></line><g id="root-1288"><rect class="actor actor-top" ry="3" rx="3" name="Scorer" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="916"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="991"><tspan dy="0" x="991">评分器</tspan></text></g></g><g><line name="PostingList" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="718" x2="774" y1="5" x1="774" id="actor1287"></line><g id="root-1287"><rect class="actor actor-top" ry="3" rx="3" name="PostingList" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="699"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="774"><tspan dy="0" x="774">倒排列表</tspan></text></g></g><g><line name="TermDict" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="718" x2="549" y1="5" x1="549" id="actor1286"></line><g id="root-1286"><rect class="actor actor-top" ry="3" rx="3" name="TermDict" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="474"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="549"><tspan dy="0" x="549">词项字典</tspan></text></g></g><g><line name="Analyzer" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="718" x2="330" y1="5" x1="330" id="actor1285"></line><g id="root-1285"><rect class="actor actor-top" ry="3" rx="3" name="Analyzer" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="255"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="330"><tspan dy="0" x="330">分析器</tspan></text></g></g><g><line name="Query" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="718" x2="75" y1="5" x1="75" id="actor1284"></line><g id="root-1284"><rect class="actor actor-top" ry="3" rx="3" name="Query" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">查询请求</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><line class="loopLine" y2="201" x2="560" y1="201" x1="319"></line><line class="loopLine" y2="342" x2="560" y1="201" x1="560"></line><line class="loopLine" y2="342" x2="560" y1="342" x1="319"></line><line class="loopLine" y2="342" x2="319" y1="201" x1="319"></line><polygon class="labelBox" points="319,201 369,201 369,214 360.6,221 319,221"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="214" x="344">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="219" x="464.5"><tspan x="464.5">[并行查找词项]</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="201">"Elasticsearch powerful"</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="326" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="331">分词: [elasticsearch, powerful]</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 331,161 C 391,151 391,191 331,181"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="251" x="438">查找 "elasticsearch"</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="284" x2="545" y1="284" x1="331"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="299" x="438">查找 "powerful"</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="332" x2="545" y1="332" x1="331"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="357" x="660">elasticsearch → [1,2]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="390" x2="770" y1="390" x1="550"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="405" x="660">powerful → [1]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="438" x2="770" y1="438" x1="550"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="453" x="881">文档1: 包含两个词项</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="486" x2="987" y1="486" x1="775"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="501" x="881">文档2: 包含一个词项</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="534" x2="987" y1="534" x1="775"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="549" x="992">计算TF-IDF评分</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 992,582 C 1052,572 1052,612 992,602"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="627" x="535">返回结果:</text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="646" x="535">文档1 (score: 0.8)</text><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="665" x="535">文档2 (score: 0.3)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="698" x2="79" y1="698" x1="990"></line></svg><p id="qg4rcd_129"><span class="control" id="qg4rcd_179">正排索引 vs 倒排索引对比图:</span></p><p id="qg4rcd_131"><span class="control" id="qg4rcd_180">Q7: 分析器(Analyzer)的组成和作用是什么？</span></p><p id="qg4rcd_132"><span class="control" id="qg4rcd_181">标准回答:</span></p><div class="code-block" data-lang="none">
分析器由三个组件组成：

1. Character Filters（字符过滤器）：
   - 预处理字符流
   - 例如：html_strip移除HTML标签

2. Tokenizer（分词器）：
   - 将文本分解为词项
   - 例如：standard、keyword、ik_max_word

3. Token Filters（词项过滤器）：
   - 处理词项流
   - 例如：lowercase、stop、synonym

内置分析器：
- standard：标准分析器，适用于大多数语言
- simple：简单分析器，按非字母字符分词
- whitespace：按空白字符分词
- keyword：不分词，整体作为一个词项

中文分析器：
- ik_max_word：最大化分词
- ik_smart：智能分词
- pinyin：拼音分析器

自定义分析器示例：
{
  &quot;settings&quot;: {
    &quot;analysis&quot;: {
      &quot;analyzer&quot;: {
        &quot;my_analyzer&quot;: {
          &quot;type&quot;: &quot;custom&quot;,
          &quot;char_filter&quot;: [&quot;html_strip&quot;],
          &quot;tokenizer&quot;: &quot;ik_max_word&quot;,
          &quot;filter&quot;: [&quot;lowercase&quot;, &quot;stop&quot;]
        }
      }
    }
  }
}
</div><p id="qg4rcd_134"><span class="control" id="qg4rcd_182">Q8: 请解释Elasticsearch集群中的节点角色，以及它们之间的协作关系</span></p><p id="qg4rcd_135"><span class="control" id="qg4rcd_183">标准回答:</span></p><div class="code-block" data-lang="none">
Elasticsearch集群中有多种节点角色，每种角色承担不同的职责：

1. 主节点(Master Node)：
   - 职责：集群状态管理、索引创建/删除、分片分配决策
   - 配置：node.master: true, node.data: false
   - 特点：不存储数据，专注于集群管理
   - 选举：通过Raft算法选举，需要majority投票
   - 数量：通常3个，避免脑裂问题

2. 数据节点(Data Node)：
   - 职责：存储分片数据、执行查询和聚合、处理索引操作
   - 配置：node.master: false, node.data: true
   - 特点：承载所有主分片和副本分片
   - 扩展：可根据数据量和性能需求水平扩展

3. 协调节点(Coordinating Node)：
   - 职责：请求路由、结果聚合、负载均衡
   - 配置：node.master: false, node.data: false, node.ingest: false
   - 特点：不存储数据，专门处理客户端请求
   - 作用：减轻数据节点的协调压力

4. 摄取节点(Ingest Node)：
   - 职责：数据预处理、文档转换、管道处理
   - 配置：node.ingest: true
   - 特点：在数据写入前进行预处理
   - 应用：数据清洗、格式转换、字段提取

5. 机器学习节点(ML Node)：
   - 职责：运行机器学习作业、异常检测
   - 配置：node.ml: true
   - 特点：专门处理ML相关任务
   - 隔离：避免ML任务影响搜索性能

节点协作关系：
- 主节点负责集群决策，数据节点执行具体操作
- 协调节点接收请求，路由到相应的数据节点
- 摄取节点预处理数据，然后转发给数据节点
- 所有节点通过集群状态保持同步

脑裂预防：
- 设置discovery.zen.minimum_master_nodes = (master_nodes / 2) + 1
- 确保主节点数量为奇数
- 使用专用主节点，避免数据节点参与选举
</div><p id="qg4rcd_137"><span class="control" id="qg4rcd_184">集群节点协作图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1127.36328125 807"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1127.36328125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="数据节点层" class="cluster"><rect height="128" width="820.69140625" y="518" x="8" style=""></rect><g transform="translate(378.283203125, 518)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据节点层</p></span></div></foreignObject></g></g><g data-look="classic" id="摄取节点层" class="cluster"><rect height="128" width="410.73828125" y="340" x="158.79296875" style=""></rect><g transform="translate(324.099609375, 340)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>摄取节点层</p></span></div></foreignObject></g></g><g data-look="classic" id="主节点层" class="cluster"><rect height="459" width="270.671875" y="340" x="848.69140625" style=""></rect><g transform="translate(951.97265625, 340)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主节点层</p></span></div></foreignObject></g></g><g data-look="classic" id="协调节点层" class="cluster"><rect height="128" width="820.0625" y="162" x="38.62890625" style=""></rect><g transform="translate(408.59765625, 162)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点层</p></span></div></foreignObject></g></g><g data-look="classic" id="客户端层" class="cluster"><rect height="104" width="527.5078125" y="8" x="185.90234375" style=""></rect><g transform="translate(417.6015625, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端层</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Client1_Coord1_0" d="M279.152,87L279.152,91.167C279.152,95.333,279.152,103.667,279.152,112C279.152,120.333,279.152,128.667,279.152,137C279.152,145.333,279.152,153.667,279.262,159.917C279.373,166.167,279.593,170.333,279.778,173.834C279.963,177.335,280.113,180.17,280.188,181.588L280.263,183.006"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Client2_Coord1_1" d="M445.652,87L445.652,91.167C445.652,95.333,445.652,103.667,445.652,112C445.652,120.333,445.652,128.667,445.652,137C445.652,145.333,445.652,153.667,437.581,161C429.509,168.334,413.366,174.668,397.843,180.758C382.321,186.849,367.419,192.695,359.968,195.619L352.517,198.542"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Client3_Coord2_2" d="M620.16,87L620.16,91.167C620.16,95.333,620.16,103.667,620.16,112C620.16,120.333,620.16,128.667,620.16,137C620.16,145.333,620.16,153.667,620.16,159.917C620.16,166.167,620.16,170.333,620.16,173.833C620.16,177.333,620.16,180.167,620.16,181.583L620.16,183"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord1_Ingest1_3" d="M271.152,265L269.936,269.167C268.72,273.333,266.288,281.667,265.072,290C263.855,298.333,263.855,306.667,263.855,315C263.855,323.333,263.855,331.667,263.855,337.917C263.855,344.167,263.855,348.333,263.855,351.833C263.855,355.333,263.855,358.167,263.855,359.583L263.855,361"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_Ingest2_4" d="M553.902,253.919L539.631,259.932C525.359,265.946,496.816,277.973,482.545,288.153C468.273,298.333,468.273,306.667,468.273,315C468.273,323.333,468.273,331.667,468.273,337.917C468.273,344.167,468.273,348.333,468.273,351.833C468.273,355.333,468.273,358.167,468.273,359.583L468.273,361"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Ingest1_Data1_5" d="M244.032,443L241.914,447.167C239.796,451.333,235.56,459.667,207.993,468C180.426,476.333,129.527,484.667,104.078,493C78.629,501.333,78.629,509.667,79.626,515.917C80.623,522.167,82.617,526.333,84.323,529.899C86.03,533.464,87.448,536.428,88.157,537.91L88.867,539.392"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Ingest1_Data2_6" d="M274.774,443L275.941,447.167C277.107,451.333,279.44,459.667,280.607,468C281.773,476.333,281.773,484.667,281.773,493C281.773,501.333,281.773,509.667,284.182,515.917C286.591,522.167,291.409,526.333,295.723,530.064C300.037,533.794,303.846,537.089,305.751,538.736L307.656,540.383"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Ingest2_Data3_7" d="M412.663,443L406.722,447.167C400.781,451.333,388.898,459.667,396.293,468C403.689,476.333,430.362,484.667,443.699,493C457.035,501.333,457.035,509.667,459.68,515.917C462.325,522.167,467.616,526.333,472.382,530.088C477.149,533.842,481.391,537.183,483.513,538.854L485.634,540.525"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Ingest2_Data4_8" d="M493.032,443L495.677,447.167C498.322,451.333,503.612,459.667,528.032,468C552.452,476.333,596.001,484.667,617.776,493C639.551,501.333,639.551,509.667,642.412,515.917C645.272,522.167,650.994,526.333,656.176,530.108C661.359,533.882,666.003,537.264,668.325,538.954L670.647,540.645"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord1_Data1_9" d="M216.277,250.472L198.441,257.06C180.604,263.648,144.931,276.824,127.094,287.579C109.258,298.333,109.258,306.667,109.258,315C109.258,323.333,109.258,331.667,109.258,346.5C109.258,361.333,109.258,382.667,109.258,404C109.258,425.333,109.258,446.667,112.379,461.5C115.5,476.333,121.742,484.667,124.863,493C127.984,501.333,127.984,509.667,127.375,515.917C126.765,522.167,125.546,526.333,124.514,529.86C123.482,533.387,122.637,536.274,122.215,537.717L121.793,539.161"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord1_Data2_10" d="M348.793,239.813L388.916,248.177C429.039,256.542,509.285,273.271,549.408,285.802C589.531,298.333,589.531,306.667,589.531,315C589.531,323.333,589.531,331.667,589.531,346.5C589.531,361.333,589.531,382.667,589.531,404C589.531,425.333,589.531,446.667,564.115,461.5C538.699,476.333,487.867,484.667,462.451,493C437.035,501.333,437.035,509.667,434.39,515.917C431.745,522.167,426.455,526.333,421.688,530.088C416.922,533.842,412.679,537.183,410.558,538.854L408.436,540.525"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_Data3_11" d="M654.295,265L657.942,269.167C661.588,273.333,668.882,281.667,672.529,290C676.176,298.333,676.176,306.667,676.176,315C676.176,323.333,676.176,331.667,676.176,346.5C676.176,361.333,676.176,382.667,676.176,404C676.176,425.333,676.176,446.667,666.738,461.5C657.301,476.333,638.426,484.667,628.988,493C619.551,501.333,619.551,509.667,616.906,515.917C614.261,522.167,608.97,526.333,604.204,530.088C599.437,533.842,595.195,537.183,593.073,538.854L590.952,540.525"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_Data4_12" d="M686.418,254.671L700.025,260.559C713.633,266.447,740.848,278.224,754.455,288.278C768.063,298.333,768.063,306.667,768.063,315C768.063,323.333,768.063,331.667,768.063,346.5C768.063,361.333,768.063,382.667,768.063,404C768.063,425.333,768.063,446.667,768.063,461.5C768.063,476.333,768.063,484.667,768.063,493C768.063,501.333,768.063,509.667,766.74,515.917C765.417,522.167,762.772,526.333,760.484,529.937C758.197,533.541,756.266,536.582,755.301,538.103L754.336,539.623"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master1_Data1_13" d="M935.082,438.514L926.788,443.428C918.493,448.342,901.905,458.171,893.611,467.252C885.316,476.333,885.316,484.667,885.316,493C885.316,501.333,885.316,509.667,826.166,518.711C767.016,527.756,648.716,537.512,531.08,547.213C413.445,556.914,296.473,566.561,237.988,571.384L179.502,576.207"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master1_Data2_14" d="M939.698,443L933.967,447.167C928.237,451.333,916.777,459.667,911.047,468C905.316,476.333,905.316,484.667,905.316,493C905.316,501.333,905.316,509.667,865.043,518.524C824.77,527.381,744.223,536.761,664.338,546.065C584.453,555.368,505.231,564.594,465.62,569.208L426.008,573.821"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master1_Data3_15" d="M951.885,443L947.457,447.167C943.029,451.333,934.173,459.667,929.745,468C925.316,476.333,925.316,484.667,925.316,493C925.316,501.333,925.316,509.667,898.586,518.254C871.855,526.841,818.395,535.681,765.591,544.413C712.788,553.145,660.643,561.768,634.57,566.079L608.497,570.391"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master1_Data4_16" d="M964.073,443L960.946,447.167C957.82,451.333,951.568,459.667,948.442,468C945.316,476.333,945.316,484.667,945.316,493C945.316,501.333,945.316,509.667,932.681,517.545C920.046,525.423,894.775,532.846,870.144,540.081C845.512,547.316,821.521,554.363,809.525,557.887L797.529,561.41"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" marker-start="url(#mermaid_flowchart-v2-pointStart)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master1_Master2_17" d="M974.656,446.664L973.099,450.22C971.543,453.776,968.43,460.888,966.873,468.611C965.316,476.333,965.316,484.667,965.316,493C965.316,501.333,965.316,509.667,965.316,515.917C965.316,522.167,965.316,526.333,965.316,529.833C965.316,533.333,965.316,536.167,965.316,537.583L965.316,539"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" marker-start="url(#mermaid_flowchart-v2-pointStart)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master2_Master3_18" d="M965.316,625L965.316,628.5C965.316,632,965.316,639,965.316,646.667C965.316,654.333,965.316,662.667,967.205,668.917C969.093,675.167,972.871,679.333,976.2,683.006C979.529,686.679,982.411,689.858,983.852,691.447L985.292,693.036"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" marker-start="url(#mermaid_flowchart-v2-pointStart)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Master3_Master1_19" d="M1048.541,692.561L1050.675,688.967C1052.81,685.374,1057.079,678.187,1059.213,670.427C1061.348,662.667,1061.348,654.333,1061.348,639.5C1061.348,624.667,1061.348,603.333,1061.348,582C1061.348,560.667,1061.348,539.333,1061.348,524.5C1061.348,509.667,1061.348,501.333,1061.348,493C1061.348,484.667,1061.348,476.333,1059.134,470.083C1056.92,463.833,1052.491,459.667,1048.549,455.957C1044.606,452.247,1041.149,448.994,1039.421,447.368L1037.692,445.741"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(279.15234375, 60)" id="flowchart-Client1-21800" class="node default"><rect height="54" width="116.5" y="-27" x="-58.25" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.25, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="56.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端1</p></span></div></foreignObject></g></g><g transform="translate(445.65234375, 60)" id="flowchart-Client2-21801" class="node default"><rect height="54" width="116.5" y="-27" x="-58.25" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.25, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="56.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端2</p></span></div></foreignObject></g></g><g transform="translate(620.16015625, 60)" id="flowchart-Client3-21802" class="node default"><rect height="54" width="116.5" y="-27" x="-58.25" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.25, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="56.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端3</p></span></div></foreignObject></g></g><g transform="translate(282.53515625, 226)" id="flowchart-Coord1-21803" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点1<br>请求路由</p></span></div></foreignObject></g></g><g transform="translate(620.16015625, 226)" id="flowchart-Coord2-21804" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点2<br>负载均衡</p></span></div></foreignObject></g></g><g transform="translate(993.33203125, 404)" id="flowchart-Master1-21805" class="node default"><rect height="78" width="116.5" y="-39" x="-58.25" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-28.25, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="56.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主节点1<br>Leader</p></span></div></foreignObject></g></g><g transform="translate(965.31640625, 582)" id="flowchart-Master2-21806" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主节点2<br>Follower</p></span></div></foreignObject></g></g><g transform="translate(1023.33203125, 735)" id="flowchart-Master3-21807" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主节点3<br>Follower</p></span></div></foreignObject></g></g><g transform="translate(263.85546875, 404)" id="flowchart-Ingest1-21808" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>摄取节点1<br>数据预处理</p></span></div></foreignObject></g></g><g transform="translate(468.2734375, 404)" id="flowchart-Ingest2-21809" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>摄取节点2<br>管道处理</p></span></div></foreignObject></g></g><g transform="translate(109.2578125, 582)" id="flowchart-Data1-21810" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据节点1<br>分片存储</p></span></div></foreignObject></g></g><g transform="translate(355.77734375, 582)" id="flowchart-Data2-21811" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据节点2<br>分片存储</p></span></div></foreignObject></g></g><g transform="translate(538.29296875, 582)" id="flowchart-Data3-21812" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据节点3<br>分片存储</p></span></div></foreignObject></g></g><g transform="translate(727.43359375, 582)" id="flowchart-Data4-21813" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据节点4<br>分片存储</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_139"><span class="control" id="qg4rcd_185">主节点选举流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-68.5 -10 875.5 1050" style="max-width: 875.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Cluster" height="65" width="150" stroke="#666" fill="#eaeaea" y="964" x="607"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="996.5" x="682"><tspan dy="0" x="682">集群状态</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="N3" height="65" width="150" stroke="#666" fill="#eaeaea" y="964" x="407"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="996.5" x="482"><tspan dy="0" x="482">节点3</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="N2" height="65" width="150" stroke="#666" fill="#eaeaea" y="964" x="202"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="996.5" x="277"><tspan dy="0" x="277">节点2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="N1" height="65" width="150" stroke="#666" fill="#eaeaea" y="964" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="996.5" x="75"><tspan dy="0" x="75">节点1</tspan></text></g><g><line name="Cluster" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="964" x2="682" y1="5" x1="682" id="actor1292"></line><g id="root-1292"><rect class="actor actor-top" ry="3" rx="3" name="Cluster" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="607"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="682"><tspan dy="0" x="682">集群状态</tspan></text></g></g><g><line name="N3" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="964" x2="482" y1="5" x1="482" id="actor1291"></line><g id="root-1291"><rect class="actor actor-top" ry="3" rx="3" name="N3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="407"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="482"><tspan dy="0" x="482">节点3</tspan></text></g></g><g><line name="N2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="964" x2="277" y1="5" x1="277" id="actor1290"></line><g id="root-1290"><rect class="actor actor-top" ry="3" rx="3" name="N2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="202"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="277"><tspan dy="0" x="277">节点2</tspan></text></g></g><g><line name="N1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="964" x2="75" y1="5" x1="75" id="actor1289"></line><g id="root-1289"><rect class="actor actor-top" ry="3" rx="3" name="N1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">节点1</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="457" stroke="#666" fill="#EDF2AE" y="75" x="50"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="279"><tspan x="279">初始状态：无主节点</tspan></text></g><g><rect class="note" height="39" width="187" stroke="#666" fill="#EDF2AE" y="394" x="-18.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="399" x="75"><tspan x="75">获得majority投票 (3/3)</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="587" x="0"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="592" x="75"><tspan x="75">主节点故障</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="76">发起选举</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,162 C 136,152 136,192 76,182"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="207" x="175">请求投票 (Term: 1)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="240" x2="273" y1="240" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="255" x="277">请求投票 (Term: 1)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="288" x2="478" y1="288" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="303" x="178">投票确认</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="336" x2="79" y1="336" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="351" x="280">投票确认</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="384" x2="79" y1="384" x1="481"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="448" x="377">成为主节点 (Term: 1)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="481" x2="678" y1="481" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="496" x="175">心跳 (我是主节点)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="529" x2="273" y1="529" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="544" x="277">心跳 (我是主节点)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="577" x2="478" y1="577" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="641" x="175">心跳中断</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#crosshead)" stroke="none" stroke-width="2" class="messageLine1" y2="674" x2="273" y1="674" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="689" x="277">心跳中断</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#crosshead)" stroke="none" stroke-width="2" class="messageLine1" y2="722" x2="478" y1="722" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="737" x="278">超时，发起新选举</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 278,770 C 338,760 338,800 278,790"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="815" x="378">请求投票 (Term: 2)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="848" x2="478" y1="848" x1="278"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="863" x="381">投票确认</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="896" x2="281" y1="896" x1="481"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="911" x="478">成为新主节点 (Term: 2)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="944" x2="678" y1="944" x1="278"></line></svg></section><section class="chapter"><h4 id="qg4rcd_56" data-toc="qg4rcd_56">考察重点总结</h4><p id="qg4rcd_186"><span class="control" id="qg4rcd_194">基础概念掌握程度：</span></p><ul class="list _bullet" id="qg4rcd_187"><li class="list__item" id="qg4rcd_195"><p id="qg4rcd_198">核心术语的准确理解</p></li><li class="list__item" id="qg4rcd_196"><p id="qg4rcd_199">概念之间的关系和区别</p></li><li class="list__item" id="qg4rcd_197"><p id="qg4rcd_200">版本演进的背景和原因</p></li></ul><p id="qg4rcd_188"><span class="control" id="qg4rcd_201">技术原理理解：</span></p><ul class="list _bullet" id="qg4rcd_189"><li class="list__item" id="qg4rcd_202"><p id="qg4rcd_206">倒排索引的工作机制</p></li><li class="list__item" id="qg4rcd_203"><p id="qg4rcd_207">分片和副本的作用</p></li><li class="list__item" id="qg4rcd_204"><p id="qg4rcd_208">分析器的处理流程</p></li><li class="list__item" id="qg4rcd_205"><p id="qg4rcd_209">节点角色和协作机制</p></li></ul><p id="qg4rcd_190"><span class="control" id="qg4rcd_210">实际应用能力：</span></p><ul class="list _bullet" id="qg4rcd_191"><li class="list__item" id="qg4rcd_211"><p id="qg4rcd_215">合适的字段类型选择</p></li><li class="list__item" id="qg4rcd_212"><p id="qg4rcd_216">映射设计的最佳实践</p></li><li class="list__item" id="qg4rcd_213"><p id="qg4rcd_217">分析器的配置和使用</p></li><li class="list__item" id="qg4rcd_214"><p id="qg4rcd_218">集群架构的设计</p></li></ul><p id="qg4rcd_192"><span class="control" id="qg4rcd_219">问题解决思路：</span></p><ul class="list _bullet" id="qg4rcd_193"><li class="list__item" id="qg4rcd_220"><p id="qg4rcd_224">常见问题的排查方法</p></li><li class="list__item" id="qg4rcd_221"><p id="qg4rcd_225">性能优化的考虑因素</p></li><li class="list__item" id="qg4rcd_222"><p id="qg4rcd_226">架构设计的权衡取舍</p></li><li class="list__item" id="qg4rcd_223"><p id="qg4rcd_227">故障恢复和容错机制</p></li></ul></section></section><section class="chapter"><h3 id="2" data-toc="2">2. 倒排索引原理</h3><div class="code-block" data-lang="none">
文档1: &quot;Elasticsearch is powerful&quot;
文档2: &quot;Elasticsearch is fast&quot;

倒排索引:
Term          | Document IDs
------------- | ------------
elasticsearch | [1, 2]
is           | [1, 2]  
powerful     | [1]
fast         | [2]
</div><p id="qg4rcd_229"><span class="control" id="qg4rcd_241">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_230"><li class="list__item" id="qg4rcd_242"><p id="qg4rcd_246">倒排索引的构建过程</p></li><li class="list__item" id="qg4rcd_243"><p id="qg4rcd_247">分词器（Analyzer）的作用</p></li><li class="list__item" id="qg4rcd_244"><p id="qg4rcd_248">Term Dictionary 和 Term Index 的区别</p></li><li class="list__item" id="qg4rcd_245"><p id="qg4rcd_249">正排索引 vs 倒排索引的应用场景</p></li></ul><p id="qg4rcd_231"><span class="control" id="qg4rcd_250">Q9: Term Dictionary 和 Term Index 有什么区别？它们在倒排索引中的作用是什么？</span></p><p id="qg4rcd_232"><span class="control" id="qg4rcd_251">标准回答:</span></p><div class="code-block" data-lang="none">
Term Dictionary 和 Term Index 是倒排索引的两个核心组件，它们协同工作实现高效的词项查找：

1. Term Dictionary（词项字典）：
   - 作用：存储所有唯一的词项及其对应的倒排列表指针
   - 结构：有序的词项列表，通常使用FST（Finite State Transducer）实现
   - 内容：词项 → 倒排列表位置的映射
   - 存储：部分在内存，部分在磁盘
   - 特点：支持前缀查询、模糊查询

2. Term Index（词项索引）：
   - 作用：Term Dictionary的索引，加速词项查找
   - 结构：稀疏索引，只存储部分词项的位置信息
   - 内容：词项前缀 → Term Dictionary中位置的映射
   - 存储：完全加载到内存中
   - 特点：占用内存小，查找速度快

查找过程：
1. 在Term Index中查找词项前缀，定位到Term Dictionary的大致位置
2. 在Term Dictionary中精确查找目标词项
3. 获取倒排列表的位置信息
4. 读取倒排列表获取文档ID列表

性能优势：
- Term Index减少了磁盘I/O操作
- FST结构提供了内存效率和查找速度的平衡
- 支持复杂的查询模式（前缀、通配符、正则表达式）

实际应用：
- 精确词项查询：直接通过Term Dictionary查找
- 前缀查询：利用FST的前缀特性
- 范围查询：利用词项的有序性
- 模糊查询：通过编辑距离算法在FST中查找
</div><p id="qg4rcd_234"><span class="control" id="qg4rcd_252">Term Dictionary 和 Term Index 结构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1887.78125 580"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1887.78125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="倒排列表" class="cluster"><rect height="152" width="814.453125" y="420" x="45.875" style=""></rect><g transform="translate(421.046875, 420)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>倒排列表</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="104" width="1871.78125" y="266" x="8" style=""></rect><g transform="translate(843.890625, 266)" class="cluster-label"><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>磁盘上的Term Dictionary (FST结构)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="104" width="861.046875" y="112" x="397.1484375" style=""></rect><g transform="translate(755.8984375, 112)" class="cluster-label"><foreignObject height="24" width="143.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内存中的Term Index</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Query_TI2_0" d="M705.703,62L705.703,66.167C705.703,70.333,705.703,78.667,705.703,87C705.703,95.333,705.703,103.667,705.703,109.917C705.703,116.167,705.703,120.333,705.703,123.833C705.703,127.333,705.703,130.167,705.703,131.583L705.703,133"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TI2_TD3_1" d="M705.703,191L705.703,195.167C705.703,199.333,705.703,207.667,705.703,216C705.703,224.333,705.703,232.667,705.703,241C705.703,249.333,705.703,257.667,705.703,263.917C705.703,270.167,705.703,274.333,705.703,277.833C705.703,281.333,705.703,284.167,705.703,285.583L705.703,287"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TD3_PL3_2" d="M705.703,345L705.703,349.167C705.703,353.333,705.703,361.667,705.703,370C705.703,378.333,705.703,386.667,705.703,395C705.703,403.333,705.703,411.667,705.703,417.917C705.703,424.167,705.703,428.333,705.703,431.833C705.703,435.333,705.703,438.167,705.703,439.583L705.703,441"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(502.40625, 164)" id="flowchart-TI1-21865" class="node default"><rect height="54" width="140.515625" y="-27" x="-70.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.2578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>a* → 位置0</p></span></div></foreignObject></g></g><g transform="translate(705.703125, 164)" id="flowchart-TI2-21866" class="node default"><rect height="54" width="166.078125" y="-27" x="-83.0390625" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-53.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="106.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>e* → 位置1000</p></span></div></foreignObject></g></g><g transform="translate(924.0546875, 164)" id="flowchart-TI3-21867" class="node default"><rect height="54" width="170.625" y="-27" x="-85.3125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-55.3125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="110.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>m* → 位置2000</p></span></div></foreignObject></g></g><g transform="translate(1141.28125, 164)" id="flowchart-TI4-21868" class="node default"><rect height="54" width="163.828125" y="-27" x="-81.9140625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-51.9140625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="103.828125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>s* → 位置3000</p></span></div></foreignObject></g></g><g transform="translate(142.015625, 318)" id="flowchart-TD1-21869" class="node default"><rect height="54" width="198.03125" y="-27" x="-99.015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-69.015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="138.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>apple → 倒排列表1</p></span></div></foreignObject></g></g><g transform="translate(410.3203125, 318)" id="flowchart-TD2-21870" class="node default"><rect height="54" width="238.578125" y="-27" x="-119.2890625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-89.2890625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="178.578125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>application → 倒排列表2</p></span></div></foreignObject></g></g><g transform="translate(705.703125, 318)" id="flowchart-TD3-21871" class="node default"><rect height="54" width="252.1875" y="-27" x="-126.09375" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-96.09375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="192.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>elasticsearch → 倒排列表3</p></span></div></foreignObject></g></g><g transform="translate(984.75, 318)" id="flowchart-TD4-21872" class="node default"><rect height="54" width="205.90625" y="-27" x="-102.953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.953125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="145.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>engine → 倒排列表4</p></span></div></foreignObject></g></g><g transform="translate(1237.515625, 318)" id="flowchart-TD5-21873" class="node default"><rect height="54" width="199.625" y="-27" x="-99.8125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-69.8125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="139.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>mysql → 倒排列表5</p></span></div></foreignObject></g></g><g transform="translate(1489.765625, 318)" id="flowchart-TD6-21874" class="node default"><rect height="54" width="204.875" y="-27" x="-102.4375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.4375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="144.875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>search → 倒排列表6</p></span></div></foreignObject></g></g><g transform="translate(1743.4921875, 318)" id="flowchart-TD7-21875" class="node default"><rect height="54" width="202.578125" y="-27" x="-101.2890625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-71.2890625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="142.578125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>server → 倒排列表7</p></span></div></foreignObject></g></g><g transform="translate(195.859375, 496)" id="flowchart-PL1-21876" class="node default"><rect height="102" width="229.96875" y="-51" x="-114.984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-84.984375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="169.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文档ID: [1,3,5]<br>词频: [2,1,3]<br>位置: [[0,5],[2],[1,4,8]]</p></span></div></foreignObject></g></g><g transform="translate(448.4609375, 496)" id="flowchart-PL2-21877" class="node default"><rect height="102" width="175.234375" y="-51" x="-87.6171875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-57.6171875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="115.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文档ID: [2,4]<br>词频: [1,2]<br>位置: [[3],[0,6]]</p></span></div></foreignObject></g></g><g transform="translate(705.703125, 496)" id="flowchart-PL3-21878" class="node default"><rect height="102" width="239.25" y="-51" x="-119.625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-89.625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="179.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文档ID: [1,2,3,4,5]<br>词频: [1,1,1,1,1]<br>位置: [[0],[0],[0],[0],[0]]</p></span></div></foreignObject></g></g><g transform="translate(705.703125, 35)" id="flowchart-Query-21879" class="node default"><rect height="54" width="196.765625" y="-27" x="-98.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-68.3828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="136.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询: elasticsearch</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_236"><span class="control" id="qg4rcd_253">倒排索引查找流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1117 1026" style="max-width: 1117px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Docs" height="65" width="150" stroke="#666" fill="#eaeaea" y="940" x="867"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="972.5" x="942"><tspan dy="0" x="942">文档存储</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PL" height="65" width="150" stroke="#666" fill="#eaeaea" y="940" x="619"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="972.5" x="694"><tspan dy="0" x="694">倒排列表</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TD" height="65" width="150" stroke="#666" fill="#eaeaea" y="940" x="419"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="972.5" x="494"><tspan dy="0" x="494">Term Dictionary</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="TI" height="65" width="150" stroke="#666" fill="#eaeaea" y="940" x="219"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="972.5" x="294"><tspan dy="0" x="294">Term Index</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Query" height="65" width="150" stroke="#666" fill="#eaeaea" y="940" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="972.5" x="75"><tspan dy="0" x="75">查询请求</tspan></text></g><g><line name="Docs" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="940" x2="942" y1="5" x1="942" id="actor1297"></line><g id="root-1297"><rect class="actor actor-top" ry="3" rx="3" name="Docs" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="867"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="942"><tspan dy="0" x="942">文档存储</tspan></text></g></g><g><line name="PL" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="940" x2="694" y1="5" x1="694" id="actor1296"></line><g id="root-1296"><rect class="actor actor-top" ry="3" rx="3" name="PL" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="619"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="694"><tspan dy="0" x="694">倒排列表</tspan></text></g></g><g><line name="TD" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="940" x2="494" y1="5" x1="494" id="actor1295"></line><g id="root-1295"><rect class="actor actor-top" ry="3" rx="3" name="TD" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="419"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="494"><tspan dy="0" x="494">Term Dictionary</tspan></text></g></g><g><line name="TI" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="940" x2="294" y1="5" x1="294" id="actor1294"></line><g id="root-1294"><rect class="actor actor-top" ry="3" rx="3" name="TI" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="219"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="294"><tspan dy="0" x="294">Term Index</tspan></text></g></g><g><line name="Query" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="940" x2="75" y1="5" x1="75" id="actor1293"></line><g id="root-1293"><rect class="actor actor-top" ry="3" rx="3" name="Query" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">查询请求</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="783" x="219"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="788" x="294"><tspan x="294">内存操作，速度快</tspan></text></g><g><rect class="note" height="39" width="166" stroke="#666" fill="#EDF2AE" y="832" x="411"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="837" x="494"><tspan x="494">磁盘操作，但有缓存</tspan></text></g><g><rect class="note" height="39" width="166" stroke="#666" fill="#EDF2AE" y="881" x="611"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="886" x="694"><tspan x="694">磁盘操作，按需加载</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="183">查找 "elasticsearch"</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="290" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="295">在内存中查找前缀 "e*"</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 295,161 C 355,151 355,191 295,181"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="393">定位到位置1000</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="239" x2="490" y1="239" x1="295"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="254" x="495">从位置1000开始查找</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 495,287 C 555,277 555,317 495,307"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="332" x="495">使用FST精确匹配 "elasticsearch"</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 495,365 C 555,355 555,395 495,385"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="410" x="593">返回倒排列表指针</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="443" x2="690" y1="443" x1="495"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="458" x="695">读取文档ID列表 [1,2,3,4,5]</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 695,491 C 755,481 755,521 695,511"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="536" x="695">读取词频信息 [1,1,1,1,1]</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 695,569 C 755,559 755,599 695,589"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="614" x="695">读取位置信息 [[0],[0],[0],[0],[0]]</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 695,647 C 755,637 755,677 695,667"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="692" x="817">根据文档ID获取文档内容</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="725" x2="938" y1="725" x1="695"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="740" x="510">返回匹配的文档</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="773" x2="79" y1="773" x1="941"></line></svg><p id="qg4rcd_238"><span class="control" id="qg4rcd_254">FST (Finite State Transducer) 结构示例:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1816.4375 278"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1816.4375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Start_A_0" d="M56.434,119.5L61.997,114.083C67.56,108.667,78.686,97.833,86.346,92.417C94.007,87,98.201,87,101.728,87C105.255,87,108.116,87,109.546,87L110.977,87"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_P1_1" d="M180.029,60L184.787,55.833C189.545,51.667,199.062,43.333,205.903,39.167C212.745,35,216.911,35,220.411,35C223.911,35,226.745,35,228.161,35L229.578,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1_P2_2" d="M302.531,35L306.698,35C310.865,35,319.198,35,325.448,35C331.698,35,335.865,35,339.365,35C342.865,35,345.698,35,347.115,35L348.531,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2_L_3" d="M421.484,35L425.651,35C429.818,35,438.151,35,444.475,35C450.798,35,455.112,35,458.759,35C462.406,35,465.387,35,466.877,35L468.367,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_E1_4" d="M537.117,35L541.431,35C545.745,35,554.372,35,560.77,35C567.167,35,571.333,35,574.833,35C578.333,35,581.167,35,582.583,35L584,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_End1_5" d="M656.766,35L660.932,35C665.099,35,673.432,35,679.824,35C686.215,35,690.664,35,694.447,35C698.229,35,701.345,35,702.903,35L704.461,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_P3_6" d="M180.029,114L184.787,118.167C189.545,122.333,199.062,130.667,205.903,134.833C212.745,139,216.911,139,220.411,139C223.911,139,226.745,139,228.161,139L229.578,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P3_P4_7" d="M302.531,139L306.698,139C310.865,139,319.198,139,325.448,139C331.698,139,335.865,139,339.365,139C342.865,139,345.698,139,347.115,139L348.531,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P4_L2_8" d="M421.484,139L425.651,139C429.818,139,438.151,139,444.475,139C450.798,139,455.112,139,458.759,139C462.406,139,465.387,139,466.877,139L468.367,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_I_9" d="M537.117,139L541.431,139C545.745,139,554.372,139,560.943,139C567.514,139,572.029,139,575.876,139C579.724,139,582.905,139,584.495,139L586.086,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_C_10" d="M654.68,139L659.194,139C663.708,139,672.737,139,679.335,139C685.932,139,690.099,139,693.599,139C697.099,139,699.932,139,701.349,139L702.766,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_A2_11" d="M774.719,139L778.885,139C783.052,139,791.385,139,797.635,139C803.885,139,808.052,139,811.552,139C815.052,139,817.885,139,819.302,139L820.719,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A2_T_12" d="M893.156,139L897.323,139C901.49,139,909.823,139,916.079,139C922.335,139,926.513,139,930.025,139C933.536,139,936.382,139,937.804,139L939.227,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T_I2_13" d="M1009.602,139L1013.78,139C1017.958,139,1026.315,139,1032.751,139C1039.186,139,1043.701,139,1047.548,139C1051.396,139,1054.577,139,1056.167,139L1057.758,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I2_O_14" d="M1126.352,139L1130.866,139C1135.38,139,1144.409,139,1151.007,139C1157.604,139,1161.771,139,1165.271,139C1168.771,139,1171.604,139,1173.021,139L1174.438,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_O_N_15" d="M1247.063,139L1251.229,139C1255.396,139,1263.729,139,1269.979,139C1276.229,139,1280.396,139,1283.896,139C1287.396,139,1290.229,139,1291.646,139L1293.063,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_End2_16" d="M1365.844,139L1370.01,139C1374.177,139,1382.51,139,1388.76,139C1395.01,139,1399.177,139,1402.677,139C1406.177,139,1409.01,139,1410.427,139L1411.844,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Start_E2_17" d="M46.42,158.5L53.652,172.583C60.884,186.667,75.348,214.833,84.664,228.917C93.979,243,98.146,243,101.646,243C105.146,243,107.979,243,109.396,243L110.813,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E2_L3_18" d="M183.578,243L187.745,243C191.911,243,200.245,243,206.67,243C213.095,243,217.612,243,221.462,243C225.313,243,228.496,243,230.088,243L231.68,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L3_A3_19" d="M300.43,243L304.947,243C309.464,243,318.497,243,325.119,243C331.741,243,335.951,243,339.493,243C343.036,243,345.913,243,347.351,243L348.789,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A3_S_20" d="M421.227,243L425.436,243C429.646,243,438.065,243,444.358,243C450.651,243,454.818,243,458.318,243C461.818,243,464.651,243,466.068,243L467.484,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_S_T2_21" d="M538,243L542.167,243C546.333,243,554.667,243,561.016,243C567.366,243,571.732,243,575.431,243C579.13,243,582.163,243,583.679,243L585.195,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T2_I3_22" d="M655.57,243L659.936,243C664.302,243,673.034,243,679.623,243C686.212,243,690.659,243,694.439,243C698.219,243,701.332,243,702.889,243L704.445,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I3_C2_23" d="M773.039,243L777.486,243C781.932,243,790.826,243,797.376,243C803.926,243,808.133,243,811.673,243C815.214,243,818.087,243,819.524,243L820.961,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C2_S2_24" d="M892.914,243L897.121,243C901.328,243,909.742,243,916.033,243C922.323,243,926.49,243,929.99,243C933.49,243,936.323,243,937.74,243L939.156,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_S2_E3_25" d="M1009.672,243L1013.839,243C1018.005,243,1026.339,243,1032.589,243C1038.839,243,1043.005,243,1046.505,243C1050.005,243,1052.839,243,1054.255,243L1055.672,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E3_A4_26" d="M1128.438,243L1132.604,243C1136.771,243,1145.104,243,1151.362,243C1157.62,243,1161.802,243,1165.318,243C1168.833,243,1171.682,243,1173.107,243L1174.531,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A4_R_27" d="M1246.969,243L1251.151,243C1255.333,243,1263.698,243,1270.069,243C1276.44,243,1280.818,243,1284.529,243C1288.24,243,1291.284,243,1292.806,243L1294.328,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_R_C3_28" d="M1364.578,243L1368.956,243C1373.333,243,1382.089,243,1390.097,243C1398.105,243,1405.367,243,1411.962,243C1418.557,243,1424.486,243,1427.45,243L1430.414,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C3_H_29" d="M1502.367,243L1509.629,243C1516.891,243,1531.414,243,1540.759,243C1550.104,243,1554.271,243,1557.771,243C1561.271,243,1564.104,243,1565.521,243L1566.938,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_End3_30" d="M1639.719,243L1643.885,243C1648.052,243,1656.385,243,1662.635,243C1668.885,243,1673.052,243,1676.552,243C1680.052,243,1682.885,243,1684.302,243L1685.719,243"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(36.40625, 139)" id="flowchart-Start-21888" class="node default"><rect height="39" width="56.8125" y="-19.5" x="-28.40625" ry="19.5" rx="19.5" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-16.03125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>开始</p></span></div></foreignObject></g></g><g transform="translate(149.1953125, 87)" id="flowchart-A-21889" class="node default"><rect height="54" width="68.4375" y="-27" x="-34.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>a</p></span></div></foreignObject></g></g><g transform="translate(268.0546875, 35)" id="flowchart-P1-21891" class="node default"><rect height="54" width="68.953125" y="-27" x="-34.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>p</p></span></div></foreignObject></g></g><g transform="translate(387.0078125, 35)" id="flowchart-P2-21893" class="node default"><rect height="54" width="68.953125" y="-27" x="-34.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>p</p></span></div></foreignObject></g></g><g transform="translate(504.7421875, 35)" id="flowchart-L-21895" class="node default"><rect height="54" width="64.75" y="-27" x="-32.375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>l</p></span></div></foreignObject></g></g><g transform="translate(622.3828125, 35)" id="flowchart-E1-21897" class="node default"><rect height="54" width="68.765625" y="-27" x="-34.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.3828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>e</p></span></div></foreignObject></g></g><g transform="translate(740.7421875, 35)" id="flowchart-End1-21899" class="node default"><rect height="39" width="64.5625" y="-19.5" x="-32.28125" ry="19.5" rx="19.5" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-19.90625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="39.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>apple</p></span></div></foreignObject></g></g><g transform="translate(268.0546875, 139)" id="flowchart-P3-21901" class="node default"><rect height="54" width="68.953125" y="-27" x="-34.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>p</p></span></div></foreignObject></g></g><g transform="translate(387.0078125, 139)" id="flowchart-P4-21903" class="node default"><rect height="54" width="68.953125" y="-27" x="-34.4765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.4765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>p</p></span></div></foreignObject></g></g><g transform="translate(504.7421875, 139)" id="flowchart-L2-21905" class="node default"><rect height="54" width="64.75" y="-27" x="-32.375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>l</p></span></div></foreignObject></g></g><g transform="translate(622.3828125, 139)" id="flowchart-I-21907" class="node default"><rect height="54" width="64.59375" y="-27" x="-32.296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>i</p></span></div></foreignObject></g></g><g transform="translate(740.7421875, 139)" id="flowchart-C-21909" class="node default"><rect height="54" width="67.953125" y="-27" x="-33.9765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.9765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="7.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>c</p></span></div></foreignObject></g></g><g transform="translate(858.9375, 139)" id="flowchart-A2-21911" class="node default"><rect height="54" width="68.4375" y="-27" x="-34.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>a</p></span></div></foreignObject></g></g><g transform="translate(976.4140625, 139)" id="flowchart-T-21913" class="node default"><rect height="54" width="66.375" y="-27" x="-33.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.1875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="6.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>t</p></span></div></foreignObject></g></g><g transform="translate(1094.0546875, 139)" id="flowchart-I2-21915" class="node default"><rect height="54" width="64.59375" y="-27" x="-32.296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>i</p></span></div></foreignObject></g></g><g transform="translate(1212.75, 139)" id="flowchart-O-21917" class="node default"><rect height="54" width="68.625" y="-27" x="-34.3125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.3125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>o</p></span></div></foreignObject></g></g><g transform="translate(1331.453125, 139)" id="flowchart-N-21919" class="node default"><rect height="54" width="68.78125" y="-27" x="-34.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>n</p></span></div></foreignObject></g></g><g transform="translate(1468.390625, 139)" id="flowchart-End2-21921" class="node default"><rect height="39" width="105.09375" y="-19.5" x="-52.546875" ry="19.5" rx="19.5" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-40.171875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>application</p></span></div></foreignObject></g></g><g transform="translate(149.1953125, 243)" id="flowchart-E2-21923" class="node default"><rect height="54" width="68.765625" y="-27" x="-34.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.3828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>e</p></span></div></foreignObject></g></g><g transform="translate(268.0546875, 243)" id="flowchart-L3-21925" class="node default"><rect height="54" width="64.75" y="-27" x="-32.375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>l</p></span></div></foreignObject></g></g><g transform="translate(387.0078125, 243)" id="flowchart-A3-21927" class="node default"><rect height="54" width="68.4375" y="-27" x="-34.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>a</p></span></div></foreignObject></g></g><g transform="translate(504.7421875, 243)" id="flowchart-S-21929" class="node default"><rect height="54" width="66.515625" y="-27" x="-33.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.2578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="6.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>s</p></span></div></foreignObject></g></g><g transform="translate(622.3828125, 243)" id="flowchart-T2-21931" class="node default"><rect height="54" width="66.375" y="-27" x="-33.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.1875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="6.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>t</p></span></div></foreignObject></g></g><g transform="translate(740.7421875, 243)" id="flowchart-I3-21933" class="node default"><rect height="54" width="64.59375" y="-27" x="-32.296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-2.296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="4.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>i</p></span></div></foreignObject></g></g><g transform="translate(858.9375, 243)" id="flowchart-C2-21935" class="node default"><rect height="54" width="67.953125" y="-27" x="-33.9765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.9765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="7.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>c</p></span></div></foreignObject></g></g><g transform="translate(976.4140625, 243)" id="flowchart-S2-21937" class="node default"><rect height="54" width="66.515625" y="-27" x="-33.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.2578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="6.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>s</p></span></div></foreignObject></g></g><g transform="translate(1094.0546875, 243)" id="flowchart-E3-21939" class="node default"><rect height="54" width="68.765625" y="-27" x="-34.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.3828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>e</p></span></div></foreignObject></g></g><g transform="translate(1212.75, 243)" id="flowchart-A4-21941" class="node default"><rect height="54" width="68.4375" y="-27" x="-34.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>a</p></span></div></foreignObject></g></g><g transform="translate(1331.453125, 243)" id="flowchart-R-21943" class="node default"><rect height="54" width="66.25" y="-27" x="-33.125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="6.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>r</p></span></div></foreignObject></g></g><g transform="translate(1468.390625, 243)" id="flowchart-C3-21945" class="node default"><rect height="54" width="67.953125" y="-27" x="-33.9765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-3.9765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="7.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>c</p></span></div></foreignObject></g></g><g transform="translate(1605.328125, 243)" id="flowchart-H-21947" class="node default"><rect height="54" width="68.78125" y="-27" x="-34.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>h</p></span></div></foreignObject></g></g><g transform="translate(1749.078125, 243)" id="flowchart-End3-21949" class="node default"><rect height="39" width="118.71875" y="-19.5" x="-59.359375" ry="19.5" rx="19.5" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-46.984375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="93.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>elasticsearch</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="qg4rcd_5" data-toc="qg4rcd_5">架构设计</h2><section class="chapter"><h3 id="1" data-toc="1">1. 集群架构</h3><div class="code-block" data-lang="none">
Master Node (主节点)
├── 集群状态管理
├── 索引创建/删除
├── 节点加入/离开
└── 分片分配

Data Node (数据节点)  
├── 存储数据
├── 执行查询
├── 聚合计算
└── 索引操作

Coordinating Node (协调节点)
├── 请求路由
├── 结果聚合
├── 负载均衡
└── 查询优化

Ingest Node (摄取节点)
├── 数据预处理
├── 文档转换
├── 管道处理
└── 数据清洗
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 分片机制</h3><div class="code-block" data-lang="json">
{
  &quot;settings&quot;: {
    &quot;number_of_shards&quot;: 3,
    &quot;number_of_replicas&quot;: 1
  }
}
</div><p id="qg4rcd_259"><span class="control" id="qg4rcd_262">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_260"><li class="list__item" id="qg4rcd_263"><p id="qg4rcd_267">主分片和副本分片的区别</p></li><li class="list__item" id="qg4rcd_264"><p id="qg4rcd_268">分片数量的选择策略</p></li><li class="list__item" id="qg4rcd_265"><p id="qg4rcd_269">分片路由算法: <code class="code" id="qg4rcd_270">shard = hash(routing) % number_of_primary_shards</code></p></li><li class="list__item" id="qg4rcd_266"><p id="qg4rcd_271">分片重平衡机制</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_6" data-toc="qg4rcd_6">索引与映射</h2><section class="chapter"><h3 id="1-vs" data-toc="1-vs">1. 动态映射 vs 静态映射</h3><div class="code-block" data-lang="json">
// 静态映射示例
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;title&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_max_word&quot;
      },
      &quot;price&quot;: {
        &quot;type&quot;: &quot;double&quot;
      },
      &quot;created_at&quot;: {
        &quot;type&quot;: &quot;date&quot;,
        &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;
      },
      &quot;tags&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      }
    }
  }
}
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 字段类型详解</h3><div class="table-wrapper"><table class="wide" id="qg4rcd_275"><thead><tr class="ijRowHead" id="qg4rcd_279"><th id="qg4rcd_287"><p>类型</p></th><th id="qg4rcd_288"><p>用途</p></th><th id="qg4rcd_289"><p>特点</p></th></tr></thead><tbody><tr id="qg4rcd_280"><td id="qg4rcd_290"><p>text</p></td><td id="qg4rcd_291"><p>全文搜索</p></td><td id="qg4rcd_292"><p>会被分词，支持模糊查询</p></td></tr><tr id="qg4rcd_281"><td id="qg4rcd_293"><p>keyword</p></td><td id="qg4rcd_294"><p>精确匹配</p></td><td id="qg4rcd_295"><p>不分词，支持聚合和排序</p></td></tr><tr id="qg4rcd_282"><td id="qg4rcd_296"><p>date</p></td><td id="qg4rcd_297"><p>日期时间</p></td><td id="qg4rcd_298"><p>支持日期范围查询</p></td></tr><tr id="qg4rcd_283"><td id="qg4rcd_299"><p>numeric</p></td><td id="qg4rcd_300"><p>数值类型</p></td><td id="qg4rcd_301"><p>支持范围查询和数学运算</p></td></tr><tr id="qg4rcd_284"><td id="qg4rcd_302"><p>boolean</p></td><td id="qg4rcd_303"><p>布尔值</p></td><td id="qg4rcd_304"><p>true/false</p></td></tr><tr id="qg4rcd_285"><td id="qg4rcd_305"><p>object</p></td><td id="qg4rcd_306"><p>嵌套对象</p></td><td id="qg4rcd_307"><p>JSON对象</p></td></tr><tr id="qg4rcd_286"><td id="qg4rcd_308"><p>nested</p></td><td id="qg4rcd_309"><p>嵌套文档</p></td><td id="qg4rcd_310"><p>独立索引的嵌套对象</p></td></tr></tbody></table></div><p id="qg4rcd_276"><span class="control" id="qg4rcd_311">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_277"><li class="list__item" id="qg4rcd_312"><p id="qg4rcd_316">text vs keyword 的使用场景</p></li><li class="list__item" id="qg4rcd_313"><p id="qg4rcd_317">嵌套对象的查询方式</p></li><li class="list__item" id="qg4rcd_314"><p id="qg4rcd_318">映射爆炸问题及解决方案</p></li><li class="list__item" id="qg4rcd_315"><p id="qg4rcd_319">字段数据类型的选择策略</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_7" data-toc="qg4rcd_7">查询与聚合</h2><section class="chapter"><h3 id="1-dsl" data-toc="1-dsl">1. 查询DSL结构</h3><div class="code-block" data-lang="json">
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {&quot;match&quot;: {&quot;title&quot;: &quot;elasticsearch&quot;}}
      ],
      &quot;filter&quot;: [
        {&quot;range&quot;: {&quot;price&quot;: {&quot;gte&quot;: 100, &quot;lte&quot;: 1000}}}
      ],
      &quot;should&quot;: [
        {&quot;term&quot;: {&quot;category&quot;: &quot;database&quot;}}
      ],
      &quot;must_not&quot;: [
        {&quot;term&quot;: {&quot;status&quot;: &quot;deleted&quot;}}
      ]
    }
  },
  &quot;aggs&quot;: {
    &quot;price_stats&quot;: {
      &quot;stats&quot;: {&quot;field&quot;: &quot;price&quot;}
    }
  },
  &quot;sort&quot;: [
    {&quot;created_at&quot;: {&quot;order&quot;: &quot;desc&quot;}}
  ]
}
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 查询类型分类</h3><p id="qg4rcd_324"><span class="control" id="qg4rcd_330">全文查询:</span></p><ul class="list _bullet" id="qg4rcd_325"><li class="list__item" id="qg4rcd_331"><p id="qg4rcd_335"><code class="code" id="qg4rcd_336">match</code>: 分词匹配</p></li><li class="list__item" id="qg4rcd_332"><p id="qg4rcd_337"><code class="code" id="qg4rcd_338">match_phrase</code>: 短语匹配</p></li><li class="list__item" id="qg4rcd_333"><p id="qg4rcd_339"><code class="code" id="qg4rcd_340">multi_match</code>: 多字段匹配</p></li><li class="list__item" id="qg4rcd_334"><p id="qg4rcd_341"><code class="code" id="qg4rcd_342">query_string</code>: 查询字符串</p></li></ul><p id="qg4rcd_326"><span class="control" id="qg4rcd_343">精确查询:</span></p><ul class="list _bullet" id="qg4rcd_327"><li class="list__item" id="qg4rcd_344"><p id="qg4rcd_348"><code class="code" id="qg4rcd_349">term</code>: 精确匹配</p></li><li class="list__item" id="qg4rcd_345"><p id="qg4rcd_350"><code class="code" id="qg4rcd_351">terms</code>: 多值匹配</p></li><li class="list__item" id="qg4rcd_346"><p id="qg4rcd_352"><code class="code" id="qg4rcd_353">range</code>: 范围查询</p></li><li class="list__item" id="qg4rcd_347"><p id="qg4rcd_354"><code class="code" id="qg4rcd_355">exists</code>: 字段存在查询</p></li></ul><p id="qg4rcd_328"><span class="control" id="qg4rcd_356">复合查询:</span></p><ul class="list _bullet" id="qg4rcd_329"><li class="list__item" id="qg4rcd_357"><p id="qg4rcd_360"><code class="code" id="qg4rcd_361">bool</code>: 布尔查询</p></li><li class="list__item" id="qg4rcd_358"><p id="qg4rcd_362"><code class="code" id="qg4rcd_363">dis_max</code>: 最佳匹配</p></li><li class="list__item" id="qg4rcd_359"><p id="qg4rcd_364"><code class="code" id="qg4rcd_365">function_score</code>: 自定义评分</p></li></ul></section><section class="chapter"><h3 id="3" data-toc="3">3. 聚合分析</h3><div class="code-block" data-lang="json">
{
  &quot;aggs&quot;: {
    &quot;sales_per_month&quot;: {
      &quot;date_histogram&quot;: {
        &quot;field&quot;: &quot;date&quot;,
        &quot;calendar_interval&quot;: &quot;month&quot;
      },
      &quot;aggs&quot;: {
        &quot;total_sales&quot;: {
          &quot;sum&quot;: {&quot;field&quot;: &quot;amount&quot;}
        },
        &quot;avg_price&quot;: {
          &quot;avg&quot;: {&quot;field&quot;: &quot;price&quot;}
        }
      }
    }
  }
}
</div><p id="qg4rcd_367"><span class="control" id="qg4rcd_370">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_368"><li class="list__item" id="qg4rcd_371"><p id="qg4rcd_375">Query Context vs Filter Context 的区别</p></li><li class="list__item" id="qg4rcd_372"><p id="qg4rcd_376">评分机制（TF-IDF, BM25）</p></li><li class="list__item" id="qg4rcd_373"><p id="qg4rcd_377">聚合的执行顺序和性能优化</p></li><li class="list__item" id="qg4rcd_374"><p id="qg4rcd_378">管道聚合的使用场景</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_8" data-toc="qg4rcd_8">性能优化</h2><section class="chapter"><h3 id="1" data-toc="1">1. 索引优化</h3><div class="code-block" data-lang="json">
{
  &quot;settings&quot;: {
    &quot;refresh_interval&quot;: &quot;30s&quot;,
    &quot;number_of_replicas&quot;: 0,
    &quot;index.translog.flush_threshold_size&quot;: &quot;1gb&quot;,
    &quot;index.merge.policy.max_merged_segment&quot;: &quot;5gb&quot;
  }
}
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 查询优化策略</h3><div class="code-block" data-lang="json">
// 使用filter而非query（不计算评分）
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;filter&quot;: [
        {&quot;term&quot;: {&quot;status&quot;: &quot;published&quot;}},
        {&quot;range&quot;: {&quot;date&quot;: {&quot;gte&quot;: &quot;2023-01-01&quot;}}}
      ]
    }
  }
}

// 使用_source过滤
{
  &quot;_source&quot;: [&quot;title&quot;, &quot;price&quot;],
  &quot;query&quot;: {&quot;match_all&quot;: {}}
}
</div></section><section class="chapter"><h3 id="3" data-toc="3">3. 写入性能优化</h3><div class="code-block" data-lang="bash">
# 批量写入
POST _bulk
{&quot;index&quot;: {&quot;_index&quot;: &quot;products&quot;, &quot;_id&quot;: &quot;1&quot;}}
{&quot;title&quot;: &quot;Product 1&quot;, &quot;price&quot;: 100}
{&quot;index&quot;: {&quot;_index&quot;: &quot;products&quot;, &quot;_id&quot;: &quot;2&quot;}}
{&quot;title&quot;: &quot;Product 2&quot;, &quot;price&quot;: 200}
</div><p id="qg4rcd_385"><span class="control" id="qg4rcd_388">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_386"><li class="list__item" id="qg4rcd_389"><p id="qg4rcd_394">refresh_interval 对性能的影响</p></li><li class="list__item" id="qg4rcd_390"><p id="qg4rcd_395">批量操作的最佳实践</p></li><li class="list__item" id="qg4rcd_391"><p id="qg4rcd_396">索引模板的使用</p></li><li class="list__item" id="qg4rcd_392"><p id="qg4rcd_397">冷热数据分离策略</p></li><li class="list__item" id="qg4rcd_393"><p id="qg4rcd_398">分片大小的最佳实践（20-40GB）</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_9" data-toc="qg4rcd_9">集群管理</h2><section class="chapter"><h3 id="1" data-toc="1">1. 集群健康状态</h3><div class="code-block" data-lang="bash">
GET _cluster/health
</div><p id="qg4rcd_403"><span class="control" id="qg4rcd_405">状态说明:</span></p><ul class="list _bullet" id="qg4rcd_404"><li class="list__item" id="qg4rcd_406"><p id="qg4rcd_409"><span class="control" id="qg4rcd_410">Green</span>: 所有分片都正常</p></li><li class="list__item" id="qg4rcd_407"><p id="qg4rcd_411"><span class="control" id="qg4rcd_412">Yellow</span>: 主分片正常，部分副本分片不可用</p></li><li class="list__item" id="qg4rcd_408"><p id="qg4rcd_413"><span class="control" id="qg4rcd_414">Red</span>: 部分主分片不可用</p></li></ul></section><section class="chapter"><h3 id="2" data-toc="2">2. 分片分配</h3><div class="code-block" data-lang="json">
{
  &quot;persistent&quot;: {
    &quot;cluster.routing.allocation.disk.threshold.enabled&quot;: true,
    &quot;cluster.routing.allocation.disk.watermark.low&quot;: &quot;85%&quot;,
    &quot;cluster.routing.allocation.disk.watermark.high&quot;: &quot;90%&quot;
  }
}
</div></section><section class="chapter"><h3 id="3-ilm" data-toc="3-ilm">3. 索引生命周期管理（ILM）</h3><div class="code-block" data-lang="json">
{
  &quot;policy&quot;: {
    &quot;phases&quot;: {
      &quot;hot&quot;: {
        &quot;actions&quot;: {
          &quot;rollover&quot;: {
            &quot;max_size&quot;: &quot;10GB&quot;,
            &quot;max_age&quot;: &quot;7d&quot;
          }
        }
      },
      &quot;warm&quot;: {
        &quot;min_age&quot;: &quot;7d&quot;,
        &quot;actions&quot;: {
          &quot;allocate&quot;: {
            &quot;number_of_replicas&quot;: 0
          }
        }
      },
      &quot;delete&quot;: {
        &quot;min_age&quot;: &quot;90d&quot;
      }
    }
  }
}
</div><p id="qg4rcd_417"><span class="control" id="qg4rcd_420">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_418"><li class="list__item" id="qg4rcd_421"><p id="qg4rcd_425">脑裂问题及解决方案</p></li><li class="list__item" id="qg4rcd_422"><p id="qg4rcd_426">节点发现机制</p></li><li class="list__item" id="qg4rcd_423"><p id="qg4rcd_427">分片分配策略</p></li><li class="list__item" id="qg4rcd_424"><p id="qg4rcd_428">集群备份与恢复</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_10" data-toc="qg4rcd_10">数据建模</h2><section class="chapter"><h3 id="1" data-toc="1">1. 关系数据建模</h3><p id="qg4rcd_431"><span class="control" id="qg4rcd_433">嵌套对象 vs 父子文档:</span></p><div class="code-block" data-lang="json">
// 嵌套对象
{
  &quot;title&quot;: &quot;Blog Post&quot;,
  &quot;comments&quot;: [
    {&quot;author&quot;: &quot;John&quot;, &quot;content&quot;: &quot;Great post!&quot;},
    {&quot;author&quot;: &quot;Jane&quot;, &quot;content&quot;: &quot;Thanks for sharing&quot;}
  ]
}

// 父子文档
// 父文档
{&quot;title&quot;: &quot;Blog Post&quot;, &quot;type&quot;: &quot;post&quot;}
// 子文档  
{&quot;author&quot;: &quot;John&quot;, &quot;content&quot;: &quot;Great post!&quot;, &quot;type&quot;: &quot;comment&quot;, &quot;_parent&quot;: &quot;1&quot;}
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 时间序列数据建模</h3><div class="code-block" data-lang="json">
{
  &quot;index_patterns&quot;: [&quot;logs-*&quot;],
  &quot;template&quot;: {
    &quot;settings&quot;: {
      &quot;number_of_shards&quot;: 1,
      &quot;number_of_replicas&quot;: 0,
      &quot;index.lifecycle.name&quot;: &quot;logs-policy&quot;
    },
    &quot;mappings&quot;: {
      &quot;properties&quot;: {
        &quot;@timestamp&quot;: {&quot;type&quot;: &quot;date&quot;},
        &quot;level&quot;: {&quot;type&quot;: &quot;keyword&quot;},
        &quot;message&quot;: {&quot;type&quot;: &quot;text&quot;}
      }
    }
  }
}
</div><p id="qg4rcd_435"><span class="control" id="qg4rcd_438">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_436"><li class="list__item" id="qg4rcd_439"><p id="qg4rcd_443">反规范化设计原则</p></li><li class="list__item" id="qg4rcd_440"><p id="qg4rcd_444">索引模板的使用</p></li><li class="list__item" id="qg4rcd_441"><p id="qg4rcd_445">数据建模最佳实践</p></li><li class="list__item" id="qg4rcd_442"><p id="qg4rcd_446">多租户架构设计</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_11" data-toc="qg4rcd_11">监控与运维</h2><section class="chapter"><h3 id="1" data-toc="1">1. 关键指标监控</h3><div class="code-block" data-lang="bash">
# 集群统计
GET _cluster/stats

# 节点统计  
GET _nodes/stats

# 索引统计
GET _stats

# 慢查询日志
GET _cluster/settings
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 常用运维命令</h3><div class="code-block" data-lang="bash">
# 查看分片分配
GET _cat/shards?v

# 查看索引状态
GET _cat/indices?v

# 重新路由分片
POST _cluster/reroute

# 强制合并
POST /index_name/_forcemerge?max_num_segments=1
</div><p id="qg4rcd_451"><span class="control" id="qg4rcd_454">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_452"><li class="list__item" id="qg4rcd_455"><p id="qg4rcd_459">关键性能指标（QPS、延迟、CPU、内存）</p></li><li class="list__item" id="qg4rcd_456"><p id="qg4rcd_460">慢查询分析和优化</p></li><li class="list__item" id="qg4rcd_457"><p id="qg4rcd_461">集群容量规划</p></li><li class="list__item" id="qg4rcd_458"><p id="qg4rcd_462">故障排查流程</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_12" data-toc="qg4rcd_12">安全特性</h2><section class="chapter"><h3 id="1" data-toc="1">1. 认证与授权</h3><div class="code-block" data-lang="yaml">
# elasticsearch.yml
xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
xpack.security.http.ssl.enabled: true
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 角色权限管理</h3><div class="code-block" data-lang="json">
{
  &quot;cluster&quot;: [&quot;monitor&quot;],
  &quot;indices&quot;: [
    {
      &quot;names&quot;: [&quot;logs-*&quot;],
      &quot;privileges&quot;: [&quot;read&quot;, &quot;view_index_metadata&quot;]
    }
  ]
}
</div><p id="qg4rcd_467"><span class="control" id="qg4rcd_470">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_468"><li class="list__item" id="qg4rcd_471"><p id="qg4rcd_475">X-Pack安全功能</p></li><li class="list__item" id="qg4rcd_472"><p id="qg4rcd_476">SSL/TLS配置</p></li><li class="list__item" id="qg4rcd_473"><p id="qg4rcd_477">字段级安全</p></li><li class="list__item" id="qg4rcd_474"><p id="qg4rcd_478">审计日志</p></li></ul></section></section><section class="chapter"><h2 id="ai" data-toc="ai">向量检索与AI集成</h2><section class="chapter"><h3 id="1-es8" data-toc="1-es8">1. ES8向量检索核心概念</h3><p id="qg4rcd_488">Elasticsearch 8.0引入了原生向量检索能力，支持高维向量的存储、索引和相似性搜索，为AI应用提供了强大的基础设施。</p><section class="chapter"><h4 id="qg4rcd_489" data-toc="qg4rcd_489">核心特性</h4><ul class="list _bullet" id="qg4rcd_490"><li class="list__item" id="qg4rcd_491"><p id="qg4rcd_496"><span class="control" id="qg4rcd_497">dense_vector字段类型</span>: 支持最高2048维的向量存储</p></li><li class="list__item" id="qg4rcd_492"><p id="qg4rcd_498"><span class="control" id="qg4rcd_499">kNN搜索</span>: k-最近邻搜索，支持余弦相似度、点积、L2距离</p></li><li class="list__item" id="qg4rcd_493"><p id="qg4rcd_500"><span class="control" id="qg4rcd_501">HNSW索引</span>: 分层可导航小世界图，提供高效的近似最近邻搜索</p></li><li class="list__item" id="qg4rcd_494"><p id="qg4rcd_502"><span class="control" id="qg4rcd_503">混合搜索</span>: 向量搜索与传统文本搜索的结合</p></li><li class="list__item" id="qg4rcd_495"><p id="qg4rcd_504"><span class="control" id="qg4rcd_505">向量量化</span>: 减少内存占用和提升查询性能</p></li></ul></section></section><section class="chapter"><h3 id="2" data-toc="2">2. 高并发向量操作优化策略</h3><p id="qg4rcd_506"><span class="control" id="qg4rcd_515">Q10: 在高并发场景下，如何优化Elasticsearch的向量插入和检索性能？</span></p><p id="qg4rcd_507"><span class="control" id="qg4rcd_516">标准回答:</span></p><div class="code-block" data-lang="none">
高并发向量操作的优化需要从多个维度进行考虑：

1. 向量字段配置优化：
   - 选择合适的相似性算法：cosine、dot_product、l2_norm
   - 设置合理的维度数：平衡精度和性能
   - 启用向量量化：减少内存占用

2. HNSW索引参数调优：
   - m参数：控制图的连接度，默认16，高并发场景建议8-12
   - ef_construction：构建时的候选数量，默认100，可调整为50-200
   - ef_search：搜索时的候选数量，影响召回率和延迟

3. 批量写入优化：
   - 使用bulk API进行批量插入
   - 控制批次大小：建议1000-5000个文档
   - 调整refresh_interval：写入密集时设为30s或更长
   - 临时禁用副本：写入完成后再启用

4. 内存和存储优化：
   - 增加堆内存：向量数据占用大量内存
   - 使用SSD存储：提升I/O性能
   - 配置合理的分片数量：避免过多小分片

5. 查询优化策略：
   - 使用filter预过滤：减少向量计算范围
   - 调整num_candidates：平衡精度和性能
   - 启用查询缓存：缓存热点查询结果
   - 使用routing：将相关向量路由到同一分片

6. 集群架构优化：
   - 专用向量节点：分离向量计算和其他操作
   - 增加协调节点：分担查询协调压力
   - 使用多副本：提升查询并发能力

实际配置示例：
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;vector&quot;: {
        &quot;type&quot;: &quot;dense_vector&quot;,
        &quot;dims&quot;: 768,
        &quot;similarity&quot;: &quot;cosine&quot;,
        &quot;index&quot;: true,
        &quot;index_options&quot;: {
          &quot;type&quot;: &quot;hnsw&quot;,
          &quot;m&quot;: 10,
          &quot;ef_construction&quot;: 80
        }
      }
    }
  },
  &quot;settings&quot;: {
    &quot;number_of_shards&quot;: 3,
    &quot;number_of_replicas&quot;: 1,
    &quot;refresh_interval&quot;: &quot;30s&quot;,
    &quot;index.knn.space_type&quot;: &quot;cosinesimil&quot;
  }
}

高并发查询示例：
{
  &quot;knn&quot;: {
    &quot;field&quot;: &quot;vector&quot;,
    &quot;query_vector&quot;: [0.1, 0.2, ...],
    &quot;k&quot;: 10,
    &quot;num_candidates&quot;: 100,
    &quot;filter&quot;: {
      &quot;term&quot;: {&quot;category&quot;: &quot;electronics&quot;}
    }
  }
}
</div><p id="qg4rcd_509"><span class="control" id="qg4rcd_517">向量检索架构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1062.2578125 930"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1062.2578125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="向量处理" class="cluster"><rect height="128" width="629.984375" y="794" x="33.0234375" style=""></rect><g transform="translate(315.9609375, 794)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量处理</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph5" class="cluster"><rect height="380" width="1046.2578125" y="364" x="8" style=""></rect><g transform="translate(467.10546875, 364)" class="cluster-label"><foreignObject height="24" width="128.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ES集群 - 向量专用</p></span></div></foreignObject></g></g><g data-look="classic" id="负载均衡层" class="cluster"><rect height="128" width="718.32421875" y="186" x="94.69140625" style=""></rect><g transform="translate(413.791015625, 186)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>负载均衡层</p></span></div></foreignObject></g></g><g data-look="classic" id="客户端层" class="cluster"><rect height="128" width="542.328125" y="8" x="169.1171875" style=""></rect><g transform="translate(408.2265625, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端层</p></span></div></foreignObject></g></g><g data-look="classic" id="文本数据节点" class="cluster"><rect height="152" width="385.03125" y="567" x="649.2265625" style=""></rect><g transform="translate(793.6640625, 567)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本数据节点</p></span></div></foreignObject></g></g><g data-look="classic" id="向量数据节点" class="cluster"><rect height="152" width="601.2265625" y="567" x="28" style=""></rect><g transform="translate(280.53515625, 567)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量数据节点</p></span></div></foreignObject></g></g><g data-look="classic" id="协调节点" class="cluster"><rect height="128" width="893.55078125" y="389" x="59.44921875" style=""></rect><g transform="translate(474.169921875, 389)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_App1_LB_0" d="M266.172,111L266.172,115.167C266.172,119.333,266.172,127.667,266.172,136C266.172,144.333,266.172,152.667,266.172,161C266.172,169.333,266.172,177.667,281.054,185.664C295.937,193.661,325.702,201.322,354.821,208.817C383.941,216.312,412.414,223.641,426.651,227.305L440.888,230.97"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_App2_LB_1" d="M440.281,111L440.281,115.167C440.281,119.333,440.281,127.667,440.281,136C440.281,144.333,440.281,152.667,440.281,161C440.281,169.333,440.281,177.667,442.708,183.917C445.134,190.167,449.987,194.333,454.335,198.066C458.682,201.798,462.523,205.096,464.444,206.745L466.365,208.394"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_App3_LB_2" d="M614.391,111L614.391,115.167C614.391,119.333,614.391,127.667,614.391,136C614.391,144.333,614.391,152.667,614.391,161C614.391,169.333,614.391,177.667,611.15,183.917C607.908,190.167,601.426,194.333,595.505,198.14C589.583,201.946,584.223,205.391,581.543,207.114L578.862,208.837"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_LB_Coord1_3" d="M444.762,265.3L407.592,273.416C370.423,281.533,296.085,297.767,258.915,310.05C221.746,322.333,221.746,330.667,221.746,339C221.746,347.333,221.746,355.667,221.746,364C221.746,372.333,221.746,380.667,221.746,386.917C221.746,393.167,221.746,397.333,221.746,400.833C221.746,404.333,221.746,407.167,221.746,408.583L221.746,410"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_LB_Coord2_4" d="M584.887,269.027L612.486,276.523C640.086,284.018,695.285,299.009,722.885,310.671C750.484,322.333,750.484,330.667,750.484,339C750.484,347.333,750.484,355.667,750.484,364C750.484,372.333,750.484,380.667,750.484,386.917C750.484,393.167,750.484,397.333,750.484,400.833C750.484,404.333,750.484,407.167,750.484,408.583L750.484,410"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord1_VN1_5" d="M165.886,492L159.918,496.167C153.95,500.333,142.014,508.667,136.046,517C130.078,525.333,130.078,533.667,130.078,542C130.078,550.333,130.078,558.667,130.078,564.917C130.078,571.167,130.078,575.333,130.078,578.833C130.078,582.333,130.078,585.167,130.078,586.583L130.078,588"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord1_VN2_6" d="M278.106,492L284.128,496.167C290.149,500.333,302.192,508.667,308.213,517C314.234,525.333,314.234,533.667,314.234,542C314.234,550.333,314.234,558.667,314.234,564.917C314.234,571.167,314.234,575.333,314.234,578.833C314.234,582.333,314.234,585.167,314.234,586.583L314.234,588"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_VN3_7" d="M684.227,471.987L658.047,479.489C631.867,486.991,579.508,501.996,553.328,513.665C527.148,525.333,527.148,533.667,527.148,542C527.148,550.333,527.148,558.667,527.148,564.917C527.148,571.167,527.148,575.333,527.148,578.833C527.148,582.333,527.148,585.167,527.148,586.583L527.148,588"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_TN1_8" d="M750.484,492L750.484,496.167C750.484,500.333,750.484,508.667,750.484,517C750.484,525.333,750.484,533.667,750.484,542C750.484,550.333,750.484,558.667,750.484,564.917C750.484,571.167,750.484,575.333,750.484,578.833C750.484,582.333,750.484,585.167,750.484,586.583L750.484,588"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Coord2_TN2_9" d="M816.742,476.234L836.118,483.028C855.495,489.822,894.247,503.411,913.624,514.372C933,525.333,933,533.667,933,542C933,550.333,933,558.667,933,564.917C933,571.167,933,575.333,933,578.833C933,582.333,933,585.167,933,586.583L933,588"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VN1_HNSW1_10" d="M130.078,694L130.078,698.167C130.078,702.333,130.078,710.667,130.078,719C130.078,727.333,130.078,735.667,130.078,744C130.078,752.333,130.078,760.667,130.078,769C130.078,777.333,130.078,785.667,130.078,791.917C130.078,798.167,130.078,802.333,130.078,805.833C130.078,809.333,130.078,812.167,130.078,813.583L130.078,815"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VN2_HNSW2_11" d="M314.234,694L314.234,698.167C314.234,702.333,314.234,710.667,314.234,719C314.234,727.333,314.234,735.667,314.234,744C314.234,752.333,314.234,760.667,314.234,769C314.234,777.333,314.234,785.667,314.234,791.917C314.234,798.167,314.234,802.333,314.234,805.833C314.234,809.333,314.234,812.167,314.234,813.583L314.234,815"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VN3_HNSW3_12" d="M527.148,694L527.148,698.167C527.148,702.333,527.148,710.667,527.148,719C527.148,727.333,527.148,735.667,527.148,744C527.148,752.333,527.148,760.667,527.148,769C527.148,777.333,527.148,785.667,527.148,791.917C527.148,798.167,527.148,802.333,527.148,805.833C527.148,809.333,527.148,812.167,527.148,813.583L527.148,815"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(266.171875, 72)" id="flowchart-App1-21954" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>AI应用1<br>推荐系统</p></span></div></foreignObject></g></g><g transform="translate(440.28125, 72)" id="flowchart-App2-21955" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>AI应用2<br>相似搜索</p></span></div></foreignObject></g></g><g transform="translate(614.390625, 72)" id="flowchart-App3-21956" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>AI应用3<br>语义检索</p></span></div></foreignObject></g></g><g transform="translate(514.82421875, 250)" id="flowchart-LB-21957" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>负载均衡器<br>请求分发</p></span></div></foreignObject></g></g><g transform="translate(221.74609375, 453)" id="flowchart-Coord1-21958" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点1<br>查询路由</p></span></div></foreignObject></g></g><g transform="translate(750.484375, 453)" id="flowchart-Coord2-21959" class="node default"><rect height="78" width="132.515625" y="-39" x="-66.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.2578125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>协调节点2<br>结果聚合</p></span></div></foreignObject></g></g><g transform="translate(130.078125, 643)" id="flowchart-VN1-21960" class="node default"><rect height="102" width="134.15625" y="-51" x="-67.078125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-37.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="74.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量节点1<br>HNSW索引<br>768维向量</p></span></div></foreignObject></g></g><g transform="translate(314.234375, 643)" id="flowchart-VN2-21961" class="node default"><rect height="102" width="134.15625" y="-51" x="-67.078125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-37.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="74.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量节点2<br>HNSW索引<br>768维向量</p></span></div></foreignObject></g></g><g transform="translate(527.1484375, 643)" id="flowchart-VN3-21962" class="node default"><rect height="102" width="134.15625" y="-51" x="-67.078125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-37.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="74.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量节点3<br>HNSW索引<br>768维向量</p></span></div></foreignObject></g></g><g transform="translate(750.484375, 643)" id="flowchart-TN1-21963" class="node default"><rect height="102" width="132.515625" y="-51" x="-66.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.2578125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本节点1<br>倒排索引<br>元数据</p></span></div></foreignObject></g></g><g transform="translate(933, 643)" id="flowchart-TN2-21964" class="node default"><rect height="102" width="132.515625" y="-51" x="-66.2578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.2578125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="72.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本节点2<br>倒排索引<br>元数据</p></span></div></foreignObject></g></g><g transform="translate(130.078125, 858)" id="flowchart-HNSW1-21965" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HNSW图<br>层级导航</p></span></div></foreignObject></g></g><g transform="translate(314.234375, 858)" id="flowchart-HNSW2-21966" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量量化<br>内存优化</p></span></div></foreignObject></g></g><g transform="translate(527.1484375, 858)" id="flowchart-HNSW3-21967" class="node default"><rect height="78" width="201.71875" y="-39" x="-100.859375" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-70.859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="141.71875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>相似度计算<br>cosine/dot_product</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_511"><span class="control" id="qg4rcd_518">高并发向量插入流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-68.5 -10 1311.5 1213" style="max-width: 1311.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Memory" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="1043"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="1118"><tspan dy="0" x="1118">内存缓冲</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="HNSW" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="843"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="918"><tspan dy="0" x="918">HNSW索引</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="VNode" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="642"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="717"><tspan dy="0" x="717">向量节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="441"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="516"><tspan dy="0" x="516">协调节点</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="241"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="316"><tspan dy="0" x="316">负载均衡</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="1127" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1159.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="Memory" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="1118" y1="5" x1="1118" id="actor1303"></line><g id="root-1303"><rect class="actor actor-top" ry="3" rx="3" name="Memory" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1043"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1118"><tspan dy="0" x="1118">内存缓冲</tspan></text></g></g><g><line name="HNSW" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="918" y1="5" x1="918" id="actor1302"></line><g id="root-1302"><rect class="actor actor-top" ry="3" rx="3" name="HNSW" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="843"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="918"><tspan dy="0" x="918">HNSW索引</tspan></text></g></g><g><line name="VNode" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="717" y1="5" x1="717" id="actor1301"></line><g id="root-1301"><rect class="actor actor-top" ry="3" rx="3" name="VNode" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="642"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="717"><tspan dy="0" x="717">向量节点</tspan></text></g></g><g><line name="Coord" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="516" y1="5" x1="516" id="actor1300"></line><g id="root-1300"><rect class="actor actor-top" ry="3" rx="3" name="Coord" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="441"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="516"><tspan dy="0" x="516">协调节点</tspan></text></g></g><g><line name="LB" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="316" y1="5" x1="316" id="actor1299"></line><g id="root-1299"><rect class="actor actor-top" ry="3" rx="3" name="LB" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="241"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="316"><tspan dy="0" x="316">负载均衡</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="1127" x2="75" y1="5" x1="75" id="actor1298"></line><g id="root-1298"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="187" stroke="#666" fill="#EDF2AE" y="75" x="-18.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="75"><tspan x="75">批量向量插入 (1000条)</tspan></text></g><g><line class="loopLine" y2="376" x2="728" y1="376" x1="505"></line><line class="loopLine" y2="565" x2="728" y1="376" x1="728"></line><line class="loopLine" y2="565" x2="728" y1="565" x1="505"></line><line class="loopLine" y2="565" x2="505" y1="376" x1="505"></line><polygon class="labelBox" points="505,376 555,376 555,389 546.6,396 505,396"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="389" x="530">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="394" x="641.5"><tspan x="641.5">[并行写入多个分片]</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="671" x="843"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="676" x="918"><tspan x="918">批量构建图连接</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="1020" x="1043"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1025" x="1118"><tspan x="1118">定期refresh (30s)</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="194">POST /_bulk (向量数据)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="162" x2="312" y1="162" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="177" x="415">路由到协调节点</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="210" x2="512" y1="210" x1="317"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="225" x="517">解析批量请求</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 517,258 C 577,248 577,288 517,278"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="303" x="517">计算向量路由</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 517,336 C 577,326 577,366 517,356"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="426" x="615">分片1: 300个向量</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="459" x2="713" y1="459" x1="517"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="474" x="615">分片2: 350个向量</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="507" x2="713" y1="507" x1="517"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="522" x="615">分片3: 350个向量</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="555" x2="713" y1="555" x1="517"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="580" x="916">写入内存缓冲区</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="613" x2="1114" y1="613" x1="718"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="628" x="816">异步更新HNSW图</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="661" x2="914" y1="661" x1="718"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="725" x="919">计算向量相似度</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 919,758 C 979,748 979,788 919,778"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="803" x="919">更新层级结构</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 919,836 C 979,826 979,866 919,856"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="881" x="618">确认写入完成</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="914" x2="520" y1="914" x1="716"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="929" x="418">返回批量响应</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="962" x2="320" y1="962" x1="515"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="977" x="197">插入成功</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1010" x2="79" y1="1010" x1="315"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="1074" x="1020">持久化到磁盘</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="1107" x2="922" y1="1107" x1="1117"></line></svg><p id="qg4rcd_513"><span class="control" id="qg4rcd_519">HNSW索引结构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 983.03125 928.90625" height="928.90625" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="983.03125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="HNSW多层图结构" class="cluster"><rect height="912.90625" width="632.796875" y="8" x="183.125" style=""></rect><g transform="translate(438.40625, 8)" class="cluster-label"><foreignObject height="24" width="122.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HNSW多层图结构</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph2" class="cluster"><rect height="862.90625" width="281.3984375" y="33" x="203.125" style=""></rect><g transform="translate(285.10546875, 33)" class="cluster-label"><foreignObject height="24" width="117.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Layer 0 (密集层)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="481.53125" width="148.5546875" y="140.84375" x="504.5234375" style=""></rect><g transform="translate(520.08203125, 140.84375)" class="cluster-label"><foreignObject height="24" width="117.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Layer 1 (中间层)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="269.6875" width="125.4375" y="140.84375" x="671.78125" style=""></rect><g transform="translate(675.78125, 140.84375)" class="cluster-label"><foreignObject height="24" width="117.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Layer 2 (稀疏层)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2N1_L2N2_0" d="M724.5,209.266L724.5,215.195C724.5,221.125,724.5,232.984,725.012,241.036C725.524,249.087,726.549,253.33,727.417,256.925C728.285,260.52,728.996,263.467,729.352,264.941L729.707,266.414"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2N2_L2N3_1" d="M738.354,302.229L739.378,306.472C740.403,310.715,742.451,319.201,743.476,325.528C744.5,331.854,744.5,336.021,744.5,339.521C744.5,343.021,744.5,345.854,744.5,347.271L744.5,348.688"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N1_L1N2_2" d="M583.224,207.565L586.296,213.778C589.368,219.991,595.512,232.417,598.584,240.714C601.656,249.01,601.656,253.177,601.656,256.677C601.656,260.177,601.656,263.01,601.656,264.427L601.656,265.844"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N2_L1N3_3" d="M601.656,302.688L601.656,306.854C601.656,311.021,601.656,319.354,600.235,325.81C598.815,332.266,595.973,336.844,593.483,340.856C590.992,344.868,588.854,348.313,587.785,350.036L586.715,351.758"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N3_L1N4_4" d="M584.606,383.062L587.448,387.64C590.289,392.218,595.973,401.375,598.815,410.12C601.656,418.865,601.656,427.198,601.656,433.448C601.656,439.698,601.656,443.865,601.656,447.365C601.656,450.865,601.656,453.698,601.656,455.115L601.656,456.531"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N4_L1N5_5" d="M601.656,493.375L601.656,497.542C601.656,501.708,601.656,510.042,600.12,517.315C598.584,524.588,595.512,530.801,592.736,536.417C589.959,542.033,587.478,547.051,586.237,549.56L584.997,552.069"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N1_L1N3_6" d="M566.649,206.381L562.246,212.791C557.844,219.202,549.039,232.023,544.637,245.337C540.234,258.651,540.234,272.458,540.234,286.266C540.234,300.073,540.234,313.88,542.317,323.199C544.399,332.518,548.564,337.349,552.293,341.675C556.022,346,559.316,349.821,560.964,351.732L562.611,353.642"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N3_L1N5_7" d="M567.285,383.062L564.443,387.64C561.601,392.218,555.918,401.375,553.076,410.12C550.234,418.865,550.234,427.198,550.234,438.268C550.234,449.339,550.234,463.146,550.234,476.953C550.234,490.76,550.234,504.568,551.77,514.578C553.306,524.588,556.379,530.801,559.155,536.417C561.932,542.033,564.413,547.051,565.653,549.56L566.894,552.069"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N1_L0N2_8" d="M297.496,88.374L300.338,92.953C303.18,97.531,308.863,106.687,311.705,115.432C314.547,124.177,314.547,132.51,314.547,139.642C314.547,146.773,314.547,152.703,314.547,157.966C314.547,163.229,314.547,167.826,314.547,170.124L314.547,172.422"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N2_L0N3_9" d="M324.779,205.689L329.977,212.214C335.175,218.74,345.572,231.792,350.77,240.401C355.969,249.01,355.969,253.177,355.969,256.677C355.969,260.177,355.969,263.01,355.969,264.427L355.969,265.844"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N3_L0N4_10" d="M364.629,300.218L367.471,304.796C370.313,309.375,375.996,318.531,378.838,325.193C381.68,331.854,381.68,336.021,381.68,339.521C381.68,343.021,381.68,345.854,381.68,347.271L381.68,348.688"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N4_L0N5_11" d="M394.015,379.95L399.815,385.047C405.614,390.144,417.213,400.338,423.013,409.601C428.813,418.865,428.813,427.198,428.813,433.448C428.813,439.698,428.813,443.865,428.813,447.365C428.813,450.865,428.813,453.698,428.813,455.115L428.813,456.531"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N5_L0N6_12" d="M435.953,491.741L438.096,496.18C440.239,500.619,444.526,509.497,439.32,517.652C434.114,525.807,419.416,533.238,405.313,540.369C391.21,547.5,377.702,554.33,370.948,557.745L364.193,561.16"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N6_L0N7_13" d="M353.247,585.096L356.319,591.309C359.391,597.522,365.536,609.949,368.608,620.328C371.68,630.708,371.68,639.042,373.101,645.497C374.521,651.953,377.363,656.531,379.853,660.543C382.343,664.555,384.482,668,385.551,669.723L386.621,671.446"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N7_L0N8_14" d="M406.051,702.749L408.893,707.328C411.735,711.906,417.418,721.062,420.26,727.724C423.102,734.385,423.102,738.552,423.102,742.052C423.102,745.552,423.102,748.385,423.102,749.802L423.102,751.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N8_L0N9_15" d="M423.102,788.063L423.102,792.229C423.102,796.396,423.102,804.729,421.681,811.185C420.26,817.641,417.418,822.219,414.928,826.231C412.438,830.243,410.299,833.688,409.23,835.411L408.161,837.133"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N1_L0N3_16" d="M276.19,84.898L269.964,90.056C263.739,95.213,251.287,105.529,245.062,114.853C238.836,124.177,238.836,132.51,238.836,145.344C238.836,158.177,238.836,175.51,238.836,192.844C238.836,210.177,238.836,227.51,247.307,239.173C255.778,250.835,272.719,256.826,289.033,262.595C305.346,268.364,321.031,273.91,328.873,276.684L336.715,279.457"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N2_L0N4_17" d="M304.534,205.86L299.536,212.357C294.538,218.855,284.543,231.849,279.545,245.25C274.547,258.651,274.547,272.458,274.547,286.266C274.547,300.073,274.547,313.88,282.198,323.742C289.85,333.604,305.152,339.521,319.833,345.197C334.514,350.873,348.573,356.309,355.602,359.027L362.632,361.745"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N3_L0N5_18" d="M343.8,297.293L338.21,302.358C332.619,307.424,321.438,317.556,315.848,329.525C310.258,341.495,310.258,355.302,310.258,369.109C310.258,382.917,310.258,396.724,310.258,407.794C310.258,418.865,310.258,427.198,318.845,434.365C327.433,441.532,344.608,447.533,361.154,453.314C377.7,459.095,393.617,464.656,401.575,467.437L409.533,470.217"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N4_L0N6_19" d="M370.957,381.547L366.792,386.378C362.627,391.208,354.298,400.87,350.133,409.867C345.969,418.865,345.969,427.198,345.969,438.268C345.969,449.339,345.969,463.146,345.969,476.953C345.969,490.76,345.969,504.568,345.969,514.436C345.969,524.305,345.969,530.234,345.969,535.497C345.969,540.76,345.969,545.357,345.969,547.655L345.969,549.953"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N5_L0N7_20" d="M426.57,493.221L425.992,497.413C425.414,501.606,424.258,509.99,423.68,522.849C423.102,535.708,423.102,553.042,423.102,570.375C423.102,587.708,423.102,605.042,423.102,617.875C423.102,630.708,423.102,639.042,421.681,645.497C420.26,651.953,417.418,656.531,414.928,660.543C412.438,664.555,410.299,668,409.23,669.723L408.161,671.446"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N6_L0N8_21" d="M337.762,584.599L334.13,590.895C330.498,597.191,323.233,609.783,319.601,620.246C315.969,630.708,315.969,639.042,315.969,650.112C315.969,661.182,315.969,674.99,315.969,688.797C315.969,702.604,315.969,716.411,323.62,726.273C331.271,736.135,346.574,742.052,361.255,747.728C375.936,753.404,389.995,758.84,397.024,761.558L404.054,764.276"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N7_L0N9_22" d="M385.222,699.824L379.631,704.89C374.041,709.956,362.86,720.087,357.27,732.057C351.68,744.026,351.68,757.833,351.68,771.641C351.68,785.448,351.68,799.255,354.475,808.692C357.27,818.128,362.86,823.194,367.957,827.812C373.053,832.43,377.655,836.601,379.957,838.686L382.258,840.771"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Query_L2N2_23" d="M850.922,213.967L835.803,219.113C820.685,224.259,790.448,234.551,773.909,241.987C757.369,249.422,754.527,254,752.037,258.012C749.547,262.024,747.409,265.469,746.339,267.192L745.27,268.915"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2N2_L1N3_24" d="M725.84,300.218L722.998,304.796C720.156,309.375,714.473,318.531,701.867,326.154C689.261,333.776,669.734,339.865,650.842,345.756C631.951,351.646,613.696,357.338,604.569,360.184L595.441,363.03"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1N3_L0N5_25" d="M563.776,380.136L558.186,385.202C552.596,390.268,541.415,400.4,535.825,409.632C530.234,418.865,530.234,427.198,523.049,434.299C515.865,441.4,501.495,447.269,487.742,452.886C473.989,458.502,460.854,463.867,454.286,466.549L447.718,469.232"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L0N5_Result_26" d="M418.888,490.037L415.305,494.76C411.722,499.483,404.556,508.929,380.201,517.034C355.846,525.14,314.302,531.905,273.416,538.563C232.53,545.221,192.301,551.772,172.187,555.048L152.073,558.323"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(724.5, 192.84375)" id="flowchart-L2N1-22000" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V1</p></span></div></foreignObject></g></g><g transform="translate(734.5, 286.265625)" id="flowchart-L2N2-22001" class="node default"><circle cy="0" cx="0" r="16.421875" style="fill:#ffeb3b !important" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V5</p></span></div></foreignObject></g></g><g transform="translate(744.5, 369.109375)" id="flowchart-L2N3-22002" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V9</p></span></div></foreignObject></g></g><g transform="translate(575.9453125, 192.84375)" id="flowchart-L1N1-22007" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V1</p></span></div></foreignObject></g></g><g transform="translate(601.65625, 286.265625)" id="flowchart-L1N2-22008" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V3</p></span></div></foreignObject></g></g><g transform="translate(575.9453125, 369.109375)" id="flowchart-L1N3-22009" class="node default"><circle cy="0" cx="0" r="16.421875" style="fill:#ff9800 !important" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V5</p></span></div></foreignObject></g></g><g transform="translate(601.65625, 476.953125)" id="flowchart-L1N4-22010" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V7</p></span></div></foreignObject></g></g><g transform="translate(575.9453125, 570.375)" id="flowchart-L1N5-22011" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V9</p></span></div></foreignObject></g></g><g transform="translate(288.8359375, 74.421875)" id="flowchart-L0N1-22024" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V1</p></span></div></foreignObject></g></g><g transform="translate(314.546875, 192.84375)" id="flowchart-L0N2-22025" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V2</p></span></div></foreignObject></g></g><g transform="translate(355.96875, 286.265625)" id="flowchart-L0N3-22026" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V3</p></span></div></foreignObject></g></g><g transform="translate(381.6796875, 369.109375)" id="flowchart-L0N4-22027" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V4</p></span></div></foreignObject></g></g><g transform="translate(428.8125, 476.953125)" id="flowchart-L0N5-22028" class="node default"><circle cy="0" cx="0" r="16.421875" style="fill:#4caf50 !important" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V5</p></span></div></foreignObject></g></g><g transform="translate(345.96875, 570.375)" id="flowchart-L0N6-22029" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V6</p></span></div></foreignObject></g></g><g transform="translate(397.390625, 688.796875)" id="flowchart-L0N7-22030" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V7</p></span></div></foreignObject></g></g><g transform="translate(423.1015625, 771.640625)" id="flowchart-L0N8-22031" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V8</p></span></div></foreignObject></g></g><g transform="translate(397.390625, 854.484375)" id="flowchart-L0N9-22032" class="node default"><circle cy="0" cx="0" r="16.421875" style="" class="basic label-container"></circle><g transform="translate(-8.921875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="17.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>V9</p></span></div></foreignObject></g></g><g transform="translate(912.9765625, 192.84375)" id="flowchart-Query-22063" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询向量</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 570.375)" id="flowchart-Result-22070" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>最近邻结果</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="3" data-toc="3">3. 向量检索性能优化</h3><p id="qg4rcd_520"><span class="control" id="qg4rcd_525">Q11: 如何针对不同的AI应用场景优化向量检索性能？</span></p><p id="qg4rcd_521"><span class="control" id="qg4rcd_526">标准回答:</span></p><div class="code-block" data-lang="none">
不同AI应用场景需要不同的优化策略：

1. 实时推荐系统优化：
   - 低延迟要求：ef_search设置较小值(10-50)
   - 使用预计算：热门物品向量预加载到内存
   - 缓存策略：用户画像向量缓存
   - 分层检索：粗排+精排两阶段

2. 语义搜索优化：
   - 高精度要求：ef_search设置较大值(100-500)
   - 混合搜索：向量+文本权重调优
   - 查询扩展：同义词和相关词扩展
   - 结果重排：基于业务规则的后处理

3. 图像相似搜索优化：
   - 高维向量：使用PCA降维或量化
   - 批量查询：支持多图片同时搜索
   - 特征提取：优化CNN模型推理
   - 存储优化：图片元数据分离存储

4. 文档检索优化：
   - 分块策略：长文档切分为段落
   - 层次检索：文档级+段落级搜索
   - 上下文保持：相关段落聚合
   - 权重调整：标题、正文权重差异化

性能监控指标：
- QPS (每秒查询数)
- 延迟分布 (P50, P95, P99)
- 召回率和精确率
- 内存使用率
- CPU使用率
- 磁盘I/O

优化工具和方法：
- 性能基准测试：rally工具
- 查询分析：_profile API
- 监控告警：Kibana仪表板
- A/B测试：不同参数对比
</div><p id="qg4rcd_523"><span class="control" id="qg4rcd_527">AI应用场景优化对比图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 839.375 502"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="839.375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M372.707,45.443L326.926,52.369C281.146,59.295,189.585,73.148,143.804,82.157C98.023,91.167,98.023,95.333,98.023,98.833C98.023,102.333,98.023,105.167,98.023,106.583L98.023,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M387.083,62L378.65,66.167C370.217,70.333,353.351,78.667,344.918,84.917C336.484,91.167,336.484,95.333,336.484,98.833C336.484,102.333,336.484,105.167,336.484,106.583L336.484,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M496.377,62L504.811,66.167C513.244,70.333,530.11,78.667,538.543,84.917C546.977,91.167,546.977,95.333,546.977,98.833C546.977,102.333,546.977,105.167,546.977,106.583L546.977,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M510.754,46.522L551.169,53.268C591.583,60.015,672.413,73.507,712.827,82.337C753.242,91.167,753.242,95.333,753.242,98.833C753.242,102.333,753.242,105.167,753.242,106.583L753.242,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_4" d="M98.023,166L98.023,170.167C98.023,174.333,98.023,182.667,98.023,188.917C98.023,195.167,98.023,199.333,98.023,202.833C98.023,206.333,98.023,209.167,98.023,210.583L98.023,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_5" d="M336.484,166L336.484,170.167C336.484,174.333,336.484,182.667,336.484,188.917C336.484,195.167,336.484,199.333,336.484,202.833C336.484,206.333,336.484,209.167,336.484,210.583L336.484,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_6" d="M546.977,166L546.977,170.167C546.977,174.333,546.977,182.667,546.977,188.917C546.977,195.167,546.977,199.333,546.977,202.833C546.977,206.333,546.977,209.167,546.977,210.583L546.977,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_7" d="M753.242,166L753.242,170.167C753.242,174.333,753.242,182.667,753.242,188.917C753.242,195.167,753.242,199.333,753.242,202.833C753.242,206.333,753.242,209.167,753.242,210.583L753.242,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B2_8" d="M98.023,342L98.023,346.167C98.023,350.333,98.023,358.667,98.023,364.917C98.023,371.167,98.023,375.333,98.023,378.833C98.023,382.333,98.023,385.167,98.023,386.583L98.023,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_C2_9" d="M336.484,342L336.484,346.167C336.484,350.333,336.484,358.667,336.484,364.917C336.484,371.167,336.484,375.333,336.484,378.833C336.484,382.333,336.484,385.167,336.484,386.583L336.484,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D1_D2_10" d="M546.977,342L546.977,346.167C546.977,350.333,546.977,358.667,546.977,364.917C546.977,371.167,546.977,375.333,546.977,378.833C546.977,382.333,546.977,385.167,546.977,386.583L546.977,388"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E1_E2_11" d="M753.242,342L753.242,346.167C753.242,350.333,753.242,358.667,753.242,364.917C753.242,371.167,753.242,375.333,753.242,378.833C753.242,382.333,753.242,385.167,753.242,386.583L753.242,388"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(441.73046875, 35)" id="flowchart-A-22076" class="node default"><rect height="54" width="138.046875" y="-27" x="-69.0234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-39.0234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="78.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>AI应用场景</p></span></div></foreignObject></g></g><g transform="translate(98.0234375, 139)" id="flowchart-B-22077" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实时推荐</p></span></div></foreignObject></g></g><g transform="translate(336.484375, 139)" id="flowchart-C-22079" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>语义搜索</p></span></div></foreignObject></g></g><g transform="translate(546.9765625, 139)" id="flowchart-D-22081" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>图像检索</p></span></div></foreignObject></g></g><g transform="translate(753.2421875, 139)" id="flowchart-E-22083" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文档检索</p></span></div></foreignObject></g></g><g transform="translate(98.0234375, 279)" id="flowchart-B1-22085" class="node default"><rect height="126" width="180.046875" y="-63" x="-90.0234375" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-60.0234375, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="120.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>低延迟优先<br>ef_search: 10-50<br>缓存热门向量<br>分层检索</p></span></div></foreignObject></g></g><g transform="translate(336.484375, 279)" id="flowchart-C1-22087" class="node default"><rect height="126" width="196.875" y="-63" x="-98.4375" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-68.4375, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="136.875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高精度优先<br>ef_search: 100-500<br>混合搜索<br>查询扩展</p></span></div></foreignObject></g></g><g transform="translate(546.9765625, 279)" id="flowchart-D1-22089" class="node default"><rect height="126" width="124.109375" y="-63" x="-62.0546875" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高维处理<br>PCA降维<br>向量量化<br>批量查询</p></span></div></foreignObject></g></g><g transform="translate(753.2421875, 279)" id="flowchart-E1-22091" class="node default"><rect height="126" width="140.125" y="-63" x="-70.0625" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-40.0625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>上下文保持<br>文档分块<br>层次检索<br>权重调整</p></span></div></foreignObject></g></g><g transform="translate(98.0234375, 443)" id="flowchart-B2-22093" class="node default"><rect height="102" width="153.6875" y="-51" x="-76.84375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.84375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="93.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>延迟: &lt;50ms<br>QPS: &gt;1000<br>召回率: 80%+</p></span></div></foreignObject></g></g><g transform="translate(336.484375, 443)" id="flowchart-C2-22095" class="node default"><rect height="102" width="156.265625" y="-51" x="-78.1328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.1328125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>延迟: &lt;200ms<br>QPS: &gt;100<br>召回率: 95%+</p></span></div></foreignObject></g></g><g transform="translate(546.9765625, 443)" id="flowchart-D2-22097" class="node default"><rect height="102" width="156.265625" y="-51" x="-78.1328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.1328125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>延迟: &lt;100ms<br>QPS: &gt;500<br>召回率: 90%+</p></span></div></foreignObject></g></g><g transform="translate(753.2421875, 443)" id="flowchart-E2-22099" class="node default"><rect height="102" width="156.265625" y="-51" x="-78.1328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.1328125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>延迟: &lt;300ms<br>QPS: &gt;50<br>召回率: 98%+</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="4" data-toc="4">4. 混合搜索与重排序</h3><p id="qg4rcd_528"><span class="control" id="qg4rcd_533">Q12: 如何实现向量搜索与传统文本搜索的有效结合？</span></p><p id="qg4rcd_529"><span class="control" id="qg4rcd_534">标准回答:</span></p><div class="code-block" data-lang="none">
混合搜索是现代搜索系统的核心，需要平衡语义相似性和关键词匹配：

1. 混合搜索策略：
   - 并行搜索：同时执行向量搜索和文本搜索
   - 结果融合：使用RRF (Reciprocal Rank Fusion)算法
   - 权重调优：根据业务场景调整向量和文本权重
   - 阈值过滤：设置最低相似度阈值

2. 重排序算法：
   - Learning to Rank：机器学习排序模型
   - 业务规则：价格、时间、热度等因子
   - 个性化：用户历史行为权重
   - 多样性：避免结果过于相似

3. 查询理解：
   - 意图识别：判断查询类型（导航、信息、交易）
   - 实体识别：提取关键实体和属性
   - 查询扩展：同义词、相关词补充
   - 拼写纠错：模糊匹配和建议

4. 实时优化：
   - A/B测试：不同策略效果对比
   - 点击反馈：用户行为数据收集
   - 模型更新：定期重训练排序模型
   - 参数调优：动态调整权重参数

实现示例：
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;should&quot;: [
        {
          &quot;knn&quot;: {
            &quot;field&quot;: &quot;content_vector&quot;,
            &quot;query_vector&quot;: [...],
            &quot;k&quot;: 50,
            &quot;boost&quot;: 0.7
          }
        },
        {
          &quot;multi_match&quot;: {
            &quot;query&quot;: &quot;elasticsearch vector search&quot;,
            &quot;fields&quot;: [&quot;title^2&quot;, &quot;content&quot;],
            &quot;boost&quot;: 0.3
          }
        }
      ]
    }
  },
  &quot;rescore&quot;: {
    &quot;query&quot;: {
      &quot;function_score&quot;: {
        &quot;functions&quot;: [
          {
            &quot;field_value_factor&quot;: {
              &quot;field&quot;: &quot;popularity&quot;,
              &quot;factor&quot;: 0.1
            }
          }
        ]
      }
    }
  }
}
</div><p id="qg4rcd_531"><span class="control" id="qg4rcd_535">混合搜索架构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1105.6953125 1208"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1105.6953125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="重排序因子" class="cluster"><rect height="208" width="922.578125" y="784" x="8" style=""></rect><g transform="translate(429.2265625, 784)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>重排序因子</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Query_QP_0" d="M572.359,62L572.359,66.167C572.359,70.333,572.359,78.667,572.359,84.917C572.359,91.167,572.359,95.333,572.359,98.833C572.359,102.333,572.359,105.167,572.359,106.583L572.359,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_QP_QU_1" d="M572.359,166L572.359,170.167C572.359,174.333,572.359,182.667,572.359,188.917C572.359,195.167,572.359,199.333,572.359,202.833C572.359,206.333,572.359,209.167,572.359,210.583L572.359,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_QU_VE_2" d="M525.079,270L517.783,274.167C510.486,278.333,495.894,286.667,488.597,292.917C481.301,299.167,481.301,303.333,481.301,306.833C481.301,310.333,481.301,313.167,481.301,314.583L481.301,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_QU_TE_3" d="M619.64,270L626.936,274.167C634.233,278.333,648.825,286.667,656.122,292.917C663.418,299.167,663.418,303.333,663.418,306.833C663.418,310.333,663.418,313.167,663.418,314.583L663.418,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VE_VS_4" d="M481.301,374L481.301,378.167C481.301,382.333,481.301,390.667,481.301,396.917C481.301,403.167,481.301,407.333,481.301,410.833C481.301,414.333,481.301,417.167,481.301,418.583L481.301,420"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TE_TS_5" d="M663.418,374L663.418,378.167C663.418,382.333,663.418,390.667,663.418,396.917C663.418,403.167,663.418,407.333,663.418,410.833C663.418,414.333,663.418,417.167,663.418,418.583L663.418,420"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VS_VR_6" d="M481.301,478L481.301,482.167C481.301,486.333,481.301,494.667,481.301,500.917C481.301,507.167,481.301,511.333,481.301,514.833C481.301,518.333,481.301,521.167,481.301,522.583L481.301,524"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TS_TR_7" d="M663.418,478L663.418,482.167C663.418,486.333,663.418,494.667,663.418,500.917C663.418,507.167,663.418,511.333,663.418,514.833C663.418,518.333,663.418,521.167,663.418,522.583L663.418,524"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_VR_RF_8" d="M481.301,606L481.301,610.167C481.301,614.333,481.301,622.667,484.265,628.917C487.229,635.167,493.157,639.333,498.54,643.117C503.923,646.9,508.761,650.3,511.179,652L513.598,653.7"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TR_RF_9" d="M663.418,606L663.418,610.167C663.418,614.333,663.418,622.667,660.454,628.917C657.49,635.167,651.561,639.333,646.179,643.117C640.796,646.9,635.958,650.3,633.539,652L631.121,653.7"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RF_RS_10" d="M572.359,734L572.359,738.167C572.359,742.333,572.359,750.667,572.359,759C572.359,767.333,572.359,775.667,572.359,781.917C572.359,788.167,572.359,792.333,572.359,795.833C572.359,799.333,572.359,802.167,572.359,803.583L572.359,805"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_BF_11" d="M626.398,845.074L669.007,852.228C711.616,859.382,796.833,873.691,846.403,883.332C895.972,892.972,909.893,897.945,923.187,902.693C936.48,907.441,949.146,911.965,955.478,914.227L961.811,916.489"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_BF_PR_12" d="M1027.633,967L1027.633,971.167C1027.633,975.333,1027.633,983.667,1027.633,992C1027.633,1000.333,1027.633,1008.667,1027.633,1014.917C1027.633,1021.167,1027.633,1025.333,1027.633,1028.833C1027.633,1032.333,1027.633,1035.167,1027.633,1036.583L1027.633,1038"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_PR_FR_13" d="M1027.633,1096L1027.633,1100.167C1027.633,1104.333,1027.633,1112.667,1027.633,1118.917C1027.633,1125.167,1027.633,1129.333,1027.633,1132.833C1027.633,1136.333,1027.633,1139.167,1027.633,1140.583L1027.633,1142"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_RS1_14" d="M518.32,842.118L450.777,849.765C383.234,857.412,248.148,872.706,180.605,882.436C113.063,892.167,113.063,896.333,113.063,899.833C113.063,903.333,113.063,906.167,113.063,907.583L113.063,909"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_RS2_15" d="M518.32,846.44L482.465,853.366C446.609,860.293,374.898,874.147,339.043,883.157C303.188,892.167,303.188,896.333,303.188,899.833C303.188,903.333,303.188,906.167,303.188,907.583L303.188,909"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_RS3_16" d="M527.158,863L520.182,867.167C513.207,871.333,499.256,879.667,492.28,885.917C485.305,892.167,485.305,896.333,485.305,899.833C485.305,903.333,485.305,906.167,485.305,907.583L485.305,909"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_RS4_17" d="M617.561,863L624.536,867.167C631.512,871.333,645.463,879.667,652.439,885.917C659.414,892.167,659.414,896.333,659.414,899.833C659.414,903.333,659.414,906.167,659.414,907.583L659.414,909"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RS_RS5_18" d="M626.398,846.76L660.919,853.633C695.44,860.506,764.482,874.253,799.003,883.21C833.523,892.167,833.523,896.333,833.523,899.833C833.523,903.333,833.523,906.167,833.523,907.583L833.523,909"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(572.359375, 35)" id="flowchart-Query-22104" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>用户查询</p></span></div></foreignObject></g></g><g transform="translate(572.359375, 139)" id="flowchart-QP-22105" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询处理</p></span></div></foreignObject></g></g><g transform="translate(572.359375, 243)" id="flowchart-QU-22107" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询理解</p></span></div></foreignObject></g></g><g transform="translate(481.30078125, 347)" id="flowchart-VE-22109" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量编码</p></span></div></foreignObject></g></g><g transform="translate(663.41796875, 347)" id="flowchart-TE-22111" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本分析</p></span></div></foreignObject></g></g><g transform="translate(481.30078125, 451)" id="flowchart-VS-22113" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量搜索</p></span></div></foreignObject></g></g><g transform="translate(663.41796875, 451)" id="flowchart-TS-22115" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本搜索</p></span></div></foreignObject></g></g><g transform="translate(481.30078125, 567)" id="flowchart-VR-22117" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量结果<br>语义相似</p></span></div></foreignObject></g></g><g transform="translate(663.41796875, 567)" id="flowchart-TR-22119" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本结果<br>关键词匹配</p></span></div></foreignObject></g></g><g transform="translate(572.359375, 695)" id="flowchart-RF-22121" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>结果融合<br>RRF算法</p></span></div></foreignObject></g></g><g transform="translate(572.359375, 836)" id="flowchart-RS-22125" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>重排序</p></span></div></foreignObject></g></g><g transform="translate(1027.6328125, 940)" id="flowchart-BF-22127" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>业务过滤</p></span></div></foreignObject></g></g><g transform="translate(1027.6328125, 1069)" id="flowchart-PR-22129" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>个性化排序</p></span></div></foreignObject></g></g><g transform="translate(1027.6328125, 1173)" id="flowchart-FR-22131" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>最终结果</p></span></div></foreignObject></g></g><g transform="translate(113.0625, 940)" id="flowchart-RS1-22133" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>相似度分数</p></span></div></foreignObject></g></g><g transform="translate(303.1875, 940)" id="flowchart-RS2-22135" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>文本匹配度</p></span></div></foreignObject></g></g><g transform="translate(485.3046875, 940)" id="flowchart-RS3-22137" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>业务权重</p></span></div></foreignObject></g></g><g transform="translate(659.4140625, 940)" id="flowchart-RS4-22139" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>用户偏好</p></span></div></foreignObject></g></g><g transform="translate(833.5234375, 940)" id="flowchart-RS5-22141" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>时间因子</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="5" data-toc="5">5. 向量数据管理</h3><p id="qg4rcd_536"><span class="control" id="qg4rcd_541">Q13: 在大规模向量数据场景下，如何进行有效的数据管理和维护？</span></p><p id="qg4rcd_537"><span class="control" id="qg4rcd_542">标准回答:</span></p><div class="code-block" data-lang="none">
大规模向量数据管理需要考虑存储、更新、备份等多个方面：

1. 数据分层存储：
   - 热数据：高频访问向量存储在SSD
   - 温数据：中频访问向量存储在SATA
   - 冷数据：低频访问向量存储在对象存储
   - 归档数据：历史向量数据压缩存储

2. 增量更新策略：
   - 实时更新：新向量立即索引
   - 批量更新：定期批量重建索引
   - 版本控制：向量版本管理
   - 回滚机制：支持数据回滚

3. 数据一致性：
   - 主从同步：确保副本数据一致
   - 事务支持：向量和元数据原子更新
   - 冲突解决：并发更新冲突处理
   - 数据校验：定期数据完整性检查

4. 备份与恢复：
   - 快照备份：定期创建索引快照
   - 增量备份：只备份变更数据
   - 跨区域备份：多地域数据备份
   - 灾难恢复：快速恢复机制

5. 监控与告警：
   - 存储使用率：磁盘空间监控
   - 查询性能：延迟和吞吐量监控
   - 错误率：失败请求监控
   - 资源使用：CPU、内存、网络监控

6. 数据治理：
   - 数据质量：向量质量评估
   - 数据血缘：向量来源追踪
   - 权限控制：访问权限管理
   - 合规性：数据合规检查

运维最佳实践：
- 定期索引优化：force_merge操作
- 分片重平衡：均匀分布数据
- 容量规划：预估存储需求
- 性能调优：参数持续优化
</div><p id="qg4rcd_539"><span class="control" id="qg4rcd_543">向量数据生命周期管理图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 568.4375 2142.21875" height="2142.21875" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="568.4375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M276.203,62L276.203,66.167C276.203,70.333,276.203,78.667,276.203,84.917C276.203,91.167,276.203,95.333,276.203,98.833C276.203,102.333,276.203,105.167,276.203,106.583L276.203,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M276.203,166L276.203,170.167C276.203,174.333,276.203,182.667,276.203,188.917C276.203,195.167,276.203,199.333,276.203,202.833C276.203,206.333,276.203,209.167,276.203,210.583L276.203,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M276.203,270L276.203,274.167C276.203,278.333,276.203,286.667,276.203,292.917C276.203,299.167,276.203,303.333,276.203,306.833C276.203,310.333,276.203,313.167,276.203,314.583L276.203,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M276.203,374L276.203,378.167C276.203,382.333,276.203,390.667,276.203,396.917C276.203,403.167,276.203,407.333,276.203,410.833C276.203,414.333,276.203,417.167,276.203,418.583L276.203,420"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M276.203,478L276.203,482.167C276.203,486.333,276.203,494.667,276.245,500.958C276.286,507.25,276.37,511.5,276.44,515.083C276.51,518.667,276.568,521.584,276.596,523.042L276.625,524.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_5" d="M236.93,606.836L210.452,619.548C183.974,632.26,131.018,657.685,104.54,673.48C78.063,689.276,78.063,695.443,78.063,700.943C78.063,706.443,78.063,711.276,78.063,713.693L78.063,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_H_6" d="M276.703,646.609L276.62,652.693C276.536,658.776,276.37,670.943,276.286,680.109C276.203,689.276,276.203,695.443,276.203,700.943C276.203,706.443,276.203,711.276,276.203,713.693L276.203,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_I_7" d="M316.988,606.325L344.55,619.122C372.112,631.92,427.236,657.514,454.797,673.395C482.359,689.276,482.359,695.443,482.359,700.943C482.359,706.443,482.359,711.276,482.359,713.693L482.359,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_J_8" d="M78.063,774.109L78.063,778.276C78.063,782.443,78.063,790.776,78.063,797.026C78.063,803.276,78.063,807.443,78.063,810.943C78.063,814.443,78.063,817.276,78.063,818.693L78.063,820.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_K_9" d="M276.203,774.109L276.203,778.276C276.203,782.443,276.203,790.776,276.203,797.026C276.203,803.276,276.203,807.443,276.203,810.943C276.203,814.443,276.203,817.276,276.203,818.693L276.203,820.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_L_10" d="M482.359,774.109L482.359,778.276C482.359,782.443,482.359,790.776,482.359,797.026C482.359,803.276,482.359,807.443,482.359,810.943C482.359,814.443,482.359,817.276,482.359,818.693L482.359,820.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_M_11" d="M78.063,878.109L78.063,882.276C78.063,886.443,78.063,894.776,89.403,901.919C100.743,909.062,123.424,915.014,145.461,920.797C167.497,926.581,188.888,932.194,199.584,935.001L210.279,937.808"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_M_12" d="M276.203,878.109L276.203,882.276C276.203,886.443,276.203,894.776,276.203,901.026C276.203,907.276,276.203,911.443,276.203,914.943C276.203,918.443,276.203,921.276,276.203,922.693L276.203,924.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_M_13" d="M482.359,878.109L482.359,882.276C482.359,886.443,482.359,894.776,470.351,901.972C458.342,909.167,434.326,915.225,410.955,921.12C387.585,927.015,364.86,932.747,353.498,935.613L342.136,938.479"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M_N_14" d="M276.203,982.109L276.203,986.276C276.203,990.443,276.203,998.776,276.245,1005.068C276.286,1011.359,276.37,1015.609,276.44,1019.193C276.51,1022.776,276.568,1025.693,276.596,1027.152L276.625,1028.61"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_O_15" d="M256.882,1130.898L252.014,1140.285C247.147,1149.671,237.411,1168.445,232.543,1188.499C227.676,1208.552,227.676,1229.885,227.676,1249.219C227.676,1268.552,227.676,1285.885,227.676,1303.219C227.676,1320.552,227.676,1337.885,227.676,1357.219C227.676,1376.552,227.676,1397.885,227.676,1419.219C227.676,1440.552,227.676,1461.885,227.676,1481.219C227.676,1500.552,227.676,1517.885,227.676,1535.219C227.676,1552.552,227.676,1569.885,227.676,1587.219C227.676,1604.552,227.676,1621.885,229.62,1632.635C231.564,1643.385,235.453,1647.552,238.886,1651.231C242.32,1654.911,245.298,1658.102,246.788,1659.698L248.277,1661.294"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_P_16" d="M296.524,1130.898L301.225,1140.285C305.926,1149.671,315.328,1168.445,320.029,1180.915C324.73,1193.385,324.73,1199.552,324.73,1205.052C324.73,1210.552,324.73,1215.385,324.73,1217.802L324.73,1220.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P_Q_17" d="M324.73,1278.219L324.73,1282.385C324.73,1286.552,324.73,1294.885,324.73,1301.135C324.73,1307.385,324.73,1311.552,324.73,1315.052C324.73,1318.552,324.73,1321.385,324.73,1322.802L324.73,1324.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Q_R_18" d="M324.73,1382.219L324.73,1388.385C324.73,1394.552,324.73,1406.885,324.73,1416.135C324.73,1425.385,324.73,1431.552,324.73,1437.052C324.73,1442.552,324.73,1447.385,324.73,1449.802L324.73,1452.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_R_S_19" d="M324.73,1510.219L324.73,1514.385C324.73,1518.552,324.73,1526.885,324.73,1533.135C324.73,1539.385,324.73,1543.552,324.73,1547.052C324.73,1550.552,324.73,1553.385,324.73,1554.802L324.73,1556.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_S_O_20" d="M324.73,1614.219L324.73,1618.385C324.73,1622.552,324.73,1630.885,322.786,1637.135C320.842,1643.385,316.954,1647.552,313.52,1651.231C310.087,1654.911,307.108,1658.102,305.618,1659.698L304.129,1661.294"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_O_T_21" d="M276.203,1718.219L276.203,1722.385C276.203,1726.552,276.203,1734.885,276.203,1741.135C276.203,1747.385,276.203,1751.552,276.203,1755.052C276.203,1758.552,276.203,1761.385,276.203,1762.802L276.203,1764.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T_U_22" d="M276.203,1822.219L276.203,1826.385C276.203,1830.552,276.203,1838.885,276.203,1845.135C276.203,1851.385,276.203,1855.552,276.203,1859.052C276.203,1862.552,276.203,1865.385,276.203,1866.802L276.203,1868.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_U_V_23" d="M276.203,1926.219L276.203,1930.385C276.203,1934.552,276.203,1942.885,276.203,1949.135C276.203,1955.385,276.203,1959.552,276.203,1963.052C276.203,1966.552,276.203,1969.385,276.203,1970.802L276.203,1972.219"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_V_W_24" d="M276.203,2030.219L276.203,2034.385C276.203,2038.552,276.203,2046.885,276.203,2053.135C276.203,2059.385,276.203,2063.552,276.203,2067.052C276.203,2070.552,276.203,2073.385,276.203,2074.802L276.203,2076.219"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(78.0625, 683.109375)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>高频</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 683.109375)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>中频</p></span></div></foreignObject></g></g><g transform="translate(482.359375, 683.109375)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>低频</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(227.67578125, 1419.21875)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>正常</p></span></div></foreignObject></g></g><g transform="translate(324.73046875, 1187.21875)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>异常</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(276.203125, 35)" id="flowchart-A-22146" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量数据生成</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 139)" id="flowchart-B-22147" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据验证</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 243)" id="flowchart-C-22149" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量编码</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 347)" id="flowchart-D-22151" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>索引构建</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 451)" id="flowchart-E-22153" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>热数据存储</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 587.0546875)" id="flowchart-F-22155" class="node default"><polygon transform="translate(-59.0546875,59.0546875)" class="label-container" points="59.0546875,0 118.109375,-59.0546875 59.0546875,-118.109375 0,-59.0546875"></polygon><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>访问频率</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 747.109375)" id="flowchart-G-22157" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>保持热存储</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 747.109375)" id="flowchart-H-22159" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>迁移到温存储</p></span></div></foreignObject></g></g><g transform="translate(482.359375, 747.109375)" id="flowchart-I-22161" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>迁移到冷存储</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 851.109375)" id="flowchart-J-22163" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实时更新</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 851.109375)" id="flowchart-K-22165" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>批量更新</p></span></div></foreignObject></g></g><g transform="translate(482.359375, 851.109375)" id="flowchart-L-22167" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>归档压缩</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 955.109375)" id="flowchart-M-22169" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能监控</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 1091.1640625)" id="flowchart-N-22175" class="node default"><polygon transform="translate(-59.0546875,59.0546875)" class="label-container" points="59.0546875,0 118.109375,-59.0546875 59.0546875,-118.109375 0,-59.0546875"></polygon><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能指标</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 1691.21875)" id="flowchart-O-22177" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>继续服务</p></span></div></foreignObject></g></g><g transform="translate(324.73046875, 1251.21875)" id="flowchart-P-22179" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>告警处理</p></span></div></foreignObject></g></g><g transform="translate(324.73046875, 1355.21875)" id="flowchart-Q-22181" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>问题诊断</p></span></div></foreignObject></g></g><g transform="translate(324.73046875, 1483.21875)" id="flowchart-R-22183" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>优化调整</p></span></div></foreignObject></g></g><g transform="translate(324.73046875, 1587.21875)" id="flowchart-S-22185" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>重新部署</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 1795.21875)" id="flowchart-T-22189" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>定期备份</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 1899.21875)" id="flowchart-U-22191" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据校验</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 2003.21875)" id="flowchart-V-22193" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>合规检查</p></span></div></foreignObject></g></g><g transform="translate(276.203125, 2107.21875)" id="flowchart-W-22195" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>生命周期结束</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="6" data-toc="6">6. 面试重点问题</h3><p id="qg4rcd_544"><span class="control" id="qg4rcd_553">技术深度问题：</span></p><ol class="list _decimal" id="qg4rcd_545" type="1"><li class="list__item" id="qg4rcd_554"><p id="qg4rcd_558"><span class="control" id="qg4rcd_559">HNSW算法的工作原理是什么？如何调优参数？</span></p></li><li class="list__item" id="qg4rcd_555"><p id="qg4rcd_560"><span class="control" id="qg4rcd_561">向量量化技术有哪些？如何选择合适的量化方法？</span></p></li><li class="list__item" id="qg4rcd_556"><p id="qg4rcd_562"><span class="control" id="qg4rcd_563">如何处理向量维度灾难问题？</span></p></li><li class="list__item" id="qg4rcd_557"><p id="qg4rcd_564"><span class="control" id="qg4rcd_565">大规模向量数据的分片策略是什么？</span></p></li></ol><p id="qg4rcd_546"><span class="control" id="qg4rcd_566">性能优化问题：</span></p><ol class="list _decimal" id="qg4rcd_547" type="1"><li class="list__item" id="qg4rcd_567"><p id="qg4rcd_571"><span class="control" id="qg4rcd_572">如何优化高维向量的插入性能？</span></p></li><li class="list__item" id="qg4rcd_568"><p id="qg4rcd_573"><span class="control" id="qg4rcd_574">向量搜索的内存使用如何优化？</span></p></li><li class="list__item" id="qg4rcd_569"><p id="qg4rcd_575"><span class="control" id="qg4rcd_576">如何实现向量搜索的水平扩展？</span></p></li><li class="list__item" id="qg4rcd_570"><p id="qg4rcd_577"><span class="control" id="qg4rcd_578">混合搜索的权重如何调优？</span></p></li></ol><p id="qg4rcd_548"><span class="control" id="qg4rcd_579">架构设计问题：</span></p><ol class="list _decimal" id="qg4rcd_549" type="1"><li class="list__item" id="qg4rcd_580"><p id="qg4rcd_584"><span class="control" id="qg4rcd_585">如何设计一个支持亿级向量的搜索系统？</span></p></li><li class="list__item" id="qg4rcd_581"><p id="qg4rcd_586"><span class="control" id="qg4rcd_587">向量数据的冷热分离如何实现？</span></p></li><li class="list__item" id="qg4rcd_582"><p id="qg4rcd_588"><span class="control" id="qg4rcd_589">如何保证向量搜索的高可用性？</span></p></li><li class="list__item" id="qg4rcd_583"><p id="qg4rcd_590"><span class="control" id="qg4rcd_591">向量索引的增量更新如何设计？</span></p></li></ol><p id="qg4rcd_550"><span class="control" id="qg4rcd_592">实际应用问题：</span></p><ol class="list _decimal" id="qg4rcd_551" type="1"><li class="list__item" id="qg4rcd_593"><p id="qg4rcd_597"><span class="control" id="qg4rcd_598">推荐系统中的向量检索如何优化？</span></p></li><li class="list__item" id="qg4rcd_594"><p id="qg4rcd_599"><span class="control" id="qg4rcd_600">多模态搜索如何实现？</span></p></li><li class="list__item" id="qg4rcd_595"><p id="qg4rcd_601"><span class="control" id="qg4rcd_602">向量搜索的A/B测试如何设计？</span></p></li><li class="list__item" id="qg4rcd_596"><p id="qg4rcd_603"><span class="control" id="qg4rcd_604">如何评估向量搜索的效果？</span></p></li></ol></section><section class="chapter"><h3 id="1" data-toc="1">1. 机器学习</h3><div class="code-block" data-lang="json">
{
  &quot;job_id&quot;: &quot;anomaly-detection&quot;,
  &quot;analysis_config&quot;: {
    &quot;bucket_span&quot;: &quot;15m&quot;,
    &quot;detectors&quot;: [
      {
        &quot;function&quot;: &quot;mean&quot;,
        &quot;field_name&quot;: &quot;response_time&quot;
      }
    ]
  }
}
</div></section><section class="chapter"><h3 id="2" data-toc="2">2. 图分析</h3><div class="code-block" data-lang="json">
{
  &quot;query&quot;: {&quot;match&quot;: {&quot;title&quot;: &quot;elasticsearch&quot;}},
  &quot;vertices&quot;: [
    {
      &quot;field&quot;: &quot;user&quot;,
      &quot;size&quot;: 10
    }
  ],
  &quot;connections&quot;: {
    &quot;vertices&quot;: [
      {
        &quot;field&quot;: &quot;tag&quot;,
        &quot;size&quot;: 5
      }
    ]
  }
}
</div></section><section class="chapter"><h3 id="3-sql" data-toc="3-sql">3. SQL支持</h3><div class="code-block" data-lang="sql">
SELECT title, price 
FROM products 
WHERE category = 'electronics' 
AND price &gt; 100
ORDER BY price DESC
LIMIT 10;
</div><p id="qg4rcd_608"><span class="control" id="qg4rcd_611">考察重点:</span></p><ul class="list _bullet" id="qg4rcd_609"><li class="list__item" id="qg4rcd_612"><p id="qg4rcd_616">异常检测算法</p></li><li class="list__item" id="qg4rcd_613"><p id="qg4rcd_617">图数据库功能</p></li><li class="list__item" id="qg4rcd_614"><p id="qg4rcd_618">SQL转DSL的实现</p></li><li class="list__item" id="qg4rcd_615"><p id="qg4rcd_619">跨集群搜索（CCS）</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_14" data-toc="qg4rcd_14">面试常见问题</h2><section class="chapter"><h3 id="qg4rcd_620" data-toc="qg4rcd_620">技术深度问题</h3><ol class="list _decimal" id="qg4rcd_624" type="1"><li class="list__item" id="qg4rcd_625"><p id="qg4rcd_630"><span class="control" id="qg4rcd_631">Elasticsearch的写入流程是怎样的？</span></p></li><li class="list__item" id="qg4rcd_626"><p id="qg4rcd_632"><span class="control" id="qg4rcd_633">如何解决深分页问题？</span></p></li><li class="list__item" id="qg4rcd_627"><p id="qg4rcd_634"><span class="control" id="qg4rcd_635">倒排索引的存储结构是什么？</span></p></li><li class="list__item" id="qg4rcd_628"><p id="qg4rcd_636"><span class="control" id="qg4rcd_637">如何处理索引mapping变更？</span></p></li><li class="list__item" id="qg4rcd_629"><p id="qg4rcd_638"><span class="control" id="qg4rcd_639">集群脑裂问题如何解决？</span></p></li></ol></section><section class="chapter"><h3 id="qg4rcd_621" data-toc="qg4rcd_621">性能优化问题</h3><ol class="list _decimal" id="qg4rcd_640" type="1"><li class="list__item" id="qg4rcd_641"><p id="qg4rcd_645"><span class="control" id="qg4rcd_646">如何优化Elasticsearch的查询性能？</span></p></li><li class="list__item" id="qg4rcd_642"><p id="qg4rcd_647"><span class="control" id="qg4rcd_648">大数据量下如何设计分片策略？</span></p></li><li class="list__item" id="qg4rcd_643"><p id="qg4rcd_649"><span class="control" id="qg4rcd_650">如何处理热点数据？</span></p></li><li class="list__item" id="qg4rcd_644"><p id="qg4rcd_651"><span class="control" id="qg4rcd_652">内存使用优化有哪些方法？</span></p></li></ol></section><section class="chapter"><h3 id="qg4rcd_622" data-toc="qg4rcd_622">架构设计问题</h3><ol class="list _decimal" id="qg4rcd_653" type="1"><li class="list__item" id="qg4rcd_654"><p id="qg4rcd_658"><span class="control" id="qg4rcd_659">如何设计一个日志分析系统？</span></p></li><li class="list__item" id="qg4rcd_655"><p id="qg4rcd_660"><span class="control" id="qg4rcd_661">电商搜索系统如何架构？</span></p></li><li class="list__item" id="qg4rcd_656"><p id="qg4rcd_662"><span class="control" id="qg4rcd_663">如何实现准实时搜索？</span></p></li><li class="list__item" id="qg4rcd_657"><p id="qg4rcd_664"><span class="control" id="qg4rcd_665">多租户系统如何设计？</span></p></li></ol></section><section class="chapter"><h3 id="qg4rcd_623" data-toc="qg4rcd_623">运维相关问题</h3><ol class="list _decimal" id="qg4rcd_666" type="1"><li class="list__item" id="qg4rcd_668"><p id="qg4rcd_672"><span class="control" id="qg4rcd_673">如何监控Elasticsearch集群？</span></p></li><li class="list__item" id="qg4rcd_669"><p id="qg4rcd_674"><span class="control" id="qg4rcd_675">数据备份和恢复策略？</span></p></li><li class="list__item" id="qg4rcd_670"><p id="qg4rcd_676"><span class="control" id="qg4rcd_677">版本升级注意事项？</span></p></li><li class="list__item" id="qg4rcd_671"><p id="qg4rcd_678"><span class="control" id="qg4rcd_679">故障排查思路？</span></p></li></ol></section></section><section class="chapter"><h2 id="qg4rcd_15" data-toc="qg4rcd_15">学习建议</h2><section class="chapter"><h3 id="1" data-toc="1">1. 基础知识</h3><ul class="list _bullet" id="qg4rcd_684"><li class="list__item" id="qg4rcd_685"><p id="qg4rcd_688">深入理解倒排索引原理</p></li><li class="list__item" id="qg4rcd_686"><p id="qg4rcd_689">掌握核心概念和术语</p></li><li class="list__item" id="qg4rcd_687"><p id="qg4rcd_690">熟练使用Query DSL</p></li></ul></section><section class="chapter"><h3 id="2" data-toc="2">2. 实践经验</h3><ul class="list _bullet" id="qg4rcd_691"><li class="list__item" id="qg4rcd_692"><p id="qg4rcd_695">搭建集群环境</p></li><li class="list__item" id="qg4rcd_693"><p id="qg4rcd_696">进行性能测试</p></li><li class="list__item" id="qg4rcd_694"><p id="qg4rcd_697">模拟故障场景</p></li></ul></section><section class="chapter"><h3 id="3" data-toc="3">3. 进阶学习</h3><ul class="list _bullet" id="qg4rcd_698"><li class="list__item" id="qg4rcd_699"><p id="qg4rcd_702">阅读官方文档</p></li><li class="list__item" id="qg4rcd_700"><p id="qg4rcd_703">研究源码实现</p></li><li class="list__item" id="qg4rcd_701"><p id="qg4rcd_704">关注社区动态</p></li></ul></section><section class="chapter"><h3 id="4" data-toc="4">4. 项目经验</h3><ul class="list _bullet" id="qg4rcd_705"><li class="list__item" id="qg4rcd_707"><p id="qg4rcd_710">参与实际项目</p></li><li class="list__item" id="qg4rcd_708"><p id="qg4rcd_711">总结最佳实践</p></li><li class="list__item" id="qg4rcd_709"><p id="qg4rcd_712">分享技术心得</p></li></ul></section></section><section class="chapter"><h2 id="qg4rcd_16" data-toc="qg4rcd_16">总结</h2><p id="qg4rcd_713">Elasticsearch作为一个复杂的分布式搜索引擎，涉及的技术点非常广泛。在技术面试中，通常会从以下几个维度进行考察：</p><ol class="list _decimal" id="qg4rcd_714" type="1"><li class="list__item" id="qg4rcd_734"><p id="qg4rcd_738"><span class="control" id="qg4rcd_739">理论基础</span>: 倒排索引、分布式原理、一致性算法</p></li><li class="list__item" id="qg4rcd_735"><p id="qg4rcd_740"><span class="control" id="qg4rcd_741">实践能力</span>: 查询优化、性能调优、故障排查</p></li><li class="list__item" id="qg4rcd_736"><p id="qg4rcd_742"><span class="control" id="qg4rcd_743">架构设计</span>: 系统设计、容量规划、高可用方案</p></li><li class="list__item" id="qg4rcd_737"><p id="qg4rcd_744"><span class="control" id="qg4rcd_745">运维经验</span>: 监控告警、备份恢复、版本升级</p></li></ol><p id="qg4rcd_715">建议在学习过程中，既要注重理论知识的掌握，也要通过实际项目来积累经验，这样才能在面试中游刃有余。</p><p id="qg4rcd_716"><span class="control" id="qg4rcd_746">Q14: 向量数据的分层存储如何实现？数据迁移策略是什么？</span></p><p id="qg4rcd_717"><span class="control" id="qg4rcd_747">标准回答:</span></p><div class="code-block" data-lang="none">
向量数据分层存储需要结合ES的ILM(Index Lifecycle Management)和自定义策略：

1. 向量数据节点高内存需求原因：

   HNSW索引特性：
   - 图结构必须完全加载到内存中
   - 查询时需要随机访问图节点，无法依赖磁盘I/O
   - 每个向量节点平均连接16个邻居，需要存储指针信息
   - 多层图结构增加了内存开销

   内存占用计算：
   - 768维向量原始数据: 3KB
   - HNSW图节点连接信息: 128字节
   - 层级和元数据: 50字节
   - 总计: 约3.2KB/向量
   
   1亿向量集群内存需求:
   - 向量数据: 300GB
   - HNSW图结构: 32GB
   - JVM堆空间: 50GB
   - 系统缓存: 100GB
   - 并发查询缓冲: 50GB
   - 总计: 532GB (建议配置768GB)

2. 分层存储架构设计：

   热数据层 (Hot Tier):
   - 存储介质: NVMe SSD
   - 数据特征: 最近7-30天的向量数据
   - 节点配置: 高内存 + 高性能SSD
   - 查询性能: P99 &lt; 50ms

   温数据层 (Warm Tier):
   - 存储介质: SATA SSD
   - 数据特征: 30-90天的向量数据
   - 节点配置: 中等内存 + 大容量SSD
   - 查询性能: P99 &lt; 200ms

   冷数据层 (Cold Tier):
   - 存储介质: 高速HDD或对象存储
   - 数据特征: 90天以上的向量数据
   - 节点配置: 低内存 + 大容量存储
   - 查询性能: P99 &lt; 1000ms

3. ILM策略配置：

   {
     &quot;policy&quot;: {
       &quot;phases&quot;: {
         &quot;hot&quot;: {
           &quot;min_age&quot;: &quot;0ms&quot;,
           &quot;actions&quot;: {
             &quot;rollover&quot;: {
               &quot;max_size&quot;: &quot;50GB&quot;,
               &quot;max_age&quot;: &quot;7d&quot;
             },
             &quot;set_priority&quot;: {
               &quot;priority&quot;: 100
             }
           }
         },
         &quot;warm&quot;: {
           &quot;min_age&quot;: &quot;7d&quot;,
           &quot;actions&quot;: {
             &quot;allocate&quot;: {
               &quot;number_of_replicas&quot;: 1,
               &quot;include&quot;: {
                 &quot;data_tier&quot;: &quot;warm&quot;
               }
             },
             &quot;set_priority&quot;: {
               &quot;priority&quot;: 50
             }
           }
         },
         &quot;cold&quot;: {
           &quot;min_age&quot;: &quot;30d&quot;,
           &quot;actions&quot;: {
             &quot;allocate&quot;: {
               &quot;number_of_replicas&quot;: 0,
               &quot;include&quot;: {
                 &quot;data_tier&quot;: &quot;cold&quot;
               }
             },
             &quot;set_priority&quot;: {
               &quot;priority&quot;: 10
             }
           }
         },
         &quot;delete&quot;: {
           &quot;min_age&quot;: &quot;365d&quot;
         }
       }
     }
   }

4. 数据迁移策略：

   自动迁移流程：
   - 基于时间的自动迁移: ILM策略驱动
   - 基于访问频率的迁移: 监控查询热度
   - 基于存储成本的迁移: 成本优化驱动
   - 手动迁移: 业务需求驱动

   迁移执行步骤：
   1. 创建目标层级的新索引
   2. 使用reindex API复制数据
   3. 验证数据完整性
   4. 更新别名指向
   5. 删除源索引

   迁移命令示例：
   POST _reindex
   {
     &quot;source&quot;: {
       &quot;index&quot;: &quot;vectors-hot-2024-01&quot;
     },
     &quot;dest&quot;: {
       &quot;index&quot;: &quot;vectors-warm-2024-01&quot;
     },
     &quot;script&quot;: {
       &quot;source&quot;: &quot;ctx._source.migrated_at = new Date().getTime()&quot;
     }
   }

5. 智能预加载策略：

   热点数据预测：
   - 基于历史查询模式预测热点向量
   - 使用机器学习模型预测访问概率
   - 预加载高概率访问的向量到内存

   缓存策略：
   - L1缓存: JVM堆内缓存最热数据
   - L2缓存: 堆外缓存温数据
   - L3缓存: 磁盘缓存冷数据

6. 跨层查询优化：

   查询路由策略：
   - 优先查询热数据层
   - 并行查询多个层级
   - 基于时间范围路由查询
   - 结果合并和排序

   性能优化：
   - 使用preference参数控制查询路由
   - 设置不同层级的超时时间
   - 实现查询降级机制
</div><p id="qg4rcd_719"><span class="control" id="qg4rcd_748">分层存储架构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1590.125 426"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1590.125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="数据迁移" class="cluster"><rect height="208" width="695.2890625" y="8" x="8" style=""></rect><g transform="translate(323.58984375, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据迁移</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph3" class="cluster"><rect height="152" width="424.359375" y="266" x="1157.765625" style=""></rect><g transform="translate(1297.234375, 266)" class="cluster-label"><foreignObject height="24" width="145.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>冷数据层 (Cold Tier)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph2" class="cluster"><rect height="152" width="417.09375" y="266" x="720.671875" style=""></rect><g transform="translate(852.078125, 266)" class="cluster-label"><foreignObject height="24" width="154.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>温数据层 (Warm Tier)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="152" width="675.5234375" y="266" x="25.1484375" style=""></rect><g transform="translate(293.41015625, 266)" class="cluster-label"><foreignObject height="24" width="139"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>热数据层 (Hot Tier)</p></span></div></foreignObject></g></g><g data-look="classic" id="查询请求" class="cluster"><rect height="208" width="810.62109375" y="8" x="723.2890625" style=""></rect><g transform="translate(1096.544921875, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询请求</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Query_Router_0" d="M1125.031,87L1125.031,91.167C1125.031,95.333,1125.031,103.667,1125.031,109.917C1125.031,116.167,1125.031,120.333,1125.031,123.833C1125.031,127.333,1125.031,130.167,1125.031,131.583L1125.031,133"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_HotNode1_1" d="M1054.969,175.203L1012.445,182.002C969.922,188.802,884.875,202.401,842.352,213.367C799.828,224.333,799.828,232.667,713.786,241C627.745,249.333,455.661,257.667,366.973,263.917C278.285,270.167,272.993,274.333,268.224,278.088C263.455,281.842,259.21,285.184,257.087,286.855L254.965,288.526"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_HotNode2_2" d="M1054.969,175.937L1015.779,182.614C976.589,189.291,898.208,202.646,859.018,213.49C819.828,224.333,819.828,232.667,748.665,241C677.503,249.333,535.177,257.667,464.014,263.917C392.852,270.167,392.852,274.333,392.852,277.833C392.852,281.333,392.852,284.167,392.852,285.583L392.852,287"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_HotNode3_3" d="M1054.969,182.595L1033.991,188.162C1013.013,193.73,971.057,204.865,950.079,214.599C929.102,224.333,929.102,232.667,872.818,241C816.534,249.333,703.966,257.667,647.682,263.917C591.398,270.167,591.398,274.333,591.398,277.833C591.398,281.333,591.398,284.167,591.398,285.583L591.398,287"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_WarmNode1_4" d="M1136.775,191L1138.587,195.167C1140.399,199.333,1144.024,207.667,1145.836,216C1147.648,224.333,1147.648,232.667,1109.577,241C1071.505,249.333,995.362,257.667,954.843,263.917C914.324,270.167,909.43,274.333,905.043,278.068C900.657,281.802,896.777,285.105,894.838,286.756L892.898,288.407"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_WarmNode2_5" d="M1147.159,191L1150.574,195.167C1153.989,199.333,1160.819,207.667,1164.234,216C1167.648,224.333,1167.648,232.667,1144.456,241C1121.263,249.333,1074.878,257.667,1051.685,263.917C1028.492,270.167,1028.492,274.333,1028.492,277.833C1028.492,281.333,1028.492,284.167,1028.492,285.583L1028.492,287"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_ColdNode1_6" d="M1195.094,179.273L1223.174,185.394C1251.255,191.515,1307.417,203.758,1335.497,214.045C1363.578,224.333,1363.578,232.667,1363.578,241C1363.578,249.333,1363.578,257.667,1361.079,263.917C1358.579,270.167,1353.581,274.333,1349.094,278.073C1344.608,281.813,1340.633,285.126,1338.646,286.782L1336.659,288.439"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Router_ColdNode2_7" d="M1195.094,174.475L1241.387,181.395C1287.68,188.316,1380.266,202.158,1426.559,213.246C1472.852,224.333,1472.852,232.667,1472.852,241C1472.852,249.333,1472.852,257.667,1472.852,263.917C1472.852,270.167,1472.852,274.333,1472.852,277.833C1472.852,281.333,1472.852,284.167,1472.852,285.583L1472.852,287"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ILM_Migration_8" d="M504.859,87L504.859,91.167C504.859,95.333,504.859,103.667,504.859,109.917C504.859,116.167,504.859,120.333,504.859,123.833C504.859,127.333,504.859,130.167,504.859,131.583L504.859,133"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Migration_HotNode1_9" d="M442.805,171.966L385.635,179.305C328.465,186.644,214.125,201.322,156.955,212.828C99.785,224.333,99.785,232.667,99.785,241C99.785,249.333,99.785,257.667,102.177,263.917C104.569,270.167,109.352,274.333,113.633,278.062C117.914,281.791,121.693,285.082,123.582,286.727L125.471,288.373"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Migration_WarmNode1_10" d="M455.721,191L448.138,195.167C440.555,199.333,425.389,207.667,417.806,216C410.223,224.333,410.223,232.667,474.404,241C538.585,249.333,666.947,257.667,732.077,263.917C797.208,270.167,799.106,274.333,800.729,277.893C802.351,281.453,803.697,284.407,804.37,285.883L805.043,287.36"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Migration_ColdNode1_11" d="M566.914,188.097L578.89,192.748C590.866,197.398,614.818,206.699,626.794,215.516C638.77,224.333,638.77,232.667,737.708,241C836.647,249.333,1034.525,257.667,1134.56,263.917C1234.595,270.167,1236.788,274.333,1238.671,277.91C1240.553,281.487,1242.125,284.474,1242.911,285.967L1243.697,287.46"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(1125.03125, 60)" id="flowchart-Query-22201" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>用户查询请求</p></span></div></foreignObject></g></g><g transform="translate(1125.03125, 164)" id="flowchart-Router-22202" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>智能路由器</p></span></div></foreignObject></g></g><g transform="translate(187.0390625, 342)" id="flowchart-HotNode1-22203" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#ff6b6b !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>热数据节点1<br>NVMe SSD<br>768GB RAM</p></span></div></foreignObject></g></g><g transform="translate(392.8515625, 342)" id="flowchart-HotNode2-22204" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#ff6b6b !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>热数据节点2<br>NVMe SSD<br>768GB RAM</p></span></div></foreignObject></g></g><g transform="translate(591.3984375, 342)" id="flowchart-HotNode3-22205" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#ff6b6b !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>热数据节点3<br>NVMe SSD<br>768GB RAM</p></span></div></foreignObject></g></g><g transform="translate(829.9453125, 342)" id="flowchart-WarmNode1-22206" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#ffa726 !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>温数据节点1<br>SATA SSD<br>256GB RAM</p></span></div></foreignObject></g></g><g transform="translate(1028.4921875, 342)" id="flowchart-WarmNode2-22207" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#ffa726 !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>温数据节点2<br>SATA SSD<br>256GB RAM</p></span></div></foreignObject></g></g><g transform="translate(1272.40234375, 342)" id="flowchart-ColdNode1-22208" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#42a5f5 !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>冷数据节点1<br>HDD<br>128GB RAM</p></span></div></foreignObject></g></g><g transform="translate(1472.8515625, 342)" id="flowchart-ColdNode2-22209" class="node default"><rect height="102" width="148.546875" y="-51" x="-74.2734375" data-et="node" data-id="abc" style="fill:#42a5f5 !important" class="basic label-container"></rect><g transform="translate(-44.2734375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="88.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>冷数据节点2<br>对象存储<br>64GB RAM</p></span></div></foreignObject></g></g><g transform="translate(504.859375, 60)" id="flowchart-ILM-22210" class="node default"><rect height="54" width="148.078125" y="-27" x="-74.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-44.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="88.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ILM策略引擎</p></span></div></foreignObject></g></g><g transform="translate(504.859375, 164)" id="flowchart-Migration-22211" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>迁移任务</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_721"><span class="control" id="qg4rcd_749">数据迁移流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-58 -10 1089.5 931" style="max-width: 1089.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Monitor" height="65" width="150" stroke="#666" fill="#eaeaea" y="845" x="800"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="877.5" x="875"><tspan dy="0" x="875">监控系统</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Cold" height="65" width="150" stroke="#666" fill="#eaeaea" y="845" x="600"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="877.5" x="675"><tspan dy="0" x="675">冷数据层</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Warm" height="65" width="150" stroke="#666" fill="#eaeaea" y="845" x="400"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="877.5" x="475"><tspan dy="0" x="475">温数据层</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Hot" height="65" width="150" stroke="#666" fill="#eaeaea" y="845" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="877.5" x="275"><tspan dy="0" x="275">热数据层</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ILM" height="65" width="150" stroke="#666" fill="#eaeaea" y="845" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="877.5" x="75"><tspan dy="0" x="75">ILM引擎</tspan></text></g><g><line name="Monitor" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="845" x2="875" y1="5" x1="875" id="actor1308"></line><g id="root-1308"><rect class="actor actor-top" ry="3" rx="3" name="Monitor" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="800"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="875"><tspan dy="0" x="875">监控系统</tspan></text></g></g><g><line name="Cold" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="845" x2="675" y1="5" x1="675" id="actor1307"></line><g id="root-1307"><rect class="actor actor-top" ry="3" rx="3" name="Cold" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="600"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="675"><tspan dy="0" x="675">冷数据层</tspan></text></g></g><g><line name="Warm" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="845" x2="475" y1="5" x1="475" id="actor1306"></line><g id="root-1306"><rect class="actor actor-top" ry="3" rx="3" name="Warm" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="400"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="475"><tspan dy="0" x="475">温数据层</tspan></text></g></g><g><line name="Hot" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="845" x2="275" y1="5" x1="275" id="actor1305"></line><g id="root-1305"><rect class="actor actor-top" ry="3" rx="3" name="Hot" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="275"><tspan dy="0" x="275">热数据层</tspan></text></g></g><g><line name="ILM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="845" x2="75" y1="5" x1="75" id="actor1304"></line><g id="root-1304"><rect class="actor actor-top" ry="3" rx="3" name="ILM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">ILM引擎</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="166" stroke="#666" fill="#EDF2AE" y="75" x="-8"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="75"><tspan x="75">检查索引年龄和大小</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="457" x="400"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="462" x="475"><tspan x="475">重建HNSW索引</tspan></text></g><g><line class="loopLine" y2="220" x2="886" y1="220" x1="64"></line><line class="loopLine" y2="776" x2="886" y1="220" x1="886"></line><line class="loopLine" y2="776" x2="886" y1="776" x1="64"></line><line class="loopLine" y2="776" x2="64" y1="220" x1="64"></line><polygon class="labelBox" points="64,220 114,220 114,233 105.6,240 64,240"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="233" x="89">alt</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="238" x="500"><tspan x="500">[满足迁移条件]</tspan></text></g><g><rect class="note" height="39" width="213" stroke="#666" fill="#EDF2AE" y="786" x="768.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="791" x="875"><tspan x="875">监控迁移性能和数据完整性</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="174">检查索引状态</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="162" x2="271" y1="162" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="177" x="177">返回索引信息</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="210" x2="79" y1="210" x1="274"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="270" x="274">创建目标索引</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="303" x2="471" y1="303" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="318" x="277">确认创建成功</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="351" x2="79" y1="351" x1="474"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="366" x="174">开始数据复制</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="399" x2="271" y1="399" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="414" x="374">传输向量数据</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="447" x2="471" y1="447" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="511" x="476">构建图结构</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 476,544 C 536,534 536,574 476,564"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="589" x="277">迁移完成确认</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="622" x2="79" y1="622" x1="474"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="637" x="474">更新索引别名</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="670" x2="871" y1="670" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="685" x="174">删除原始数据</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="718" x2="271" y1="718" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="733" x="177">确认删除完成</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="766" x2="79" y1="766" x1="274"></line></svg><p id="qg4rcd_723"><span class="control" id="qg4rcd_750">向量内存使用优化图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 960.8828125 630.15625" height="630.15625" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="960.8828125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M457.91,62L457.91,66.167C457.91,70.333,457.91,78.667,457.952,84.958C457.993,91.25,458.077,95.5,458.147,99.083C458.217,102.667,458.275,105.584,458.303,107.042L458.332,108.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M399.663,203.91L349.372,217.784C299.08,231.658,198.497,259.407,148.206,275.365C97.914,291.323,97.914,295.49,97.914,298.99C97.914,302.49,97.914,305.323,97.914,306.74L97.914,308.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_2" d="M416.833,221.079L402.978,232.092C389.123,243.105,361.413,265.13,347.558,278.227C333.703,291.323,333.703,295.49,333.703,298.99C333.703,302.49,333.703,305.323,333.703,306.74L333.703,308.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_E_3" d="M499.988,221.079L513.676,232.092C527.364,243.105,554.741,265.13,568.429,278.227C582.117,291.323,582.117,295.49,582.117,298.99C582.117,302.49,582.117,305.323,582.117,306.74L582.117,308.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_F_4" d="M518.007,203.06L572.198,217.076C626.39,231.092,734.773,259.124,788.965,275.224C843.156,291.323,843.156,295.49,843.156,298.99C843.156,302.49,843.156,305.323,843.156,306.74L843.156,308.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_G_5" d="M97.914,414.156L97.914,418.323C97.914,422.49,97.914,430.823,97.914,437.073C97.914,443.323,97.914,447.49,97.914,450.99C97.914,454.49,97.914,457.323,97.914,458.74L97.914,460.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_H_6" d="M333.703,414.156L333.703,418.323C333.703,422.49,333.703,430.823,333.703,437.073C333.703,443.323,333.703,447.49,333.703,450.99C333.703,454.49,333.703,457.323,333.703,458.74L333.703,460.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_I_7" d="M582.117,414.156L582.117,418.323C582.117,422.49,582.117,430.823,582.117,437.073C582.117,443.323,582.117,447.49,582.117,450.99C582.117,454.49,582.117,457.323,582.117,458.74L582.117,460.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_J_8" d="M843.156,414.156L843.156,418.323C843.156,422.49,843.156,430.823,843.156,437.073C843.156,443.323,843.156,447.49,843.156,450.99C843.156,454.49,843.156,457.323,843.156,458.74L843.156,460.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_K_9" d="M97.914,518.156L97.914,522.323C97.914,526.49,97.914,534.823,97.914,541.073C97.914,547.323,97.914,551.49,97.914,554.99C97.914,558.49,97.914,561.323,97.914,562.74L97.914,564.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_L_10" d="M333.703,518.156L333.703,522.323C333.703,526.49,333.703,534.823,333.703,541.073C333.703,547.323,333.703,551.49,333.703,554.99C333.703,558.49,333.703,561.323,333.703,562.74L333.703,564.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_M_11" d="M582.117,518.156L582.117,522.323C582.117,526.49,582.117,534.823,582.117,541.073C582.117,547.323,582.117,551.49,582.117,554.99C582.117,558.49,582.117,561.323,582.117,562.74L582.117,564.156"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_N_12" d="M843.156,518.156L843.156,522.323C843.156,526.49,843.156,534.823,843.156,541.073C843.156,547.323,843.156,551.49,843.156,554.99C843.156,558.49,843.156,561.323,843.156,562.74L843.156,564.156"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(457.91015625, 35)" id="flowchart-A-22243" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量数据加载</p></span></div></foreignObject></g></g><g transform="translate(457.91015625, 187.078125)" id="flowchart-B-22244" class="node default"><polygon transform="translate(-75.078125,75.078125)" class="label-container" points="75.078125,0 150.15625,-75.078125 75.078125,-150.15625 0,-75.078125"></polygon><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内存分层策略</p></span></div></foreignObject></g></g><g transform="translate(97.9140625, 363.15625)" id="flowchart-C-22246" class="node default"><rect height="102" width="179.828125" y="-51" x="-89.9140625" data-et="node" data-id="abc" style="fill:#ff6b6b !important" class="basic label-container"></rect><g transform="translate(-59.9140625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="119.828125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>L1: JVM堆内缓存<br>最热向量数据<br>64GB</p></span></div></foreignObject></g></g><g transform="translate(333.703125, 363.15625)" id="flowchart-D-22248" class="node default"><rect height="102" width="156.15625" y="-51" x="-78.078125" data-et="node" data-id="abc" style="fill:#ffa726 !important" class="basic label-container"></rect><g transform="translate(-48.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>L2: 堆外缓存<br>次热向量数据<br>256GB</p></span></div></foreignObject></g></g><g transform="translate(582.1171875, 363.15625)" id="flowchart-E-22250" class="node default"><rect height="102" width="151.390625" y="-51" x="-75.6953125" data-et="node" data-id="abc" style="fill:#42a5f5 !important" class="basic label-container"></rect><g transform="translate(-45.6953125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="91.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>L3: 磁盘缓存<br>温数据<br>1TB SSD</p></span></div></foreignObject></g></g><g transform="translate(843.15625, 363.15625)" id="flowchart-F-22252" class="node default"><rect height="102" width="135.359375" y="-51" x="-67.6796875" data-et="node" data-id="abc" style="fill:#9c27b0 !important" class="basic label-container"></rect><g transform="translate(-37.6796875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="75.359375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>L4: 冷存储<br>冷数据<br>10TB HDD</p></span></div></foreignObject></g></g><g transform="translate(97.9140625, 491.15625)" id="flowchart-G-22254" class="node default"><rect height="54" width="177.375" y="-27" x="-88.6875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.6875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="117.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询延迟: 1-5ms</p></span></div></foreignObject></g></g><g transform="translate(333.703125, 491.15625)" id="flowchart-H-22256" class="node default"><rect height="54" width="194.203125" y="-27" x="-97.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-67.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="134.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询延迟: 10-20ms</p></span></div></foreignObject></g></g><g transform="translate(582.1171875, 491.15625)" id="flowchart-I-22258" class="node default"><rect height="54" width="202.625" y="-27" x="-101.3125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-71.3125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="142.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询延迟: 50-100ms</p></span></div></foreignObject></g></g><g transform="translate(843.15625, 491.15625)" id="flowchart-J-22260" class="node default"><rect height="54" width="219.453125" y="-27" x="-109.7265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-79.7265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="159.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询延迟: 200-1000ms</p></span></div></foreignObject></g></g><g transform="translate(97.9140625, 595.15625)" id="flowchart-K-22262" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实时推荐系统</p></span></div></foreignObject></g></g><g transform="translate(333.703125, 595.15625)" id="flowchart-L-22264" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>语义搜索</p></span></div></foreignObject></g></g><g transform="translate(582.1171875, 595.15625)" id="flowchart-M-22266" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>批量分析</p></span></div></foreignObject></g></g><g transform="translate(843.15625, 595.15625)" id="flowchart-N-22268" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>历史数据挖掘</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_725"><span class="control" id="qg4rcd_751">Q15: 如何通过标量字段预过滤来优化向量检索的性能和资源利用率？</span></p><p id="qg4rcd_726"><span class="control" id="qg4rcd_752">标准回答:</span></p><div class="code-block" data-lang="none">
标量预过滤是向量检索优化的关键策略，可以显著减少内存使用和提升查询性能：

1. 标量预过滤的优化原理：

   传统向量检索流程：
   - 对全量向量进行HNSW图遍历
   - 计算所有候选向量的相似度
   - 返回TopK结果

   标量预过滤优化流程：
   - 首先使用标量字段快速过滤
   - 只对过滤后的向量子集进行HNSW遍历
   - 大幅减少向量计算量

   性能提升效果：
   - 内存使用减少：50-80%
   - 查询延迟降低：60-90%
   - QPS提升：3-10倍
   - CPU使用率降低：40-70%

2. 混合索引设计策略：

   索引结构设计：
   {
     &quot;mappings&quot;: {
       &quot;properties&quot;: {
         &quot;content_vector&quot;: {
           &quot;type&quot;: &quot;dense_vector&quot;,
           &quot;dims&quot;: 768,
           &quot;similarity&quot;: &quot;cosine&quot;,
           &quot;index&quot;: true,
           &quot;index_options&quot;: {
             &quot;type&quot;: &quot;hnsw&quot;,
             &quot;m&quot;: 8,
             &quot;ef_construction&quot;: 100
           }
         },
         &quot;category&quot;: {
           &quot;type&quot;: &quot;keyword&quot;,
           &quot;index&quot;: true
         },
         &quot;price_range&quot;: {
           &quot;type&quot;: &quot;integer&quot;,
           &quot;index&quot;: true
         },
         &quot;publish_date&quot;: {
           &quot;type&quot;: &quot;date&quot;,
           &quot;index&quot;: true
         },
         &quot;brand&quot;: {
           &quot;type&quot;: &quot;keyword&quot;,
           &quot;index&quot;: true
         },
         &quot;rating&quot;: {
           &quot;type&quot;: &quot;float&quot;,
           &quot;index&quot;: true
         },
         &quot;location&quot;: {
           &quot;type&quot;: &quot;geo_point&quot;,
           &quot;index&quot;: true
         }
       }
     }
   }

3. 预过滤查询策略：

   高效预过滤查询：
   {
     &quot;knn&quot;: {
       &quot;field&quot;: &quot;content_vector&quot;,
       &quot;query_vector&quot;: [0.1, 0.2, ...],
       &quot;k&quot;: 10,
       &quot;num_candidates&quot;: 100,
       &quot;filter&quot;: {
         &quot;bool&quot;: {
           &quot;must&quot;: [
             {&quot;term&quot;: {&quot;category&quot;: &quot;electronics&quot;}},
             {&quot;range&quot;: {&quot;price_range&quot;: {&quot;gte&quot;: 100, &quot;lte&quot;: 1000}}},
             {&quot;range&quot;: {&quot;publish_date&quot;: {&quot;gte&quot;: &quot;2024-01-01&quot;}}},
             {&quot;terms&quot;: {&quot;brand&quot;: [&quot;apple&quot;, &quot;samsung&quot;, &quot;sony&quot;]}}
           ]
         }
       }
     }
   }

   多级过滤策略：
   {
     &quot;query&quot;: {
       &quot;bool&quot;: {
         &quot;filter&quot;: [
           {&quot;term&quot;: {&quot;category&quot;: &quot;electronics&quot;}},
           {&quot;range&quot;: {&quot;rating&quot;: {&quot;gte&quot;: 4.0}}}
         ],
         &quot;must&quot;: [
           {
             &quot;knn&quot;: {
               &quot;field&quot;: &quot;content_vector&quot;,
               &quot;query_vector&quot;: [...],
               &quot;k&quot;: 50
             }
           }
         ]
       }
     }
   }

4. 内存优化配置：

   基于过滤率的内存配置：
   
   过滤率90% (剩余10%向量)：
   - 原始内存需求：768GB
   - 优化后需求：200GB
   - 节省内存：568GB (74%)

   过滤率95% (剩余5%向量)：
   - 原始内存需求：768GB
   - 优化后需求：150GB
   - 节省内存：618GB (80%)

   过滤率99% (剩余1%向量)：
   - 原始内存需求：768GB
   - 优化后需求：100GB
   - 节省内存：668GB (87%)

5. 分片和路由优化：

   基于标量字段的智能分片：
   {
     &quot;settings&quot;: {
       &quot;number_of_shards&quot;: 6,
       &quot;routing.partition_size&quot;: 1,
       &quot;index.routing.allocation.include.category&quot;: &quot;electronics&quot;
     }
   }

   自定义路由策略：
   PUT /products/_doc/1?routing=electronics_apple
   {
     &quot;content_vector&quot;: [...],
     &quot;category&quot;: &quot;electronics&quot;,
     &quot;brand&quot;: &quot;apple&quot;,
     &quot;price_range&quot;: 500
   }

6. 缓存策略优化：

   标量字段缓存：
   - 将热门标量过滤条件缓存到内存
   - 使用布隆过滤器快速判断向量是否需要计算
   - 实现查询结果的多级缓存

   向量子集缓存：
   - 缓存常用过滤条件对应的向量子集
   - 预计算热门组合的HNSW子图
   - 实现增量更新机制

7. 查询优化技巧：

   过滤条件优化顺序：
   1. 最具选择性的标量字段优先
   2. 索引效率高的字段优先
   3. 数据分布均匀的字段优先

   示例优化顺序：
   - category (选择性高，索引效率高)
   - price_range (数值范围，过滤效果好)
   - publish_date (时间范围，业务相关性强)
   - brand (枚举值，缓存友好)

8. 性能监控指标：

   关键监控指标：
   - 过滤率：filter_ratio = filtered_docs / total_docs
   - 向量计算率：vector_calc_ratio = vector_calcs / total_requests
   - 内存使用率：memory_usage / total_memory
   - 查询延迟分布：P50, P95, P99
   - 缓存命中率：cache_hit_ratio

   告警阈值设置：
   - 过滤率 &lt; 50%：优化过滤条件
   - 内存使用率 &gt; 80%：扩容或优化
   - P99延迟 &gt; 200ms：性能调优
   - 缓存命中率 &lt; 70%：缓存策略调整

9. 实际应用案例：

   电商推荐系统：
   - 标量过滤：类目、价格区间、品牌、地域
   - 过滤效果：99%的商品被过滤，只对1%进行向量计算
   - 性能提升：延迟从500ms降到50ms，QPS从100提升到1000

   内容推荐系统：
   - 标量过滤：发布时间、内容类型、作者、标签
   - 过滤效果：95%的内容被过滤
   - 性能提升：内存使用从1TB降到200GB

   图像搜索系统：
   - 标量过滤：图片尺寸、格式、拍摄时间、地理位置
   - 过滤效果：90%的图片被过滤
   - 性能提升：查询延迟从1s降到100ms
</div><p id="qg4rcd_728"><span class="control" id="qg4rcd_753">标量预过滤优化架构图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 781.03125 1097"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="781.03125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M586.813,135.5L586.813,151.917C586.813,168.333,586.813,201.167,586.813,219.667C586.813,238.167,586.813,242.333,586.813,245.833C586.813,249.333,586.813,252.167,586.813,253.583L586.813,255"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M639.823,313L648.003,317.167C656.184,321.333,672.545,329.667,680.726,335.917C688.906,342.167,688.906,346.333,688.906,349.833C688.906,353.333,688.906,356.167,688.906,357.583L688.906,359"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_2" d="M533.802,313L525.622,317.167C517.441,321.333,501.08,329.667,492.899,342.5C484.719,355.333,484.719,372.667,484.719,390C484.719,407.333,484.719,424.667,484.719,442C484.719,459.333,484.719,476.667,484.719,494C484.719,511.333,484.719,528.667,484.719,540.417C484.719,552.167,484.719,558.333,484.719,563.833C484.719,569.333,484.719,574.167,484.719,576.583L484.719,579"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_E_3" d="M688.906,417L688.906,421.167C688.906,425.333,688.906,433.667,688.906,439.917C688.906,446.167,688.906,450.333,688.906,453.833C688.906,457.333,688.906,460.167,688.906,461.583L688.906,463"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M688.906,521L688.906,525.167C688.906,529.333,688.906,537.667,688.906,543.917C688.906,550.167,688.906,554.333,688.906,557.833C688.906,561.333,688.906,564.167,688.906,565.583L688.906,567"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_G_5" d="M484.719,637L484.719,643.167C484.719,649.333,484.719,661.667,488.809,669.917C492.899,678.167,501.08,682.333,508.666,686.197C516.253,690.062,523.245,693.623,526.742,695.404L530.238,697.185"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_6" d="M688.906,649L688.906,653.167C688.906,657.333,688.906,665.667,684.816,671.917C680.726,678.167,672.545,682.333,664.959,686.197C657.372,690.062,650.38,693.623,646.883,695.404L643.387,697.185"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_7" d="M586.813,753L586.813,757.167C586.813,761.333,586.813,769.667,586.813,775.917C586.813,782.167,586.813,786.333,586.813,789.833C586.813,793.333,586.813,796.167,586.813,797.583L586.813,799"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_8" d="M586.813,881L586.813,885.167C586.813,889.333,586.813,897.667,586.813,903.917C586.813,910.167,586.813,914.333,586.813,917.833C586.813,921.333,586.813,924.167,586.813,925.583L586.813,927"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_9" d="M586.813,985L586.813,989.167C586.813,993.333,586.813,1001.667,586.813,1007.917C586.813,1014.167,586.813,1018.333,586.813,1021.833C586.813,1025.333,586.813,1028.167,586.813,1029.583L586.813,1031"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="性能对比" class="cluster"><rect height="201" width="450.734375" y="8" x="8" style=""></rect><g transform="translate(201.3125, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能对比</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(129.890625, 108.5)" id="flowchart-K-22293" class="node default"><rect height="126" width="173.78125" y="-63" x="-86.890625" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-56.890625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="113.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>无过滤<br>遍历1000万向量<br>延迟: 500ms<br>内存: 768GB</p></span></div></foreignObject></g></g><g transform="translate(345.2578125, 108.5)" id="flowchart-L-22294" class="node default"><rect height="126" width="156.953125" y="-63" x="-78.4765625" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-48.4765625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="96.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>有过滤<br>遍历10万向量<br>延迟: 50ms<br>内存: 200GB</p></span></div></foreignObject></g></g></g></g><g transform="translate(586.8125, 108.5)" id="flowchart-A-22273" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>用户查询请求</p></span></div></foreignObject></g></g><g transform="translate(586.8125, 286)" id="flowchart-B-22274" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询解析器</p></span></div></foreignObject></g></g><g transform="translate(688.90625, 390)" id="flowchart-C-22276" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>标量过滤器</p></span></div></foreignObject></g></g><g transform="translate(484.71875, 610)" id="flowchart-D-22278" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量编码器</p></span></div></foreignObject></g></g><g transform="translate(688.90625, 494)" id="flowchart-E-22280" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>倒排索引查询</p></span></div></foreignObject></g></g><g transform="translate(688.90625, 610)" id="flowchart-F-22282" class="node default"><rect height="78" width="168.25" y="-39" x="-84.125" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-54.125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="108.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>候选文档集合<br>1000万 → 10万</p></span></div></foreignObject></g></g><g transform="translate(586.8125, 726)" id="flowchart-G-22284" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>向量相似度计算</p></span></div></foreignObject></g></g><g transform="translate(586.8125, 842)" id="flowchart-H-22288" class="node default"><rect height="78" width="172.984375" y="-39" x="-86.4921875" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-56.4921875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HNSW图遍历<br>只遍历10万向量</p></span></div></foreignObject></g></g><g transform="translate(586.8125, 958)" id="flowchart-I-22290" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>相似度排序</p></span></div></foreignObject></g></g><g transform="translate(586.8125, 1062)" id="flowchart-J-22292" class="node default"><rect height="54" width="126.15625" y="-27" x="-63.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-33.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="66.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>TopK结果</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_730"><span class="control" id="qg4rcd_754">内存使用优化对比图:</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 828.78125 380"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="828.78125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="标量预过滤优化" class="cluster"><rect height="172" width="638.671875" y="8" x="182.109375" style=""></rect><g transform="translate(445.359375, 8)" class="cluster-label"><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>标量预过滤优化</p></span></div></foreignObject></g></g><g data-look="classic" id="传统向量检索" class="cluster"><rect height="172" width="421.53125" y="200" x="182.109375" style=""></rect><g transform="translate(344.796875, 200)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>传统向量检索</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A1_A2_0" d="M364.891,286L370.323,286C375.755,286,386.62,286,394.135,286C401.651,286,405.818,286,409.318,286C412.818,286,415.651,286,417.068,286L418.484,286"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_B2_1" d="M372.484,94L376.651,94C380.818,94,389.151,94,396.19,94C403.229,94,408.974,94,414.052,94C419.13,94,423.542,94,425.747,94L427.953,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B2_B3_2" d="M569.172,94L574.917,94C580.661,94,592.151,94,602.063,94C611.974,94,620.307,94,626.557,94C632.807,94,636.974,94,640.474,94C643.974,94,646.807,94,648.224,94L649.641,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_A1_3" d="M94.539,217L104.967,228.5C115.396,240,136.253,263,150.848,274.5C165.443,286,173.776,286,180.659,286C187.542,286,192.974,286,197.74,286C202.505,286,206.604,286,208.654,286L210.703,286"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_B1_4" d="M94.539,163L104.967,151.5C115.396,140,136.253,117,150.848,105.5C165.443,94,173.776,94,180.026,94C186.276,94,190.443,94,193.943,94C197.443,94,200.276,94,201.693,94L203.109,94"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(289.796875, 286)" id="flowchart-A1-22299" class="node default"><rect height="102" width="150.1875" y="-51" x="-75.09375" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-45.09375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="90.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>全量HNSW图<br>1亿向量<br>768GB内存</p></span></div></foreignObject></g></g><g transform="translate(500.5625, 286)" id="flowchart-A2-22301" class="node default"><rect height="102" width="156.15625" y="-51" x="-78.078125" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-48.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>遍历全图<br>计算所有向量<br>延迟: 500ms</p></span></div></foreignObject></g></g><g transform="translate(289.796875, 94)" id="flowchart-B1-22302" class="node default"><rect height="102" width="165.375" y="-51" x="-82.6875" data-et="node" data-id="abc" style="fill:#e8f5e8 !important" class="basic label-container"></rect><g transform="translate(-52.6875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="105.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>标量索引过滤<br>99%过滤率<br>剩余100万向量</p></span></div></foreignObject></g></g><g transform="translate(500.5625, 94)" id="flowchart-B2-22304" class="node default"><rect height="102" width="137.21875" y="-51" x="-68.609375" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-38.609375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="77.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HNSW子图<br>100万向量<br>100GB内存</p></span></div></foreignObject></g></g><g transform="translate(724.7109375, 94)" id="flowchart-B3-22306" class="node default"><rect height="102" width="142.140625" y="-51" x="-71.0703125" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-41.0703125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="82.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>遍历子图<br>计算1%向量<br>延迟: 50ms</p></span></div></foreignObject></g></g><g transform="translate(70.0546875, 190)" id="flowchart-C-22307" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询请求</p></span></div></foreignObject></g></g></g></g></g></svg><p id="qg4rcd_732"><span class="control" id="qg4rcd_755">查询性能提升流程图:</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-101.5 -10 1302.5 984" style="max-width: 1302.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Cache" height="65" width="150" stroke="#666" fill="#eaeaea" y="898" x="1001"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="930.5" x="1076"><tspan dy="0" x="1076">缓存层</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="VectorIdx" height="65" width="150" stroke="#666" fill="#eaeaea" y="898" x="801"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="930.5" x="876"><tspan dy="0" x="876">向量索引</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="ScalarIdx" height="65" width="150" stroke="#666" fill="#eaeaea" y="898" x="601"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="930.5" x="676"><tspan dy="0" x="676">标量索引</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Parser" height="65" width="150" stroke="#666" fill="#eaeaea" y="898" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="930.5" x="275"><tspan dy="0" x="275">查询解析器</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="898" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="930.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="Cache" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="898" x2="1076" y1="5" x1="1076" id="actor1313"></line><g id="root-1313"><rect class="actor actor-top" ry="3" rx="3" name="Cache" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1001"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1076"><tspan dy="0" x="1076">缓存层</tspan></text></g></g><g><line name="VectorIdx" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="898" x2="876" y1="5" x1="876" id="actor1312"></line><g id="root-1312"><rect class="actor actor-top" ry="3" rx="3" name="VectorIdx" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="801"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="876"><tspan dy="0" x="876">向量索引</tspan></text></g></g><g><line name="ScalarIdx" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="898" x2="676" y1="5" x1="676" id="actor1311"></line><g id="root-1311"><rect class="actor actor-top" ry="3" rx="3" name="ScalarIdx" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="601"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="676"><tspan dy="0" x="676">标量索引</tspan></text></g></g><g><line name="Parser" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="898" x2="275" y1="5" x1="275" id="actor1310"></line><g id="root-1310"><rect class="actor actor-top" ry="3" rx="3" name="Parser" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="275"><tspan dy="0" x="275">查询解析器</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="898" x2="75" y1="5" x1="75" id="actor1309"></line><g id="root-1309"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="201" x="200"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="275"><tspan x="275">标量预过滤阶段</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="424" x="200"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="429" x="275"><tspan x="275">向量计算阶段</tspan></text></g><g><rect class="note" height="39" width="253" stroke="#666" fill="#EDF2AE" y="839" x="-51.5"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="844" x="75"><tspan x="75">性能提升: 延迟↓90%, 内存↓80%</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="174">混合查询请求</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="271" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="276">分离标量条件和向量条件</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 276,161 C 336,151 336,191 276,181"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="255" x="474">category=electronics AND price=[100,1000]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="288" x2="672" y1="288" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="303" x="677">倒排索引快速过滤</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 677,336 C 737,326 737,366 677,356"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="381" x="477">返回100万候选文档ID</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="414" x2="279" y1="414" x1="675"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="478" x="674">检查向量缓存</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="511" x2="1072" y1="511" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="526" x="677">缓存未命中</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="559" x2="279" y1="559" x1="1075"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="574" x="574">对100万向量进行kNN搜索</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="607" x2="872" y1="607" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="622" x="877">HNSW图遍历(仅1%数据)</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 877,655 C 937,645 937,685 877,675"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="700" x="577">返回TopK相似向量</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="733" x2="279" y1="733" x1="875"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="748" x="674">缓存计算结果</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="781" x2="1072" y1="781" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="796" x="177">返回最终结果</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="829" x2="79" y1="829" x1="274"></line></svg></section><div class="last-modified">26 五月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>