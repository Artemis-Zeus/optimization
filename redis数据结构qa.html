<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-10T01:18:23.874643"><title>Redis 数据结构 QA | 技术知识库</title><script type="application/json" id="virtual-toc-data">[{"id":"q1-redis","level":0,"title":"Q1: Redis有哪些基本数据类型？各自的特点和应用场景是什么？","anchor":"#q1-redis"},{"id":"q2-string-sds","level":0,"title":"Q2: String类型的底层实现是什么？SDS有什么优势？","anchor":"#q2-string-sds"},{"id":"q3-hash-ziplist-hashtable","level":0,"title":"Q3: Hash类型的底层实现原理是什么？什么时候使用ziplist，什么时候使用hashtable？","anchor":"#q3-hash-ziplist-hashtable"},{"id":"q4-list-quicklist","level":0,"title":"Q4: List类型的底层实现经历了哪些变化？quicklist是什么？","anchor":"#q4-list-quicklist"},{"id":"q5-set-sorted-set","level":0,"title":"Q5: Set和Sorted Set的底层实现有什么区别？跳跃表是如何工作的？","anchor":"#q5-set-sorted-set"},{"id":"q6-redis","level":0,"title":"Q6: Redis的高级数据类型有哪些？它们的应用场景是什么？","anchor":"#q6-redis"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Redis 数据结构 QA | 技术知识库"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术知识库 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/redis数据结构qa.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Redis 数据结构 QA | 技术知识库"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/redis数据结构qa.html#webpage",
    "url": "writerside-documentation/redis数据结构qa.html",
    "name": "Redis 数据结构 QA | 技术知识库",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术知识库 Help"
}</script><!-- End Schema.org --></head><body data-id="Redis数据结构QA" data-main-title="Redis 数据结构 QA" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Redis面试大纲.md|Redis 技术大纲"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术知识库  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Redis数据结构QA" id="Redis数据结构QA.md">Redis 数据结构 QA</h1><section class="chapter"><h2 id="q1-redis" data-toc="q1-redis">Q1: Redis有哪些基本数据类型？各自的特点和应用场景是什么？</h2><p id="-7de38a_9"><span class="control" id="-7de38a_15">A1:</span> Redis支持5种基本数据类型：</p><section class="chapter"><h3 id="1-string" data-toc="1-string">1. String（字符串）</h3><ul class="list _bullet" id="-7de38a_16"><li class="list__item" id="-7de38a_17"><p id="-7de38a_20"><span class="control" id="-7de38a_21">特点</span>: 最基本的数据类型，二进制安全，最大512MB</p></li><li class="list__item" id="-7de38a_18"><p id="-7de38a_22"><span class="control" id="-7de38a_23">应用场景</span>: 缓存、计数器、分布式锁、session存储</p></li><li class="list__item" id="-7de38a_19"><p id="-7de38a_24"><span class="control" id="-7de38a_25">常用命令</span>: SET、GET、INCR、DECR、APPEND、STRLEN</p></li></ul></section><section class="chapter"><h3 id="2-hash" data-toc="2-hash">2. Hash（哈希）</h3><ul class="list _bullet" id="-7de38a_26"><li class="list__item" id="-7de38a_27"><p id="-7de38a_30"><span class="control" id="-7de38a_31">特点</span>: 键值对集合，类似于Java中的HashMap</p></li><li class="list__item" id="-7de38a_28"><p id="-7de38a_32"><span class="control" id="-7de38a_33">应用场景</span>: 存储对象信息、用户信息、商品信息</p></li><li class="list__item" id="-7de38a_29"><p id="-7de38a_34"><span class="control" id="-7de38a_35">常用命令</span>: HSET、HGET、HMSET、HMGET、HGETALL、HDEL</p></li></ul></section><section class="chapter"><h3 id="3-list" data-toc="3-list">3. List（列表）</h3><ul class="list _bullet" id="-7de38a_36"><li class="list__item" id="-7de38a_37"><p id="-7de38a_40"><span class="control" id="-7de38a_41">特点</span>: 有序的字符串列表，支持双端操作</p></li><li class="list__item" id="-7de38a_38"><p id="-7de38a_42"><span class="control" id="-7de38a_43">应用场景</span>: 消息队列、最新消息排行、时间线</p></li><li class="list__item" id="-7de38a_39"><p id="-7de38a_44"><span class="control" id="-7de38a_45">常用命令</span>: LPUSH、RPUSH、LPOP、RPOP、LRANGE、LLEN</p></li></ul></section><section class="chapter"><h3 id="4-set" data-toc="4-set">4. Set（集合）</h3><ul class="list _bullet" id="-7de38a_46"><li class="list__item" id="-7de38a_47"><p id="-7de38a_50"><span class="control" id="-7de38a_51">特点</span>: 无序的字符串集合，元素唯一</p></li><li class="list__item" id="-7de38a_48"><p id="-7de38a_52"><span class="control" id="-7de38a_53">应用场景</span>: 标签、好友关系、数据去重、交集并集运算</p></li><li class="list__item" id="-7de38a_49"><p id="-7de38a_54"><span class="control" id="-7de38a_55">常用命令</span>: SADD、SREM、SMEMBERS、SINTER、SUNION、SDIFF</p></li></ul></section><section class="chapter"><h3 id="5-sorted-set" data-toc="5-sorted-set">5. Sorted Set（有序集合）</h3><ul class="list _bullet" id="-7de38a_56"><li class="list__item" id="-7de38a_58"><p id="-7de38a_61"><span class="control" id="-7de38a_62">特点</span>: 有序的字符串集合，每个元素关联一个分数</p></li><li class="list__item" id="-7de38a_59"><p id="-7de38a_63"><span class="control" id="-7de38a_64">应用场景</span>: 排行榜、优先级队列、范围查询</p></li><li class="list__item" id="-7de38a_60"><p id="-7de38a_65"><span class="control" id="-7de38a_66">常用命令</span>: ZADD、ZREM、ZRANGE、ZRANK、ZSCORE、ZCOUNT</p></li></ul><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 841.6484375 326"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="841.6484375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M337.492,47.063L292.919,53.719C248.346,60.375,159.201,73.688,114.628,82.427C70.055,91.167,70.055,95.333,70.055,98.833C70.055,102.333,70.055,105.167,70.055,106.583L70.055,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M337.492,59.126L321.938,63.772C306.383,68.418,275.273,77.709,259.719,84.438C244.164,91.167,244.164,95.333,244.164,98.833C244.164,102.333,244.164,105.167,244.164,106.583L244.164,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M418.273,62L418.273,66.167C418.273,70.333,418.273,78.667,418.273,84.917C418.273,91.167,418.273,95.333,418.273,98.833C418.273,102.333,418.273,105.167,418.273,106.583L418.273,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M499.055,59.126L514.609,63.772C530.164,68.418,561.273,77.709,576.828,84.438C592.383,91.167,592.383,95.333,592.383,98.833C592.383,102.333,592.383,105.167,592.383,106.583L592.383,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_F_4" d="M499.055,47.063L543.628,53.719C588.201,60.375,677.346,73.688,721.919,82.427C766.492,91.167,766.492,95.333,766.492,98.833C766.492,102.333,766.492,105.167,766.492,106.583L766.492,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_5" d="M70.055,166L70.055,170.167C70.055,174.333,70.055,182.667,70.055,188.917C70.055,195.167,70.055,199.333,70.055,202.833C70.055,206.333,70.055,209.167,70.055,210.583L70.055,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M244.164,166L244.164,170.167C244.164,174.333,244.164,182.667,244.164,188.917C244.164,195.167,244.164,199.333,244.164,202.833C244.164,206.333,244.164,209.167,244.164,210.583L244.164,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_7" d="M418.273,166L418.273,170.167C418.273,174.333,418.273,182.667,418.273,188.917C418.273,195.167,418.273,199.333,418.273,202.833C418.273,206.333,418.273,209.167,418.273,210.583L418.273,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_8" d="M592.383,166L592.383,170.167C592.383,174.333,592.383,182.667,592.383,188.917C592.383,195.167,592.383,199.333,592.383,202.833C592.383,206.333,592.383,209.167,592.383,210.583L592.383,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_F1_9" d="M766.492,166L766.492,170.167C766.492,174.333,766.492,182.667,766.492,188.917C766.492,195.167,766.492,199.333,766.492,202.833C766.492,206.333,766.492,209.167,766.492,210.583L766.492,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(418.2734375, 35)" id="flowchart-A-7989" class="node default"><rect height="54" width="161.5625" y="-27" x="-80.78125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-50.78125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="101.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis数据类型</p></span></div></foreignObject></g></g><g transform="translate(70.0546875, 139)" id="flowchart-B-7990" class="node default"><rect height="54" width="101.75" y="-27" x="-50.875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-20.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="41.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>String</p></span></div></foreignObject></g></g><g transform="translate(244.1640625, 139)" id="flowchart-C-7992" class="node default"><rect height="54" width="94.203125" y="-27" x="-47.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-17.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="34.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Hash</p></span></div></foreignObject></g></g><g transform="translate(418.2734375, 139)" id="flowchart-D-7994" class="node default"><rect height="54" width="85.59375" y="-27" x="-42.796875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-12.796875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="25.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>List</p></span></div></foreignObject></g></g><g transform="translate(592.3828125, 139)" id="flowchart-E-7996" class="node default"><rect height="54" width="82.84375" y="-27" x="-41.421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-11.421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="22.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Set</p></span></div></foreignObject></g></g><g transform="translate(766.4921875, 139)" id="flowchart-F-7998" class="node default"><rect height="54" width="134.3125" y="-27" x="-67.15625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-37.15625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="74.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Sorted Set</p></span></div></foreignObject></g></g><g transform="translate(70.0546875, 267)" id="flowchart-B1-8000" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>缓存<br>计数器<br>分布式锁</p></span></div></foreignObject></g></g><g transform="translate(244.1640625, 267)" id="flowchart-C1-8002" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>对象存储<br>用户信息<br>商品详情</p></span></div></foreignObject></g></g><g transform="translate(418.2734375, 267)" id="flowchart-D1-8004" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>消息队列<br>时间线<br>最新列表</p></span></div></foreignObject></g></g><g transform="translate(592.3828125, 267)" id="flowchart-E1-8006" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>标签系统<br>好友关系<br>去重操作</p></span></div></foreignObject></g></g><g transform="translate(766.4921875, 267)" id="flowchart-F1-8008" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>排行榜<br>优先队列<br>范围查询</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q2-string-sds" data-toc="q2-string-sds">Q2: String类型的底层实现是什么？SDS有什么优势？</h2><p id="-7de38a_67"><span class="control" id="-7de38a_70">A2:</span> String类型的底层实现是<span class="control" id="-7de38a_71">SDS（Simple Dynamic String）</span> ，而不是C语言的传统字符串。</p><section class="chapter"><h3 id="sds" data-toc="sds">SDS的结构：</h3><div class="code-block" data-lang="c">
struct sdshdr {
    int len;        // 字符串长度
    int free;       // 未使用空间长度
    char buf[];     // 字符数组
};
</div></section><section class="chapter"><h3 id="sds" data-toc="sds">SDS的优势：</h3><ol class="list _decimal" id="-7de38a_73" type="1"><li class="list__item" id="-7de38a_75"><p id="-7de38a_80"><span class="control" id="-7de38a_81">O(1)时间复杂度获取长度</span> - 直接读取len字段</p></li><li class="list__item" id="-7de38a_76"><p id="-7de38a_82"><span class="control" id="-7de38a_83">杜绝缓冲区溢出</span> - 自动扩容机制</p></li><li class="list__item" id="-7de38a_77"><p id="-7de38a_84"><span class="control" id="-7de38a_85">减少修改字符串的内存重分配次数</span> - 空间预分配和惰性空间释放</p></li><li class="list__item" id="-7de38a_78"><p id="-7de38a_86"><span class="control" id="-7de38a_87">二进制安全</span> - 可以存储任意二进制数据</p></li><li class="list__item" id="-7de38a_79"><p id="-7de38a_88"><span class="control" id="-7de38a_89">兼容C字符串函数</span> - 以空字符结尾</p></li></ol><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1037.359375 302"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1037.359375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M484.484,41.841L419.938,49.367C355.391,56.894,226.297,71.947,161.75,81.557C97.203,91.167,97.203,95.333,97.203,98.833C97.203,102.333,97.203,105.167,97.203,106.583L97.203,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M484.484,48.731L457.233,55.109C429.982,61.487,375.479,74.244,348.228,82.705C320.977,91.167,320.977,95.333,320.977,98.833C320.977,102.333,320.977,105.167,320.977,106.583L320.977,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M543.148,62L543.148,66.167C543.148,70.333,543.148,78.667,543.148,84.917C543.148,91.167,543.148,95.333,543.148,98.833C543.148,102.333,543.148,105.167,543.148,106.583L543.148,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M601.813,49.798L626.393,55.998C650.974,62.198,700.135,74.599,724.716,82.883C749.297,91.167,749.297,95.333,749.297,98.833C749.297,102.333,749.297,105.167,749.297,106.583L749.297,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_F_4" d="M601.813,42.436L660.405,49.864C718.997,57.291,836.182,72.145,894.775,81.656C953.367,91.167,953.367,95.333,953.367,98.833C953.367,102.333,953.367,105.167,953.367,106.583L953.367,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_5" d="M97.203,166L97.203,170.167C97.203,174.333,97.203,182.667,97.203,188.917C97.203,195.167,97.203,199.333,97.203,202.833C97.203,206.333,97.203,209.167,97.203,210.583L97.203,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M320.977,166L320.977,170.167C320.977,174.333,320.977,182.667,320.977,188.917C320.977,195.167,320.977,199.333,320.977,202.833C320.977,206.333,320.977,209.167,320.977,210.583L320.977,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_7" d="M543.148,166L543.148,170.167C543.148,174.333,543.148,182.667,543.148,188.917C543.148,195.167,543.148,199.333,543.148,202.833C543.148,206.333,543.148,209.167,543.148,210.583L543.148,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_8" d="M749.297,166L749.297,170.167C749.297,174.333,749.297,182.667,749.297,188.917C749.297,195.167,749.297,199.333,749.297,202.833C749.297,206.333,749.297,209.167,749.297,210.583L749.297,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_F1_9" d="M953.367,166L953.367,170.167C953.367,174.333,953.367,182.667,953.367,188.917C953.367,195.167,953.367,199.333,953.367,202.833C953.367,206.333,953.367,209.167,953.367,210.583L953.367,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(543.1484375, 35)" id="flowchart-A-8110" class="node default"><rect height="54" width="117.328125" y="-27" x="-58.6640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.6640625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="57.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>SDS优势</p></span></div></foreignObject></g></g><g transform="translate(97.203125, 139)" id="flowchart-B-8111" class="node default"><rect height="54" width="175.375" y="-27" x="-87.6875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-57.6875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="115.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>O1时间获取长度</p></span></div></foreignObject></g></g><g transform="translate(320.9765625, 139)" id="flowchart-C-8113" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>防止缓冲区溢出</p></span></div></foreignObject></g></g><g transform="translate(543.1484375, 139)" id="flowchart-D-8115" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>减少内存重分配</p></span></div></foreignObject></g></g><g transform="translate(749.296875, 139)" id="flowchart-E-8117" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>二进制安全</p></span></div></foreignObject></g></g><g transform="translate(953.3671875, 139)" id="flowchart-F-8119" class="node default"><rect height="54" width="133.703125" y="-27" x="-66.8515625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.8515625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="73.703125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>兼容C函数</p></span></div></foreignObject></g></g><g transform="translate(97.203125, 255)" id="flowchart-B1-8121" class="node default"><rect height="78" width="178.40625" y="-39" x="-89.203125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-59.203125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="118.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>直接读取len字段<br>不需要遍历</p></span></div></foreignObject></g></g><g transform="translate(320.9765625, 255)" id="flowchart-C1-8123" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>自动检查空间<br>自动扩容</p></span></div></foreignObject></g></g><g transform="translate(543.1484375, 255)" id="flowchart-D1-8125" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>空间预分配<br>惰性释放</p></span></div></foreignObject></g></g><g transform="translate(749.296875, 255)" id="flowchart-E1-8127" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>可存储图片<br>音频等二进制</p></span></div></foreignObject></g></g><g transform="translate(953.3671875, 255)" id="flowchart-F1-8129" class="node default"><rect height="78" width="151.984375" y="-39" x="-75.9921875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.9921875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="91.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>可使用strcpy<br>strcat等函数</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q3-hash-ziplist-hashtable" data-toc="q3-hash-ziplist-hashtable">Q3: Hash类型的底层实现原理是什么？什么时候使用ziplist，什么时候使用hashtable？</h2><p id="-7de38a_90"><span class="control" id="-7de38a_93">A3:</span> Hash类型根据数据量大小采用不同的底层实现：</p><section class="chapter"><h3 id="1-ziplist" data-toc="1-ziplist">1. ziplist（压缩列表）</h3><p id="-7de38a_94"><span class="control" id="-7de38a_98">使用条件</span> （同时满足）：</p><ul class="list _bullet" id="-7de38a_95"><li class="list__item" id="-7de38a_99"><p id="-7de38a_101">哈希对象保存的所有键值对的键和值的字符串长度都小于64字节</p></li><li class="list__item" id="-7de38a_100"><p id="-7de38a_102">哈希对象保存的键值对数量小于512个</p></li></ul><p id="-7de38a_96"><span class="control" id="-7de38a_103">特点</span>：</p><ul class="list _bullet" id="-7de38a_97"><li class="list__item" id="-7de38a_104"><p id="-7de38a_107">内存紧凑，节省空间</p></li><li class="list__item" id="-7de38a_105"><p id="-7de38a_108">顺序存储，查找需要遍历</p></li><li class="list__item" id="-7de38a_106"><p id="-7de38a_109">适合小数据量</p></li></ul></section><section class="chapter"><h3 id="2-hashtable" data-toc="2-hashtable">2. hashtable（哈希表）</h3><p id="-7de38a_110"><span class="control" id="-7de38a_115">使用条件</span>：</p><ul class="list _bullet" id="-7de38a_111"><li class="list__item" id="-7de38a_116"><p id="-7de38a_117">不满足ziplist条件时自动转换</p></li></ul><p id="-7de38a_112"><span class="control" id="-7de38a_118">特点</span>：</p><ul class="list _bullet" id="-7de38a_113"><li class="list__item" id="-7de38a_119"><p id="-7de38a_122">查找效率高，O(1)时间复杂度</p></li><li class="list__item" id="-7de38a_120"><p id="-7de38a_123">内存占用较大</p></li><li class="list__item" id="-7de38a_121"><p id="-7de38a_124">适合大数据量</p></li></ul><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 732.453125 550"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="732.453125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M383.223,62L392.589,66.167C401.956,70.333,420.689,78.667,430.055,84.917C439.422,91.167,439.422,95.333,439.422,98.833C439.422,102.333,439.422,105.167,439.422,106.583L439.422,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M252.478,62L241.668,66.167C230.858,70.333,209.237,78.667,198.427,91.5C187.617,104.333,187.617,121.667,187.617,141C187.617,160.333,187.617,181.667,188.713,198.417C189.809,215.167,192.001,227.333,194.075,238.844C196.148,250.354,198.104,261.209,199.082,266.636L200.059,272.063"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_2" d="M439.422,166L439.422,172.167C439.422,178.333,439.422,190.667,439.422,200.917C439.422,211.167,439.422,219.333,439.422,226.833C439.422,234.333,439.422,241.167,439.422,244.583L439.422,248"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_3" d="M523.141,163.925L545.016,170.437C566.891,176.95,610.641,189.975,632.516,199.571C654.391,209.167,654.391,215.333,654.391,220.833C654.391,226.333,654.391,231.167,654.391,233.583L654.391,236"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_4" d="M173.141,330L160.907,340.167C148.672,350.333,124.203,370.667,111.969,384.917C99.734,399.167,99.734,407.333,99.734,414.833C99.734,422.333,99.734,429.167,99.734,432.583L99.734,436"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_5" d="M238.124,330L250.359,340.167C262.593,350.333,287.062,370.667,299.297,382.917C311.531,395.167,311.531,399.333,311.531,402.833C311.531,406.333,311.531,409.167,311.531,410.583L311.531,412"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_6" d="M382.507,166L369.507,172.167C356.508,178.333,330.51,190.667,311.496,202.917C292.481,215.167,280.451,227.333,268.89,239.026C257.328,250.719,246.235,261.937,240.689,267.546L235.143,273.156"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(304.51171875, 203)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>转换</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(322.52734375, 35)" id="flowchart-A-8183" class="node default"><rect height="54" width="158.296875" y="-27" x="-79.1484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-49.1484375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="98.296875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Hash底层实现</p></span></div></foreignObject></g></g><g transform="translate(439.421875, 139)" id="flowchart-B-8184" class="node default"><rect height="54" width="167.4375" y="-27" x="-83.71875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-53.71875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="107.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist压缩列表</p></span></div></foreignObject></g></g><g transform="translate(205.6328125, 303)" id="flowchart-C-8186" class="node default"><rect height="54" width="177.765625" y="-27" x="-88.8828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-58.8828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="117.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>hashtable哈希表</p></span></div></foreignObject></g></g><g transform="translate(439.421875, 303)" id="flowchart-B1-8188" class="node default"><rect height="102" width="189.8125" y="-51" x="-94.90625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.90625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="129.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>条件:<br>键值长度&lt;64字节<br>键值对数量&lt;512个</p></span></div></foreignObject></g></g><g transform="translate(654.390625, 303)" id="flowchart-B2-8190" class="node default"><rect height="126" width="140.125" y="-63" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>特点:<br>内存紧凑<br>顺序存储<br>查找需遍历</p></span></div></foreignObject></g></g><g transform="translate(99.734375, 479)" id="flowchart-C1-8192" class="node default"><rect height="78" width="183.46875" y="-39" x="-91.734375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-61.734375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="123.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>条件:<br>不满足ziplist条件</p></span></div></foreignObject></g></g><g transform="translate(311.53125, 479)" id="flowchart-C2-8194" class="node default"><rect height="126" width="140.125" y="-63" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>特点:<br>O1查找<br>内存占用大<br>适合大数据</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q4-list-quicklist" data-toc="q4-list-quicklist">Q4: List类型的底层实现经历了哪些变化？quicklist是什么？</h2><p id="-7de38a_125"><span class="control" id="-7de38a_129">A4:</span> List类型的底层实现经历了三个阶段的演进：</p><section class="chapter"><h3 id="-7de38a_126" data-toc="-7de38a_126">演进历程：</h3><ol class="list _decimal" id="-7de38a_130" type="1"><li class="list__item" id="-7de38a_131"><p id="-7de38a_133"><span class="control" id="-7de38a_134">Redis 3.0之前</span>: ziplist + linkedlist</p></li><li class="list__item" id="-7de38a_132"><p id="-7de38a_135"><span class="control" id="-7de38a_136">Redis 3.2之后</span>: quicklist（当前实现）</p></li></ol></section><section class="chapter"><h3 id="quicklist" data-toc="quicklist">quicklist结构：</h3><p id="-7de38a_137">quicklist是ziplist和linkedlist的结合体，是一个由ziplist组成的双向链表。</p><div class="code-block" data-lang="c">
typedef struct quicklist {
    quicklistNode *head;    // 头节点
    quicklistNode *tail;    // 尾节点
    unsigned long count;    // 总元素数量
    unsigned long len;      // quicklistNode节点数量
    int fill : 16;          // 单个ziplist的大小限制
    unsigned int compress : 16; // 压缩深度
} quicklist;

typedef struct quicklistNode {
    struct quicklistNode *prev; // 前驱节点
    struct quicklistNode *next; // 后继节点
    unsigned char *zl;          // ziplist
    unsigned int sz;            // ziplist字节数
    unsigned int count : 16;    // ziplist元素数量
    unsigned int encoding : 2;  // 编码格式
    unsigned int container : 2; // 容器类型
    unsigned int recompress : 1; // 是否需要重新压缩
} quicklistNode;
</div></section><section class="chapter"><h3 id="quicklist" data-toc="quicklist">quicklist的优势：</h3><ol class="list _decimal" id="-7de38a_139" type="1"><li class="list__item" id="-7de38a_141"><p id="-7de38a_144"><span class="control" id="-7de38a_145">兼顾内存和性能</span> - 结合ziplist的内存效率和linkedlist的操作效率</p></li><li class="list__item" id="-7de38a_142"><p id="-7de38a_146"><span class="control" id="-7de38a_147">支持压缩</span> - 可以压缩中间节点，节省内存</p></li><li class="list__item" id="-7de38a_143"><p id="-7de38a_148"><span class="control" id="-7de38a_149">灵活配置</span> - 可以配置每个ziplist的大小</p></li></ol><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1054.203125 608"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1054.203125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M341.027,57.373L320.973,62.311C300.918,67.249,260.809,77.124,240.754,84.146C220.699,91.167,220.699,95.333,220.699,98.833C220.699,102.333,220.699,105.167,220.699,106.583L220.699,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M522.762,56.369L544.47,61.474C566.178,66.579,609.595,76.79,631.303,83.978C653.012,91.167,653.012,95.333,653.012,98.833C653.012,102.333,653.012,105.167,653.012,106.583L653.012,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_2" d="M158.945,166L149.415,170.167C139.885,174.333,120.825,182.667,111.296,188.917C101.766,195.167,101.766,199.333,101.766,202.833C101.766,206.333,101.766,209.167,101.766,210.583L101.766,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_3" d="M282.453,166L291.983,170.167C301.513,174.333,320.573,182.667,330.103,188.917C339.633,195.167,339.633,199.333,339.633,202.833C339.633,206.333,339.633,209.167,339.633,210.583L339.633,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_4" d="M596.409,166L587.675,170.167C578.94,174.333,561.47,182.667,552.735,188.917C544,195.167,544,199.333,544,202.833C544,206.333,544,209.167,544,210.583L544,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_5" d="M709.614,166L718.349,170.167C727.084,174.333,744.554,182.667,753.289,188.917C762.023,195.167,762.023,199.333,762.023,202.833C762.023,206.333,762.023,209.167,762.023,210.583L762.023,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_quicklist结构_11" d="M544,270L544,274.167C544,278.333,544,286.667,544,292.917C544,299.167,544,303.333,544,306.833C544,310.333,544,313.167,544,314.583L544,316"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(33.796875, 312)" class="root"><g class="clusters"><g data-look="classic" id="quicklist结构" class="cluster"><rect height="280" width="1004.40625" y="8" x="8" style=""></rect><g transform="translate(463.9140625, 8)" class="cluster-label"><foreignObject height="24" width="92.578125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>quicklist结构</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_6" d="M199,147L209.919,142.833C220.838,138.667,242.677,130.333,258.057,126.167C273.438,122,282.359,122,290.615,122C298.87,122,306.458,122,310.253,122L314.047,122"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_7" d="M471.546,95L482.466,90.833C493.385,86.667,515.224,78.333,530.604,74.167C545.984,70,554.906,70,563.161,70C571.417,70,579.005,70,582.799,70L586.594,70"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_8" d="M199,201L209.919,205.167C220.838,209.333,242.677,217.667,260.295,221.833C277.914,226,291.313,226,304.044,226C316.776,226,328.841,226,334.874,226L340.906,226"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_9" d="M471.546,149L482.466,153.167C493.385,157.333,515.224,165.667,532.842,169.833C550.461,174,563.859,174,576.591,174C589.323,174,601.388,174,607.421,174L613.453,174"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_F1_10" d="M756.078,70L765,70C773.922,70,791.766,70,805.148,70C818.531,70,827.453,70,835.708,70C843.964,70,851.552,70,855.346,70L859.141,70"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(264.515625, 226)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>包含</p></span></div></foreignObject></g></g><g transform="translate(537.0625, 174)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>包含</p></span></div></foreignObject></g></g><g transform="translate(809.609375, 70)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>包含</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(128.2421875, 174)" id="flowchart-D-8333" class="node default"><rect height="54" width="165.484375" y="-27" x="-82.7421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.7421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>quicklistNode1</p></span></div></foreignObject></g></g><g transform="translate(400.7890625, 122)" id="flowchart-E-8334" class="node default"><rect height="54" width="165.484375" y="-27" x="-82.7421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.7421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>quicklistNode2</p></span></div></foreignObject></g></g><g transform="translate(673.3359375, 70)" id="flowchart-F-8336" class="node default"><rect height="54" width="165.484375" y="-27" x="-82.7421875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.7421875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>quicklistNode3</p></span></div></foreignObject></g></g><g transform="translate(400.7890625, 226)" id="flowchart-D1-8338" class="node default"><rect height="54" width="111.765625" y="-27" x="-55.8828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.8828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist1</p></span></div></foreignObject></g></g><g transform="translate(673.3359375, 174)" id="flowchart-E1-8340" class="node default"><rect height="54" width="111.765625" y="-27" x="-55.8828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.8828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist2</p></span></div></foreignObject></g></g><g transform="translate(919.0234375, 70)" id="flowchart-F1-8342" class="node default"><rect height="54" width="111.765625" y="-27" x="-55.8828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.8828125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="51.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist3</p></span></div></foreignObject></g></g></g></g><g transform="translate(431.89453125, 35)" id="flowchart-A-8321" class="node default"><rect height="54" width="181.734375" y="-27" x="-90.8671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-60.8671875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="121.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>List底层实现演进</p></span></div></foreignObject></g></g><g transform="translate(220.69921875, 139)" id="flowchart-B-8322" class="node default"><rect height="54" width="141.0625" y="-27" x="-70.53125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.53125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="81.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis 3.0前</p></span></div></foreignObject></g></g><g transform="translate(653.01171875, 139)" id="flowchart-C-8324" class="node default"><rect height="54" width="141.0625" y="-27" x="-70.53125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.53125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="81.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis 3.2后</p></span></div></foreignObject></g></g><g transform="translate(101.765625, 243)" id="flowchart-B1-8326" class="node default"><rect height="54" width="187.53125" y="-27" x="-93.765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.765625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="127.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist + linkedlist</p></span></div></foreignObject></g></g><g transform="translate(339.6328125, 243)" id="flowchart-B2-8328" class="node default"><rect height="54" width="188.203125" y="-27" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>根据条件选择实现</p></span></div></foreignObject></g></g><g transform="translate(544, 243)" id="flowchart-C1-8330" class="node default"><rect height="54" width="120.53125" y="-27" x="-60.265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="60.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>quicklist</p></span></div></foreignObject></g></g><g transform="translate(762.0234375, 243)" id="flowchart-C2-8332" class="node default"><rect height="54" width="215.515625" y="-27" x="-107.7578125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-77.7578125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="155.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ziplist组成的双向链表</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q5-set-sorted-set" data-toc="q5-set-sorted-set">Q5: Set和Sorted Set的底层实现有什么区别？跳跃表是如何工作的？</h2><p id="-7de38a_150"><span class="control" id="-7de38a_155">A5:</span></p><section class="chapter"><h3 id="set" data-toc="set">Set的底层实现：</h3><ol class="list _decimal" id="-7de38a_156" type="1"><li class="list__item" id="-7de38a_157"><p id="-7de38a_159"><span class="control" id="-7de38a_160">intset（整数集合）</span> - 当所有元素都是整数且元素数量不超过512个</p></li><li class="list__item" id="-7de38a_158"><p id="-7de38a_161"><span class="control" id="-7de38a_162">hashtable（哈希表）</span> - 其他情况</p></li></ol></section><section class="chapter"><h3 id="sorted-set" data-toc="sorted-set">Sorted Set的底层实现：</h3><ol class="list _decimal" id="-7de38a_163" type="1"><li class="list__item" id="-7de38a_164"><p id="-7de38a_166"><span class="control" id="-7de38a_167">ziplist（压缩列表）</span> - 元素数量少且元素长度小时</p></li><li class="list__item" id="-7de38a_165"><p id="-7de38a_168"><span class="control" id="-7de38a_169">skiplist + hashtable</span> - 其他情况</p></li></ol></section><section class="chapter"><h3 id="skiplist" data-toc="skiplist">跳跃表（skiplist）工作原理：</h3><p id="-7de38a_170">跳跃表是一种有序数据结构，通过在每个节点中维持多个指向其他节点的指针来快速访问节点。</p><p id="-7de38a_171"><span class="control" id="-7de38a_174">特点</span>：</p><ul class="list _bullet" id="-7de38a_172"><li class="list__item" id="-7de38a_175"><p id="-7de38a_178">平均O(log N)的查找、插入、删除复杂度</p></li><li class="list__item" id="-7de38a_176"><p id="-7de38a_179">实现简单，比平衡树容易理解和实现</p></li><li class="list__item" id="-7de38a_177"><p id="-7de38a_180">支持范围查询</p></li></ul><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 881.21484375 892"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="881.21484375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="Level1" class="cluster"><rect height="545" width="217.07421875" y="339" x="8" style=""></rect><g transform="translate(93.208984375, 339)" class="cluster-label"><foreignObject height="24" width="46.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Level1</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="386" width="243.10546875" y="161" x="245.07421875" style=""></rect><g transform="translate(343.298828125, 161)" class="cluster-label"><foreignObject height="24" width="46.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Level2</p></span></div></foreignObject></g></g><g data-look="classic" id="Level3" class="cluster"><rect height="257" width="157.86328125" y="8" x="508.1796875" style=""></rect><g transform="translate(563.783203125, 8)" class="cluster-label"><foreignObject height="24" width="46.65625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Level3</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L3_1_L3_4_0" d="M586.417,87L588.153,93.167C589.889,99.333,593.36,111.667,595.096,124C596.832,136.333,596.832,148.667,596.832,156.917C596.832,165.167,596.832,169.333,596.832,172.833C596.832,176.333,596.832,179.167,596.832,180.583L596.832,182"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_1_L2_3_1" d="M325.065,240L326.509,244.167C327.952,248.333,330.839,256.667,332.283,267C333.727,277.333,333.727,289.667,333.727,302C333.727,314.333,333.727,326.667,333.727,334.917C333.727,343.167,333.727,347.333,333.727,350.833C333.727,354.333,333.727,357.167,333.727,358.583L333.727,360"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_3_L2_4_2" d="M355.857,418L359.272,422.167C362.687,426.333,369.517,434.667,374.64,440.917C379.763,447.167,383.178,451.333,386.171,454.984C389.163,458.635,391.733,461.771,393.018,463.339L394.303,464.906"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1_1_L1_2_3" d="M77.211,418L77.211,422.167C77.211,426.333,77.211,434.667,77.211,440.917C77.211,447.167,77.211,451.333,77.211,454.833C77.211,458.333,77.211,461.167,77.211,462.583L77.211,464"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1_2_L1_3_4" d="M77.211,522L77.211,526.167C77.211,530.333,77.211,538.667,77.211,547C77.211,555.333,77.211,563.667,77.612,569.917C78.012,576.167,78.814,580.333,79.489,583.845C80.164,587.357,80.714,590.215,80.988,591.643L81.263,593.072"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1_3_L1_4_5" d="M87.211,651L87.211,655.167C87.211,659.333,87.211,667.667,88.919,673.917C90.626,680.167,94.041,684.333,97.034,687.984C100.026,691.635,102.596,694.771,103.881,696.339L105.166,697.906"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L1_4_L1_5_6" d="M129.832,755L129.832,759.167C129.832,763.333,129.832,771.667,129.832,777.917C129.832,784.167,129.832,788.333,129.832,791.833C129.832,795.333,129.832,798.167,129.832,799.583L129.832,801"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L3_1_L2_1_7" d="M571.216,87L569.48,93.167C567.744,99.333,564.273,111.667,562.537,124C560.801,136.333,560.801,148.667,543.228,158.562C525.654,168.457,490.508,175.914,456.013,183.232C421.519,190.551,387.677,197.731,370.756,201.321L353.835,204.911"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_1_L1_1_8" d="M306.357,240L304.913,244.167C303.47,248.333,300.582,256.667,299.139,267C297.695,277.333,297.695,289.667,297.695,302C297.695,314.333,297.695,326.667,282.173,336.494C266.65,346.322,235.604,353.644,205.207,360.813C174.811,367.982,145.063,374.997,130.189,378.505L115.315,382.013"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L3_4_L2_4_9" d="M596.832,240L596.832,244.167C596.832,248.333,596.832,256.667,569.953,267C543.074,277.333,489.316,289.667,462.438,302C435.559,314.333,435.559,326.667,435.559,341.5C435.559,356.333,435.559,373.667,435.559,391C435.559,408.333,435.559,425.667,434.894,436.417C434.229,447.167,432.9,451.333,431.773,454.865C430.647,458.396,429.723,461.293,429.261,462.741L428.798,464.189"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_4_L1_4_10" d="M418.969,522L418.969,526.167C418.969,530.333,418.969,538.667,377.883,547C336.797,555.333,254.625,563.667,213.539,576.5C172.453,589.333,172.453,606.667,172.453,624C172.453,641.333,172.453,658.667,170.746,669.417C169.038,680.167,165.623,684.333,162.63,687.984C159.638,691.635,157.068,694.771,155.783,696.339L154.498,697.906"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L2_3_L1_3_11" d="M325.403,418L324.118,422.167C322.834,426.333,320.264,434.667,318.98,447.5C317.695,460.333,317.695,477.667,317.695,495C317.695,512.333,317.695,529.667,284.718,542.5C251.741,555.333,185.786,563.667,151.502,569.917C117.218,576.167,114.604,580.333,112.345,583.935C110.085,587.537,108.18,590.574,107.227,592.093L106.274,593.612"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(560.80078125, 124)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>向下</p></span></div></foreignObject></g></g><g transform="translate(297.6953125, 302)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>向下</p></span></div></foreignObject></g></g><g transform="translate(435.55859375, 391)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>向下</p></span></div></foreignObject></g></g><g transform="translate(172.453125, 624)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>向下</p></span></div></foreignObject></g></g><g transform="translate(317.6953125, 495)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>向下</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(787.12890625, 60)" id="flowchart-A-8482" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>跳跃表结构示例</p></span></div></foreignObject></g></g><g transform="translate(578.81640625, 60)" id="flowchart-L3_1-8483" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>1</p></span></div></foreignObject></g></g><g transform="translate(596.83203125, 213)" id="flowchart-L3_4-8484" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>4</p></span></div></foreignObject></g></g><g transform="translate(315.7109375, 213)" id="flowchart-L2_1-8485" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>1</p></span></div></foreignObject></g></g><g transform="translate(333.7265625, 391)" id="flowchart-L2_3-8486" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>3</p></span></div></foreignObject></g></g><g transform="translate(418.96875, 495)" id="flowchart-L2_4-8487" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>4</p></span></div></foreignObject></g></g><g transform="translate(77.2109375, 391)" id="flowchart-L1_1-8488" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>1</p></span></div></foreignObject></g></g><g transform="translate(77.2109375, 495)" id="flowchart-L1_2-8489" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>2</p></span></div></foreignObject></g></g><g transform="translate(87.2109375, 624)" id="flowchart-L1_3-8490" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>3</p></span></div></foreignObject></g></g><g transform="translate(129.83203125, 728)" id="flowchart-L1_4-8491" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>4</p></span></div></foreignObject></g></g><g transform="translate(129.83203125, 832)" id="flowchart-L1_5-8492" class="node default"><rect height="54" width="68.421875" y="-27" x="-34.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-4.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="8.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>5</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h3 id="sorted-set-skiplist" data-toc="sorted-set-skiplist">为什么Sorted Set使用skiplist而不是平衡树？</h3><ol class="list _decimal" id="-7de38a_181" type="1"><li class="list__item" id="-7de38a_183"><p id="-7de38a_187"><span class="control" id="-7de38a_188">范围查询效率高</span> - 跳跃表的有序性使得范围查询更简单</p></li><li class="list__item" id="-7de38a_184"><p id="-7de38a_189"><span class="control" id="-7de38a_190">实现简单</span> - 比红黑树、AVL树实现简单</p></li><li class="list__item" id="-7de38a_185"><p id="-7de38a_191"><span class="control" id="-7de38a_192">内存局部性好</span> - 相邻元素在内存中相邻</p></li><li class="list__item" id="-7de38a_186"><p id="-7de38a_193"><span class="control" id="-7de38a_194">支持并发</span> - 更容易实现无锁操作</p></li></ol><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 677.046875 694"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="677.046875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M128.709,320L145.828,298.5C162.947,277,197.184,234,216.386,212.5C235.589,191,239.755,191,243.255,191C246.755,191,249.589,191,251.005,191L252.422,191"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_1" d="M344.257,164L357.514,142.5C370.77,121,397.284,78,415.294,56.5C433.305,35,442.813,35,451.654,35C460.495,35,468.669,35,472.757,35L476.844,35"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_2" d="M377.553,164L385.26,159.833C392.968,155.667,408.382,147.333,422.179,143.167C435.975,139,448.154,139,459.665,139C471.177,139,482.022,139,487.445,139L492.867,139"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B3_3" d="M377.553,218L385.26,222.167C392.968,226.333,408.382,234.667,420.843,238.833C433.305,243,442.813,243,451.654,243C460.495,243,468.669,243,472.757,243L476.844,243"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B4_4" d="M344.257,218L357.514,239.5C370.77,261,397.284,304,416.629,325.5C435.975,347,448.154,347,459.665,347C471.177,347,482.022,347,487.445,347L492.867,347"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_5" d="M123.334,374L141.349,404.167C159.364,434.333,195.393,494.667,216.321,524.833C237.25,555,243.078,555,248.24,555C253.401,555,257.896,555,260.143,555L262.391,555"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M352.581,528L364.45,515.167C376.32,502.333,400.058,476.667,416.282,463.833C432.507,451,441.216,451,449.259,451C457.302,451,464.678,451,468.367,451L472.055,451"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_7" d="M388.828,555L394.656,555C400.484,555,412.141,555,422.055,555C431.97,555,440.143,555,447.65,555C455.156,555,461.996,555,465.416,555L468.836,555"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C3_8" d="M352.581,582L364.45,594.833C376.32,607.667,400.058,633.333,414.011,646.167C427.964,659,432.13,659,435.63,659C439.13,659,441.964,659,443.38,659L444.797,659"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(107.2109375, 347)" id="flowchart-A-8653" class="node default"><rect height="54" width="198.421875" y="-27" x="-99.2109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-69.2109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="138.421875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Sorted Set实现选择</p></span></div></foreignObject></g></g><g transform="translate(327.609375, 191)" id="flowchart-B-8654" class="node default"><rect height="54" width="142.375" y="-27" x="-71.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.1875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="82.375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>skiplist优势</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 35)" id="flowchart-B1-8656" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>范围查询高效</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 139)" id="flowchart-B2-8658" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实现简单</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 243)" id="flowchart-B3-8660" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内存局部性好</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 347)" id="flowchart-B4-8662" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>支持并发</p></span></div></foreignObject></g></g><g transform="translate(327.609375, 555)" id="flowchart-C-8664" class="node default"><rect height="54" width="122.4375" y="-27" x="-61.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.21875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="62.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>vs平衡树</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 451)" id="flowchart-C1-8666" class="node default"><rect height="54" width="165.734375" y="-27" x="-82.8671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.8671875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>AVL树旋转复杂</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 555)" id="flowchart-C2-8668" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>红黑树实现复杂</p></span></div></foreignObject></g></g><g transform="translate(558.921875, 659)" id="flowchart-C3-8670" class="node default"><rect height="54" width="220.25" y="-27" x="-110.125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-80.125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="160.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>范围查询需要中序遍历</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q6-redis" data-toc="q6-redis">Q6: Redis的高级数据类型有哪些？它们的应用场景是什么？</h2><p id="-7de38a_195"><span class="control" id="-7de38a_200">A6:</span> Redis提供了4种高级数据类型：</p><section class="chapter"><h3 id="1-bitmap" data-toc="1-bitmap">1. Bitmap（位图）</h3><ul class="list _bullet" id="-7de38a_201"><li class="list__item" id="-7de38a_202"><p id="-7de38a_206"><span class="control" id="-7de38a_207">原理</span>: 基于String类型，按位操作</p></li><li class="list__item" id="-7de38a_203"><p id="-7de38a_208"><span class="control" id="-7de38a_209">应用场景</span>: 用户签到、在线用户统计、布隆过滤器</p></li><li class="list__item" id="-7de38a_204"><p id="-7de38a_210"><span class="control" id="-7de38a_211">常用命令</span>: SETBIT、GETBIT、BITCOUNT、BITOP</p></li><li class="list__item" id="-7de38a_205"><p id="-7de38a_212"><span class="control" id="-7de38a_213">优势</span>: 极大节省内存空间</p></li></ul></section><section class="chapter"><h3 id="2-hyperloglog" data-toc="2-hyperloglog">2. HyperLogLog</h3><ul class="list _bullet" id="-7de38a_214"><li class="list__item" id="-7de38a_215"><p id="-7de38a_219"><span class="control" id="-7de38a_220">原理</span>: 基数统计的概率数据结构</p></li><li class="list__item" id="-7de38a_216"><p id="-7de38a_221"><span class="control" id="-7de38a_222">应用场景</span>: 大数据量下的唯一值计数（UV统计）</p></li><li class="list__item" id="-7de38a_217"><p id="-7de38a_223"><span class="control" id="-7de38a_224">常用命令</span>: PFADD、PFCOUNT、PFMERGE</p></li><li class="list__item" id="-7de38a_218"><p id="-7de38a_225"><span class="control" id="-7de38a_226">优势</span>: 固定12KB内存，可统计2^64个元素</p></li></ul></section><section class="chapter"><h3 id="3-geospatial" data-toc="3-geospatial">3. Geospatial（地理位置）</h3><ul class="list _bullet" id="-7de38a_227"><li class="list__item" id="-7de38a_228"><p id="-7de38a_232"><span class="control" id="-7de38a_233">原理</span>: 基于Sorted Set实现，使用geohash算法</p></li><li class="list__item" id="-7de38a_229"><p id="-7de38a_234"><span class="control" id="-7de38a_235">应用场景</span>: LBS应用、附近的人、地理围栏</p></li><li class="list__item" id="-7de38a_230"><p id="-7de38a_236"><span class="control" id="-7de38a_237">常用命令</span>: GEOADD、GEODIST、GEORADIUS、GEOPOS</p></li><li class="list__item" id="-7de38a_231"><p id="-7de38a_238"><span class="control" id="-7de38a_239">优势</span>: 支持地理位置计算和查询</p></li></ul></section><section class="chapter"><h3 id="4-stream" data-toc="4-stream">4. Stream（流）</h3><ul class="list _bullet" id="-7de38a_240"><li class="list__item" id="-7de38a_244"><p id="-7de38a_248"><span class="control" id="-7de38a_249">原理</span>: Redis 5.0新增，专门用于消息队列</p></li><li class="list__item" id="-7de38a_245"><p id="-7de38a_250"><span class="control" id="-7de38a_251">应用场景</span>: 消息队列、事件溯源、日志收集</p></li><li class="list__item" id="-7de38a_246"><p id="-7de38a_252"><span class="control" id="-7de38a_253">常用命令</span>: XADD、XREAD、XGROUP、XACK</p></li><li class="list__item" id="-7de38a_247"><p id="-7de38a_254"><span class="control" id="-7de38a_255">优势</span>: 支持消费者组、消息确认、持久化</p></li></ul><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1406.921875 326"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1406.921875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M626.676,44.147L551.084,51.289C475.492,58.431,324.309,72.716,248.717,81.941C173.125,91.167,173.125,95.333,173.125,98.833C173.125,102.333,173.125,105.167,173.125,106.583L173.125,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M633.078,62L619.126,66.167C605.175,70.333,577.273,78.667,563.322,84.917C549.371,91.167,549.371,95.333,549.371,98.833C549.371,102.333,549.371,105.167,549.371,106.583L549.371,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M815.962,62L830.234,66.167C844.506,70.333,873.05,78.667,887.322,84.917C901.594,91.167,901.594,95.333,901.594,98.833C901.594,102.333,901.594,105.167,901.594,106.583L901.594,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M820.285,44.564L891.873,51.637C963.461,58.709,1106.637,72.855,1178.225,82.011C1249.813,91.167,1249.813,95.333,1249.813,98.833C1249.813,102.333,1249.813,105.167,1249.813,106.583L1249.813,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_4" d="M123.766,166L116.148,170.167C108.531,174.333,93.297,182.667,85.68,188.917C78.063,195.167,78.063,199.333,78.063,202.833C78.063,206.333,78.063,209.167,78.063,210.583L78.063,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_5" d="M502.091,166L494.794,170.167C487.498,174.333,472.905,182.667,465.609,188.917C458.313,195.167,458.313,199.333,458.313,202.833C458.313,206.333,458.313,209.167,458.313,210.583L458.313,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_6" d="M856.392,166L849.417,170.167C842.441,174.333,828.49,182.667,821.515,188.917C814.539,195.167,814.539,199.333,814.539,202.833C814.539,206.333,814.539,209.167,814.539,210.583L814.539,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_7" d="M1204.611,166L1197.635,170.167C1190.66,174.333,1176.709,182.667,1169.733,188.917C1162.758,195.167,1162.758,199.333,1162.758,202.833C1162.758,206.333,1162.758,209.167,1162.758,210.583L1162.758,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_8" d="M222.484,166L230.102,170.167C237.719,174.333,252.953,182.667,260.57,189.917C268.188,197.167,268.188,203.333,268.188,208.833C268.188,214.333,268.188,219.167,268.188,221.583L268.188,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_9" d="M596.652,166L603.948,170.167C611.244,174.333,625.837,182.667,633.133,189.917C640.43,197.167,640.43,203.333,640.43,208.833C640.43,214.333,640.43,219.167,640.43,221.583L640.43,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D2_10" d="M946.795,166L953.771,170.167C960.746,174.333,974.697,182.667,981.673,189.917C988.648,197.167,988.648,203.333,988.648,208.833C988.648,214.333,988.648,219.167,988.648,221.583L988.648,224"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E2_11" d="M1295.014,166L1301.99,170.167C1308.965,174.333,1322.916,182.667,1329.892,189.917C1336.867,197.167,1336.867,203.333,1336.867,208.833C1336.867,214.333,1336.867,219.167,1336.867,221.583L1336.867,224"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(723.48046875, 35)" id="flowchart-A-8714" class="node default"><rect height="54" width="193.609375" y="-27" x="-96.8046875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.8046875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="133.609375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis高级数据类型</p></span></div></foreignObject></g></g><g transform="translate(173.125, 139)" id="flowchart-B-8715" class="node default"><rect height="54" width="110.71875" y="-27" x="-55.359375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.359375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="50.71875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Bitmap</p></span></div></foreignObject></g></g><g transform="translate(549.37109375, 139)" id="flowchart-C-8717" class="node default"><rect height="54" width="151.921875" y="-27" x="-75.9609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.9609375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="91.921875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>HyperLogLog</p></span></div></foreignObject></g></g><g transform="translate(901.59375, 139)" id="flowchart-D-8719" class="node default"><rect height="54" width="136.203125" y="-27" x="-68.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-38.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="76.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Geospatial</p></span></div></foreignObject></g></g><g transform="translate(1249.8125, 139)" id="flowchart-E-8721" class="node default"><rect height="54" width="110.828125" y="-27" x="-55.4140625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.4140625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="50.828125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Stream</p></span></div></foreignObject></g></g><g transform="translate(78.0625, 267)" id="flowchart-B1-8723" class="node default"><rect height="102" width="140.125" y="-51" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>用户签到<br>在线统计<br>布隆过滤器</p></span></div></foreignObject></g></g><g transform="translate(458.3125, 267)" id="flowchart-C1-8725" class="node default"><rect height="102" width="140.125" y="-51" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>UV统计<br>去重计数<br>大数据分析</p></span></div></foreignObject></g></g><g transform="translate(814.5390625, 267)" id="flowchart-D1-8727" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LBS应用<br>附近的人<br>地理围栏</p></span></div></foreignObject></g></g><g transform="translate(1162.7578125, 267)" id="flowchart-E1-8729" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>消息队列<br>事件溯源<br>日志收集</p></span></div></foreignObject></g></g><g transform="translate(268.1875, 267)" id="flowchart-B2-8731" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>节省内存<br>位操作高效</p></span></div></foreignObject></g></g><g transform="translate(640.4296875, 267)" id="flowchart-C2-8733" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>固定内存<br>概率统计</p></span></div></foreignObject></g></g><g transform="translate(988.6484375, 267)" id="flowchart-D2-8735" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>地理计算<br>距离查询</p></span></div></foreignObject></g></g><g transform="translate(1336.8671875, 267)" id="flowchart-E2-8737" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>消费者组<br>消息确认</p></span></div></foreignObject></g></g></g></g></g></svg><p id="-7de38a_243"><span class="control" id="-7de38a_256">第二阶段完成！</span> 已创建Redis数据结构的QA文档，涵盖了5种基本数据类型和4种高级数据类型的详细问答和图解。</p></section></section><div class="last-modified">28 五月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="redis基础概念qa.html" class="navigation-links__prev">Redis 基础概念 QA</a><a href="redis持久化qa.html" class="navigation-links__next">Redis 持久化 QA</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>