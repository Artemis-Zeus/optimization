<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-10T01:18:22.6781522"><title>Redis 性能优化与应用场景 QA | 技术知识库</title><script type="application/json" id="virtual-toc-data">[{"id":"q1-redis","level":0,"title":"Q1: Redis集群模式是如何工作的？数据是如何分片的？","anchor":"#q1-redis"},{"id":"q2-redis","level":0,"title":"Q2: 如何进行Redis性能优化？有哪些关键的性能指标？","anchor":"#q2-redis"},{"id":"q3-redis","level":0,"title":"Q3: Redis在实际项目中有哪些常见的应用场景？如何设计和实现？","anchor":"#q3-redis"},{"id":"-sncu0e_6","level":0,"title":"总结","anchor":"#-sncu0e_6"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Redis 性能优化与应用场景 QA | 技术知识库"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术知识库 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/redis性能优化与应用场景qa.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Redis 性能优化与应用场景 QA | 技术知识库"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/redis性能优化与应用场景qa.html#webpage",
    "url": "writerside-documentation/redis性能优化与应用场景qa.html",
    "name": "Redis 性能优化与应用场景 QA | 技术知识库",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术知识库 Help"
}</script><!-- End Schema.org --></head><body data-id="Redis性能优化与应用场景QA" data-main-title="Redis 性能优化与应用场景 QA" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Redis面试大纲.md|Redis 技术大纲"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术知识库  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Redis性能优化与应用场景QA" id="Redis性能优化与应用场景QA.md">Redis 性能优化与应用场景 QA</h1><section class="chapter"><h2 id="q1-redis" data-toc="q1-redis">Q1: Redis集群模式是如何工作的？数据是如何分片的？</h2><p id="-sncu0e_7"><span class="control" id="-sncu0e_12">A1:</span></p><section class="chapter"><h3 id="redis" data-toc="redis">Redis集群概述</h3><p id="-sncu0e_13">Redis Cluster是Redis的分布式解决方案，提供数据分片和高可用功能：</p><section class="chapter"><h4 id="1" data-toc="1">1. 集群特点</h4><ul class="list _bullet" id="-sncu0e_16"><li class="list__item" id="-sncu0e_17"><p id="-sncu0e_21"><span class="control" id="-sncu0e_22">去中心化</span>: 没有中心节点，所有节点地位平等</p></li><li class="list__item" id="-sncu0e_18"><p id="-sncu0e_23"><span class="control" id="-sncu0e_24">数据分片</span>: 自动将数据分布到多个节点</p></li><li class="list__item" id="-sncu0e_19"><p id="-sncu0e_25"><span class="control" id="-sncu0e_26">高可用</span>: 支持主从复制和自动故障转移</p></li><li class="list__item" id="-sncu0e_20"><p id="-sncu0e_27"><span class="control" id="-sncu0e_28">水平扩展</span>: 支持在线添加和删除节点</p></li></ul></section><section class="chapter"><h4 id="2" data-toc="2">2. 集群架构</h4><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 785.69921875 904"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="785.69921875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="客户端" class="cluster"><rect height="104" width="729.04296875" y="8" x="18" style=""></rect><g transform="translate(358.482421875, 8)" class="cluster-label"><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端</p></span></div></foreignObject></g></g><g data-look="classic" id="Redis集群" class="cluster"><rect height="710" width="769.69921875" y="186" x="8" style=""></rect><g transform="translate(358.091796875, 186)" class="cluster-label"><foreignObject height="24" width="69.515625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis集群</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph2" class="cluster"><rect height="281" width="418.48046875" y="590" x="28" style=""></rect><g transform="translate(163.662109375, 590)" class="cluster-label"><foreignObject height="24" width="147.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分片3 (10923-16383)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="330" width="209.890625" y="388" x="547.80859375" style=""></rect><g transform="translate(583.37890625, 388)" class="cluster-label"><foreignObject height="24" width="138.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分片2 (5461-10922)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="305" width="343.98046875" y="211" x="183.828125" style=""></rect><g transform="translate(303.279296875, 211)" class="cluster-label"><foreignObject height="24" width="105.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分片1 (0-5460)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M1_S1_0" d="M325.906,314L317.29,320.167C308.674,326.333,291.442,338.667,282.827,351C274.211,363.333,274.211,375.667,274.211,383.917C274.211,392.167,274.211,396.333,274.211,399.833C274.211,403.333,274.211,406.167,274.211,407.583L274.211,409"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M2_S2_1" d="M656.377,491L657.776,495.167C659.175,499.333,661.974,507.667,663.374,518C664.773,528.333,664.773,540.667,664.773,553C664.773,565.333,664.773,577.667,664.773,585.917C664.773,594.167,664.773,598.333,664.773,601.833C664.773,605.333,664.773,608.167,664.773,609.583L664.773,611"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M3_S3_2" d="M231.324,693L231.324,697.167C231.324,701.333,231.324,709.667,231.324,718C231.324,726.333,231.324,734.667,231.324,740.917C231.324,747.167,231.324,751.333,231.324,754.833C231.324,758.333,231.324,761.167,231.324,762.583L231.324,764"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M1_M2_3" d="M431.546,314L439.634,320.167C447.722,326.333,463.898,338.667,471.986,351C480.074,363.333,480.074,375.667,488.635,385.191C497.197,394.715,514.319,401.429,530.821,407.9C547.323,414.371,563.204,420.599,571.144,423.713L579.085,426.827"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M2_M3_4" d="M627.288,491L625.58,495.167C623.872,499.333,620.456,507.667,618.747,518C617.039,528.333,617.039,540.667,617.039,553C617.039,565.333,617.039,577.667,589.935,588.331C562.831,598.994,508.624,607.989,455.074,616.874C401.524,625.76,348.631,634.536,322.185,638.924L295.739,643.312"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M3_M1_5" d="M291.793,629.416L307.952,622.847C324.111,616.278,356.428,603.139,372.587,590.403C388.746,577.667,388.746,565.333,388.746,553C388.746,540.667,388.746,528.333,388.746,511.5C388.746,494.667,388.746,473.333,388.746,452C388.746,430.667,388.746,409.333,388.746,392.5C388.746,375.667,388.746,363.333,388.407,354.083C388.068,344.833,387.391,338.667,386.786,333.163C386.181,327.659,385.649,322.817,385.383,320.397L385.117,317.976"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_M1_6" d="M301.371,87L300.701,91.167C300.032,95.333,298.694,103.667,298.025,114C297.355,124.333,297.355,136.667,297.355,149C297.355,161.333,297.355,173.667,297.355,184C297.355,194.333,297.355,202.667,300.059,208.917C302.762,215.167,308.168,219.333,313.046,223.093C317.924,226.853,322.274,230.205,324.449,231.882L326.624,233.558"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_M2_7" d="M363.746,69.741L405.712,76.784C447.678,83.827,531.611,97.914,573.577,111.123C615.543,124.333,615.543,136.667,615.543,149C615.543,161.333,615.543,173.667,615.543,184C615.543,194.333,615.543,202.667,615.543,217.5C615.543,232.333,615.543,253.667,615.543,277C615.543,300.333,615.543,325.667,615.543,344.5C615.543,363.333,615.543,375.667,616.446,383.917C617.349,392.167,619.154,396.333,620.695,399.888C622.235,403.443,623.511,406.387,624.148,407.858L624.786,409.33"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C1_M3_8" d="M247.668,73.645L220.477,80.037C193.285,86.43,138.902,99.215,111.711,111.774C84.52,124.333,84.52,136.667,84.52,149C84.52,161.333,84.52,173.667,84.52,184C84.52,194.333,84.52,202.667,84.52,217.5C84.52,232.333,84.52,253.667,84.52,277C84.52,300.333,84.52,325.667,84.52,344.5C84.52,363.333,84.52,375.667,84.52,392.5C84.52,409.333,84.52,430.667,84.52,452C84.52,473.333,84.52,494.667,84.52,511.5C84.52,528.333,84.52,540.667,84.52,553C84.52,565.333,84.52,577.667,91.714,586.97C98.909,596.273,113.298,602.546,127.076,608.553C140.855,614.559,154.022,620.3,160.605,623.17L167.189,626.04"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C2_M1_9" d="M470.897,87L470.76,91.167C470.623,95.333,470.348,103.667,470.211,114C470.074,124.333,470.074,136.667,470.074,149C470.074,161.333,470.074,173.667,470.074,184C470.074,194.333,470.074,202.667,467.155,208.917C464.236,215.167,458.397,219.333,453.101,223.113C447.805,226.892,443.052,230.284,440.676,231.98L438.299,233.676"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C2_M2_10" d="M529.824,73.797L556.607,80.165C583.391,86.532,636.957,99.266,663.74,111.8C690.523,124.333,690.523,136.667,690.523,149C690.523,161.333,690.523,173.667,690.523,184C690.523,194.333,690.523,202.667,690.523,217.5C690.523,232.333,690.523,253.667,690.523,277C690.523,300.333,690.523,325.667,690.523,344.5C690.523,363.333,690.523,375.667,688.985,383.917C687.448,392.167,684.372,396.333,681.692,399.964C679.012,403.594,676.728,406.688,675.586,408.235L674.444,409.782"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C2_M3_11" d="M413.746,69.315L369.421,76.429C325.096,83.543,236.447,97.772,192.122,111.053C147.797,124.333,147.797,136.667,147.797,149C147.797,161.333,147.797,173.667,147.797,184C147.797,194.333,147.797,202.667,147.797,217.5C147.797,232.333,147.797,253.667,147.797,277C147.797,300.333,147.797,325.667,147.797,344.5C147.797,363.333,147.797,375.667,147.797,392.5C147.797,409.333,147.797,430.667,147.797,452C147.797,473.333,147.797,494.667,147.797,511.5C147.797,528.333,147.797,540.667,147.797,553C147.797,565.333,147.797,577.667,150.516,585.917C153.235,594.167,158.673,598.333,163.582,602.095C168.49,605.856,172.87,609.211,175.06,610.889L177.25,612.567"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(480.07421875, 351)" class="edgeLabel"><g transform="translate(-22.9921875, -12)" class="label"><foreignObject height="24" width="45.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Gossip</p></span></div></foreignObject></g></g><g transform="translate(617.0390625, 553)" class="edgeLabel"><g transform="translate(-22.9921875, -12)" class="label"><foreignObject height="24" width="45.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Gossip</p></span></div></foreignObject></g></g><g transform="translate(388.74609375, 452)" class="edgeLabel"><g transform="translate(-22.9921875, -12)" class="label"><foreignObject height="24" width="45.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Gossip</p></span></div></foreignObject></g></g><g transform="translate(297.35546875, 149)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g><g transform="translate(615.54296875, 275)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g><g transform="translate(84.51953125, 351)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g><g transform="translate(470.07421875, 149)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g><g transform="translate(690.5234375, 275)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g><g transform="translate(147.796875, 351)" class="edgeLabel"><g transform="translate(-16.03125, -12)" class="label"><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>连接</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(380.39453125, 275)" id="flowchart-M1-6895" class="node default"><rect height="78" width="120.9375" y="-39" x="-60.46875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.46875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="60.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Master 1<br>6379</p></span></div></foreignObject></g></g><g transform="translate(274.2109375, 452)" id="flowchart-S1-6896" class="node default"><rect height="78" width="110.765625" y="-39" x="-55.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.3828125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="50.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Slave 1<br>6380</p></span></div></foreignObject></g></g><g transform="translate(643.27734375, 452)" id="flowchart-M2-6897" class="node default"><rect height="78" width="120.9375" y="-39" x="-60.46875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.46875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="60.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Master 2<br>6381</p></span></div></foreignObject></g></g><g transform="translate(664.7734375, 654)" id="flowchart-S2-6898" class="node default"><rect height="78" width="110.765625" y="-39" x="-55.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.3828125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="50.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Slave 2<br>6382</p></span></div></foreignObject></g></g><g transform="translate(231.32421875, 654)" id="flowchart-M3-6899" class="node default"><rect height="78" width="120.9375" y="-39" x="-60.46875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-30.46875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="60.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Master 3<br>6383</p></span></div></foreignObject></g></g><g transform="translate(231.32421875, 807)" id="flowchart-S3-6900" class="node default"><rect height="78" width="110.765625" y="-39" x="-55.3828125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-25.3828125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="50.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Slave 3<br>6384</p></span></div></foreignObject></g></g><g transform="translate(305.70703125, 60)" id="flowchart-C1-6901" class="node default"><rect height="54" width="116.078125" y="-27" x="-58.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="56.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Client 1</p></span></div></foreignObject></g></g><g transform="translate(471.78515625, 60)" id="flowchart-C2-6902" class="node default"><rect height="54" width="116.078125" y="-27" x="-58.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-28.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="56.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Client 2</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h3 id="-sncu0e_9" data-toc="-sncu0e_9">数据分片机制</h3><section class="chapter"><h4 id="1-hash-slot" data-toc="1-hash-slot">1. 哈希槽（Hash Slot）</h4><p id="-sncu0e_33">Redis集群使用16384个哈希槽来分片数据：</p><div class="code-block" data-lang="python">
# 计算key所属的槽位
def calculate_slot(key):
    import crc16
    return crc16.crc16xmodem(key.encode()) % 16384

# 示例
print(calculate_slot(&quot;user:1001&quot;))  # 输出: 9842
print(calculate_slot(&quot;user:1002&quot;))  # 输出: 5649
</div></section><section class="chapter"><h4 id="2" data-toc="2">2. 槽位分配</h4><div class="code-block" data-lang="bash">
# 16384个槽位平均分配给3个主节点
# 节点1: 0-5460     (5461个槽位)
# 节点2: 5461-10922 (5462个槽位)  
# 节点3: 10923-16383 (5461个槽位)
</div></section><section class="chapter"><h4 id="3" data-toc="3">3. 数据路由流程</h4><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 995 745" style="max-width: 995px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="Node3" height="65" width="150" stroke="#666" fill="#eaeaea" y="659" x="745"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="691.5" x="820"><tspan dy="0" x="820">节点3</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Node2" height="65" width="150" stroke="#666" fill="#eaeaea" y="659" x="545"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="691.5" x="620"><tspan dy="0" x="620">节点2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Node1" height="65" width="150" stroke="#666" fill="#eaeaea" y="659" x="319"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="691.5" x="394"><tspan dy="0" x="394">节点1</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="659" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="691.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g><g><line name="Node3" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="659" x2="820" y1="5" x1="820" id="actor258"></line><g id="root-258"><rect class="actor actor-top" ry="3" rx="3" name="Node3" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="745"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="820"><tspan dy="0" x="820">节点3</tspan></text></g></g><g><line name="Node2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="659" x2="620" y1="5" x1="620" id="actor257"></line><g id="root-257"><rect class="actor actor-top" ry="3" rx="3" name="Node2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="545"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="620"><tspan dy="0" x="620">节点2</tspan></text></g></g><g><line name="Node1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="659" x2="394" y1="5" x1="394" id="actor256"></line><g id="root-256"><rect class="actor actor-top" ry="3" rx="3" name="Node1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="319"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="394"><tspan dy="0" x="394">节点1</tspan></text></g></g><g><line name="Client" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="659" x2="75" y1="5" x1="75" id="actor255"></line><g id="root-255"><rect class="actor actor-top" ry="3" rx="3" name="Client" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">客户端</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><line class="loopLine" y2="279" x2="631" y1="279" x1="64"></line><line class="loopLine" y2="639" x2="631" y1="279" x1="631"></line><line class="loopLine" y2="639" x2="631" y1="639" x1="64"></line><line class="loopLine" y2="639" x2="64" y1="279" x1="64"></line><line style="stroke-dasharray: 3, 3;" class="loopLine" y2="455" x2="631" y1="455" x1="64"></line><polygon class="labelBox" points="64,279 114,279 114,292 105.6,299 64,299"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="292" x="89">alt</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="297" x="372.5"><tspan x="372.5">[槽位属于本节点]</tspan></text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="473" x="347.5">[槽位不属于本节点]</text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="233">SET user:1001 data</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="113" x2="390" y1="113" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="128" x="395">计算槽位: CRC16(user:1001) % 16384 = 9842</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 395,161 C 455,151 455,191 395,181"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="206" x="395">检查槽位9842是否属于本节点</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 395,239 C 455,229 455,269 395,259"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="329" x="395">直接处理请求</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 395,362 C 455,352 455,392 395,382"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="407" x="236">OK</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="440" x2="79" y1="440" x1="393"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="500" x="236">MOVED 9842 192.168.1.102:6379</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="533" x2="79" y1="533" x1="393"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="548" x="346">SET user:1001 data</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="581" x2="616" y1="581" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="596" x="349">OK</text><line style="stroke-dasharray: 3, 3; fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine1" y2="629" x2="79" y1="629" x1="619"></line></svg></section></section><section class="chapter"><h3 id="-sncu0e_10" data-toc="-sncu0e_10">集群配置和部署</h3><section class="chapter"><h4 id="1" data-toc="1">1. 节点配置</h4><div class="code-block" data-lang="bash">
# redis.conf 集群配置
port 6379
cluster-enabled yes                    # 启用集群模式
cluster-config-file nodes-6379.conf   # 集群配置文件
cluster-node-timeout 15000            # 节点超时时间
cluster-announce-ip 192.168.1.100     # 节点IP
cluster-announce-port 6379             # 节点端口
cluster-announce-bus-port 16379        # 集群总线端口
</div></section><section class="chapter"><h4 id="2" data-toc="2">2. 创建集群</h4><div class="code-block" data-lang="bash">
# Redis 5.0+ 使用redis-cli创建集群
redis-cli --cluster create \
  192.168.1.100:6379 192.168.1.101:6379 192.168.1.102:6379 \
  192.168.1.100:6380 192.168.1.101:6380 192.168.1.102:6380 \
  --cluster-replicas 1

# 检查集群状态
redis-cli --cluster check 192.168.1.100:6379
</div></section><section class="chapter"><h4 id="3" data-toc="3">3. 集群管理命令</h4><div class="code-block" data-lang="bash">
# 查看集群信息
CLUSTER INFO

# 查看集群节点
CLUSTER NODES

# 查看槽位分配
CLUSTER SLOTS

# 添加节点
redis-cli --cluster add-node 192.168.1.103:6379 192.168.1.100:6379

# 删除节点
redis-cli --cluster del-node 192.168.1.100:6379 &lt;node-id&gt;

# 重新分片
redis-cli --cluster reshard 192.168.1.100:6379
</div></section></section><section class="chapter"><h3 id="-sncu0e_11" data-toc="-sncu0e_11">集群的优缺点</h3><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 2471.875 302"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="2471.875" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M1143.133,40.045L1017.828,47.871C892.523,55.697,641.914,71.348,516.609,81.258C391.305,91.167,391.305,95.333,391.305,98.833C391.305,102.333,391.305,105.167,391.305,106.583L391.305,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M1223.914,62L1223.914,66.167C1223.914,70.333,1223.914,78.667,1223.914,84.917C1223.914,91.167,1223.914,95.333,1223.914,98.833C1223.914,102.333,1223.914,105.167,1223.914,106.583L1223.914,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M1304.695,39.858L1435.344,47.715C1565.992,55.572,1827.289,71.286,1957.938,81.226C2088.586,91.167,2088.586,95.333,2088.586,98.833C2088.586,102.333,2088.586,105.167,2088.586,106.583L2088.586,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_3" d="M345.273,146.842L302.074,154.202C258.875,161.561,172.477,176.281,129.277,185.724C86.078,195.167,86.078,199.333,86.078,202.833C86.078,206.333,86.078,209.167,86.078,210.583L86.078,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_4" d="M345.273,163.161L336.434,167.801C327.594,172.441,309.914,181.72,301.074,188.443C292.234,195.167,292.234,199.333,292.234,202.833C292.234,206.333,292.234,209.167,292.234,210.583L292.234,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B3_5" d="M437.336,163.161L446.176,167.801C455.016,172.441,472.695,181.72,481.535,188.443C490.375,195.167,490.375,199.333,490.375,202.833C490.375,206.333,490.375,209.167,490.375,210.583L490.375,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B4_6" d="M437.336,146.842L480.534,154.202C523.732,161.562,610.128,176.281,653.326,185.724C696.523,195.167,696.523,199.333,696.523,202.833C696.523,206.333,696.523,209.167,696.523,210.583L696.523,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_7" d="M1177.883,146.451L1132.014,153.876C1086.146,161.301,994.409,176.15,948.54,185.659C902.672,195.167,902.672,199.333,902.672,202.833C902.672,206.333,902.672,209.167,902.672,210.583L902.672,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_8" d="M1177.883,159.797L1166.372,164.998C1154.862,170.198,1131.841,180.599,1120.331,187.883C1108.82,195.167,1108.82,199.333,1108.82,202.833C1108.82,206.333,1108.82,209.167,1108.82,210.583L1108.82,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C3_9" d="M1269.945,159.797L1281.456,164.998C1292.966,170.198,1315.987,180.599,1327.497,187.883C1339.008,195.167,1339.008,199.333,1339.008,202.833C1339.008,206.333,1339.008,209.167,1339.008,210.583L1339.008,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C4_10" d="M1269.945,145.932L1319.82,153.444C1369.695,160.955,1469.445,175.977,1519.32,185.572C1569.195,195.167,1569.195,199.333,1569.195,202.833C1569.195,206.333,1569.195,209.167,1569.195,210.583L1569.195,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_11" d="M2026.531,149.572L1986.003,156.477C1945.474,163.381,1864.417,177.191,1823.888,186.179C1783.359,195.167,1783.359,199.333,1783.359,202.833C1783.359,206.333,1783.359,209.167,1783.359,210.583L1783.359,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D2_12" d="M2037.146,166L2029.207,170.167C2021.269,174.333,2005.392,182.667,1997.454,188.917C1989.516,195.167,1989.516,199.333,1989.516,202.833C1989.516,206.333,1989.516,209.167,1989.516,210.583L1989.516,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D3_13" d="M2140.026,166L2147.965,170.167C2155.903,174.333,2171.78,182.667,2179.718,188.917C2187.656,195.167,2187.656,199.333,2187.656,202.833C2187.656,206.333,2187.656,209.167,2187.656,210.583L2187.656,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D4_14" d="M2150.641,149.857L2189.833,156.714C2229.026,163.571,2307.411,177.286,2346.604,186.226C2385.797,195.167,2385.797,199.333,2385.797,202.833C2385.797,206.333,2385.797,209.167,2385.797,210.583L2385.797,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(1223.9140625, 35)" id="flowchart-A-7346" class="node default"><rect height="54" width="161.5625" y="-27" x="-80.78125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-50.78125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="101.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis集群模式</p></span></div></foreignObject></g></g><g transform="translate(391.3046875, 139)" id="flowchart-B-7347" class="node default"><rect height="54" width="92.0625" y="-27" x="-46.03125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-16.03125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>优点</p></span></div></foreignObject></g></g><g transform="translate(1223.9140625, 139)" id="flowchart-C-7349" class="node default"><rect height="54" width="92.0625" y="-27" x="-46.03125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-16.03125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="32.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>缺点</p></span></div></foreignObject></g></g><g transform="translate(2088.5859375, 139)" id="flowchart-D-7351" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>适用场景</p></span></div></foreignObject></g></g><g transform="translate(86.078125, 255)" id="flowchart-B1-7353" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>水平扩展<br>支持大数据量</p></span></div></foreignObject></g></g><g transform="translate(292.234375, 255)" id="flowchart-B2-7355" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高可用<br>自动故障转移</p></span></div></foreignObject></g></g><g transform="translate(490.375, 255)" id="flowchart-B3-7357" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>去中心化<br>无单点故障</p></span></div></foreignObject></g></g><g transform="translate(696.5234375, 255)" id="flowchart-B4-7359" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能线性增长<br>多节点并行处理</p></span></div></foreignObject></g></g><g transform="translate(902.671875, 255)" id="flowchart-C1-7361" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>复杂度高<br>运维难度大</p></span></div></foreignObject></g></g><g transform="translate(1108.8203125, 255)" id="flowchart-C2-7363" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>不支持多数据库<br>只能使用DB0</p></span></div></foreignObject></g></g><g transform="translate(1339.0078125, 255)" id="flowchart-C3-7365" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>事务限制<br>跨节点事务不支持</p></span></div></foreignObject></g></g><g transform="translate(1569.1953125, 255)" id="flowchart-C4-7367" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内存开销<br>需要额外元数据</p></span></div></foreignObject></g></g><g transform="translate(1783.359375, 255)" id="flowchart-D1-7369" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>大数据量场景<br>单机内存不足</p></span></div></foreignObject></g></g><g transform="translate(1989.515625, 255)" id="flowchart-D2-7371" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高并发读写<br>需要水平扩展</p></span></div></foreignObject></g></g><g transform="translate(2187.65625, 255)" id="flowchart-D3-7373" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高可用要求<br>7x24服务</p></span></div></foreignObject></g></g><g transform="translate(2385.796875, 255)" id="flowchart-D4-7375" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据增长快<br>需要动态扩容</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h2 id="q2-redis" data-toc="q2-redis">Q2: 如何进行Redis性能优化？有哪些关键的性能指标？</h2><p id="-sncu0e_44"><span class="control" id="-sncu0e_48">A2:</span></p><section class="chapter"><h3 id="-sncu0e_45" data-toc="-sncu0e_45">性能监控指标</h3><section class="chapter"><h4 id="1" data-toc="1">1. 核心性能指标</h4><div class="code-block" data-lang="bash">
# 使用INFO命令查看性能指标
redis-cli INFO stats

# 关键指标说明
total_commands_processed: 总命令处理数
instantaneous_ops_per_sec: 当前每秒操作数(QPS)
total_net_input_bytes: 总输入字节数
total_net_output_bytes: 总输出字节数
rejected_connections: 拒绝连接数
expired_keys: 过期key数量
evicted_keys: 淘汰key数量
keyspace_hits: 命中次数
keyspace_misses: 未命中次数
</div></section><section class="chapter"><h4 id="2" data-toc="2">2. 性能计算公式</h4><div class="code-block" data-lang="python">
# 命中率计算
def calculate_hit_ratio(hits, misses):
    total = hits + misses
    if total == 0:
        return 0
    return (hits / total) * 100

# 内存使用率
def calculate_memory_usage(used_memory, maxmemory):
    if maxmemory == 0:
        return 0
    return (used_memory / maxmemory) * 100

# QPS监控
def monitor_qps():
    import redis
    import time
    
    r = redis.Redis()
    prev_commands = 0
    
    while True:
        info = r.info('stats')
        current_commands = info['total_commands_processed']
        qps = current_commands - prev_commands
        
        print(f&quot;当前QPS: {qps}&quot;)
        prev_commands = current_commands
        time.sleep(1)
</div></section></section><section class="chapter"><h3 id="-sncu0e_46" data-toc="-sncu0e_46">性能优化策略</h3><section class="chapter"><h4 id="1" data-toc="1">1. 网络优化</h4><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1760.890625 302"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1760.890625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M821.348,41.094L723.326,48.745C625.303,56.396,429.259,71.698,331.237,81.432C233.215,91.167,233.215,95.333,233.215,98.833C233.215,102.333,233.215,105.167,233.215,106.583L233.215,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M821.348,53.413L797.611,59.011C773.874,64.609,726.4,75.804,702.663,83.485C678.926,91.167,678.926,95.333,678.926,98.833C678.926,102.333,678.926,105.167,678.926,106.583L678.926,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M977.504,54.819L998.633,60.183C1019.763,65.546,1062.022,76.273,1083.152,83.72C1104.281,91.167,1104.281,95.333,1104.281,98.833C1104.281,102.333,1104.281,105.167,1104.281,106.583L1104.281,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M977.504,41.168L1074.201,48.807C1170.897,56.445,1364.29,71.723,1460.987,81.445C1557.684,91.167,1557.684,95.333,1557.684,98.833C1557.684,102.333,1557.684,105.167,1557.684,106.583L1557.684,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_4" d="M169.295,166L159.43,170.167C149.566,174.333,129.838,182.667,119.974,188.917C110.109,195.167,110.109,199.333,110.109,202.833C110.109,206.333,110.109,209.167,110.109,210.583L110.109,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_5" d="M297.135,166L306.999,170.167C316.863,174.333,336.592,182.667,346.456,188.917C356.32,195.167,356.32,199.333,356.32,202.833C356.32,206.333,356.32,209.167,356.32,210.583L356.32,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M626.782,166L618.735,170.167C610.688,174.333,594.594,182.667,586.547,188.917C578.5,195.167,578.5,199.333,578.5,202.833C578.5,206.333,578.5,209.167,578.5,210.583L578.5,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_7" d="M731.07,166L739.117,170.167C747.164,174.333,763.258,182.667,771.305,188.917C779.352,195.167,779.352,199.333,779.352,202.833C779.352,206.333,779.352,209.167,779.352,210.583L779.352,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_8" d="M1044.014,166L1034.713,170.167C1025.413,174.333,1006.812,182.667,997.511,188.917C988.211,195.167,988.211,199.333,988.211,202.833C988.211,206.333,988.211,209.167,988.211,210.583L988.211,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D2_9" d="M1164.549,166L1173.849,170.167C1183.15,174.333,1201.751,182.667,1211.051,188.917C1220.352,195.167,1220.352,199.333,1220.352,202.833C1220.352,206.333,1220.352,209.167,1220.352,210.583L1220.352,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_10" d="M1501.025,166L1492.281,170.167C1483.537,174.333,1466.05,182.667,1457.306,188.917C1448.563,195.167,1448.563,199.333,1448.563,202.833C1448.563,206.333,1448.563,209.167,1448.563,210.583L1448.563,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E2_11" d="M1614.343,166L1623.086,170.167C1631.83,174.333,1649.317,182.667,1658.061,188.917C1666.805,195.167,1666.805,199.333,1666.805,202.833C1666.805,206.333,1666.805,209.167,1666.805,210.583L1666.805,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(899.42578125, 35)" id="flowchart-A-7596" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>网络优化策略</p></span></div></foreignObject></g></g><g transform="translate(233.21484375, 139)" id="flowchart-B-7597" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>连接池优化</p></span></div></foreignObject></g></g><g transform="translate(678.92578125, 139)" id="flowchart-C-7599" class="node default"><rect height="54" width="165.390625" y="-27" x="-82.6953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.6953125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pipeline批处理</p></span></div></foreignObject></g></g><g transform="translate(1104.28125, 139)" id="flowchart-D-7601" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据压缩</p></span></div></foreignObject></g></g><g transform="translate(1557.68359375, 139)" id="flowchart-E-7603" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>网络配置</p></span></div></foreignObject></g></g><g transform="translate(110.109375, 255)" id="flowchart-B1-7605" class="node default"><rect height="78" width="204.21875" y="-39" x="-102.109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.109375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="144.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>合理设置连接池大小<br>避免频繁建连</p></span></div></foreignObject></g></g><g transform="translate(356.3203125, 255)" id="flowchart-B2-7607" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>设置连接超时<br>及时释放无效连接</p></span></div></foreignObject></g></g><g transform="translate(578.5, 255)" id="flowchart-C1-7609" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>批量操作<br>减少网络往返</p></span></div></foreignObject></g></g><g transform="translate(779.3515625, 255)" id="flowchart-C2-7611" class="node default"><rect height="78" width="145.546875" y="-39" x="-72.7734375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.7734375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="85.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MGET/MSET<br>批量读写</p></span></div></foreignObject></g></g><g transform="translate(988.2109375, 255)" id="flowchart-D1-7613" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端压缩<br>减少传输数据量</p></span></div></foreignObject></g></g><g transform="translate(1220.3515625, 255)" id="flowchart-D2-7615" class="node default"><rect height="78" width="192.109375" y="-39" x="-96.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="132.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>选择高效序列化<br>protobuf/msgpack</p></span></div></foreignObject></g></g><g transform="translate(1448.5625, 255)" id="flowchart-E1-7617" class="node default"><rect height="78" width="164.3125" y="-39" x="-82.15625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-52.15625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="104.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>TCP_NODELAY<br>禁用Nagle算法</p></span></div></foreignObject></g></g><g transform="translate(1666.8046875, 255)" id="flowchart-E2-7619" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>调整缓冲区大小<br>tcp-keepalive</p></span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h4 id="2" data-toc="2">2. 内存优化</h4><div class="code-block" data-lang="python">
# 1. 使用合适的数据结构
# 错误：使用String存储对象
redis.set(&quot;user:1001&quot;, json.dumps({
    &quot;name&quot;: &quot;John&quot;,
    &quot;age&quot;: 30,
    &quot;email&quot;: &quot;john@example.com&quot;
}))

# 正确：使用Hash存储对象
redis.hset(&quot;user:1001&quot;, mapping={
    &quot;name&quot;: &quot;John&quot;,
    &quot;age&quot;: &quot;30&quot;,
    &quot;email&quot;: &quot;john@example.com&quot;
})

# 2. 控制key的长度
# 错误：过长的key名
redis.set(&quot;application:user:profile:basic:information:1001&quot;, &quot;data&quot;)

# 正确：简短的key名
redis.set(&quot;app:u:p:1001&quot;, &quot;data&quot;)

# 3. 设置合理的过期时间
redis.setex(&quot;session:1001&quot;, 1800, &quot;session_data&quot;)  # 30分钟过期
</div></section><section class="chapter"><h4 id="3-cpu" data-toc="3-cpu">3. CPU优化</h4><div class="code-block" data-lang="bash">
# 1. 避免慢查询
# 设置慢查询阈值（微秒）
CONFIG SET slowlog-log-slower-than 10000

# 查看慢查询日志
SLOWLOG GET 10

# 2. 避免大key操作
# 错误：一次获取大量数据
LRANGE mylist 0 -1  # 如果list很大会阻塞

# 正确：分批获取
LRANGE mylist 0 99    # 每次获取100个
LRANGE mylist 100 199

# 3. 使用SCAN代替KEYS
# 错误：可能阻塞服务器
KEYS user:*

# 正确：渐进式遍历
SCAN 0 MATCH user:* COUNT 100
</div></section><section class="chapter"><h4 id="4" data-toc="4">4. 持久化优化</h4><div class="code-block" data-lang="bash">
# RDB优化
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error no

# AOF优化
appendonly yes
appendfsync everysec
no-appendfsync-on-rewrite yes
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# 混合持久化
aof-use-rdb-preamble yes
</div></section></section><section class="chapter"><h3 id="-sncu0e_47" data-toc="-sncu0e_47">性能测试和基准测试</h3><section class="chapter"><h4 id="1-redis-benchmark" data-toc="1-redis-benchmark">1. redis-benchmark工具</h4><div class="code-block" data-lang="bash">
# 基本性能测试
redis-benchmark -h 127.0.0.1 -p 6379 -c 100 -n 100000

# 测试特定命令
redis-benchmark -h 127.0.0.1 -p 6379 -t set,get -c 100 -n 100000

# 测试不同数据大小
redis-benchmark -h 127.0.0.1 -p 6379 -d 1024 -c 100 -n 100000

# 输出结果解读
====== SET ======
  100000 requests completed in 1.23 seconds
  100 parallel clients
  3 bytes payload
  keep alive: 1

99.99% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
81300.81 requests per second
</div></section><section class="chapter"><h4 id="2" data-toc="2">2. 自定义性能测试</h4><div class="code-block" data-lang="python">
import redis
import time
import threading
from concurrent.futures import ThreadPoolExecutor

def performance_test():
    r = redis.Redis(host='localhost', port=6379, db=0)
    
    # 测试SET性能
    start_time = time.time()
    for i in range(10000):
        r.set(f&quot;test:key:{i}&quot;, f&quot;value:{i}&quot;)
    set_time = time.time() - start_time
    
    # 测试GET性能
    start_time = time.time()
    for i in range(10000):
        r.get(f&quot;test:key:{i}&quot;)
    get_time = time.time() - start_time
    
    print(f&quot;SET QPS: {10000/set_time:.2f}&quot;)
    print(f&quot;GET QPS: {10000/get_time:.2f}&quot;)

# 并发测试
def concurrent_test():
    def worker():
        r = redis.Redis(host='localhost', port=6379, db=0)
        for i in range(1000):
            r.set(f&quot;concurrent:key:{threading.current_thread().ident}:{i}&quot;, &quot;value&quot;)
    
    start_time = time.time()
    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(worker) for _ in range(10)]
        for future in futures:
            future.result()
    
    total_time = time.time() - start_time
    print(f&quot;并发QPS: {10000/total_time:.2f}&quot;)
</div></section></section></section><section class="chapter"><h2 id="q3-redis" data-toc="q3-redis">Q3: Redis在实际项目中有哪些常见的应用场景？如何设计和实现？</h2><p id="-sncu0e_65"><span class="control" id="-sncu0e_72">A3:</span></p><section class="chapter"><h3 id="1" data-toc="1">1. 缓存系统</h3><section class="chapter"><h4 id="-sncu0e_73" data-toc="-sncu0e_73">应用场景</h4><ul class="list _bullet" id="-sncu0e_76"><li class="list__item" id="-sncu0e_77"><p id="-sncu0e_80">数据库查询结果缓存</p></li><li class="list__item" id="-sncu0e_78"><p id="-sncu0e_81">页面缓存</p></li><li class="list__item" id="-sncu0e_79"><p id="-sncu0e_82">对象缓存</p></li></ul></section><section class="chapter"><h4 id="-sncu0e_74" data-toc="-sncu0e_74">实现方案</h4><div class="code-block" data-lang="python">
import redis
import json
import hashlib
from functools import wraps

class RedisCache:
    def __init__(self, host='localhost', port=6379, db=0):
        self.redis_client = redis.Redis(host=host, port=port, db=db)
    
    def cache_result(self, expire_time=3600):
        &quot;&quot;&quot;缓存装饰器&quot;&quot;&quot;
        def decorator(func):
            @wraps(func)
            def wrapper(*args, **kwargs):
                # 生成缓存key
                cache_key = self._generate_cache_key(func.__name__, args, kwargs)
                
                # 尝试从缓存获取
                cached_result = self.redis_client.get(cache_key)
                if cached_result:
                    return json.loads(cached_result)
                
                # 执行原函数
                result = func(*args, **kwargs)
                
                # 存入缓存
                self.redis_client.setex(
                    cache_key, 
                    expire_time, 
                    json.dumps(result, default=str)
                )
                
                return result
            return wrapper
        return decorator
    
    def _generate_cache_key(self, func_name, args, kwargs):
        &quot;&quot;&quot;生成缓存key&quot;&quot;&quot;
        key_data = f&quot;{func_name}:{args}:{sorted(kwargs.items())}&quot;
        return f&quot;cache:{hashlib.md5(key_data.encode()).hexdigest()}&quot;

# 使用示例
cache = RedisCache()

@cache.cache_result(expire_time=1800)  # 30分钟过期
def get_user_profile(user_id):
    # 模拟数据库查询
    return {
        &quot;user_id&quot;: user_id,
        &quot;name&quot;: &quot;John Doe&quot;,
        &quot;email&quot;: &quot;john@example.com&quot;
    }
</div></section><section class="chapter"><h4 id="-sncu0e_75" data-toc="-sncu0e_75">缓存策略</h4><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 752.203125 326"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="752.203125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M353.531,46.501L317.112,53.251C280.693,60.001,207.854,73.5,171.435,82.334C135.016,91.167,135.016,95.333,135.016,98.833C135.016,102.333,135.016,105.167,135.016,106.583L135.016,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M415.586,62L415.586,66.167C415.586,70.333,415.586,78.667,415.586,84.917C415.586,91.167,415.586,95.333,415.586,98.833C415.586,102.333,415.586,105.167,415.586,106.583L415.586,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M477.641,48.385L507.479,54.821C537.318,61.256,596.995,74.128,626.833,82.647C656.672,91.167,656.672,95.333,656.672,98.833C656.672,102.333,656.672,105.167,656.672,106.583L656.672,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_3" d="M135.016,166L135.016,170.167C135.016,174.333,135.016,182.667,135.016,188.917C135.016,195.167,135.016,199.333,135.016,202.833C135.016,206.333,135.016,209.167,135.016,210.583L135.016,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_4" d="M415.586,166L415.586,170.167C415.586,174.333,415.586,182.667,415.586,188.917C415.586,195.167,415.586,199.333,415.586,202.833C415.586,206.333,415.586,209.167,415.586,210.583L415.586,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_5" d="M656.672,166L656.672,170.167C656.672,174.333,656.672,182.667,656.672,188.917C656.672,195.167,656.672,199.333,656.672,202.833C656.672,206.333,656.672,209.167,656.672,210.583L656.672,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(415.5859375, 35)" id="flowchart-A-7802" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>缓存策略</p></span></div></foreignObject></g></g><g transform="translate(135.015625, 139)" id="flowchart-B-7803" class="node default"><rect height="54" width="147.625" y="-27" x="-73.8125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-43.8125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="87.625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Cache-Aside</p></span></div></foreignObject></g></g><g transform="translate(415.5859375, 139)" id="flowchart-C-7805" class="node default"><rect height="54" width="163.21875" y="-27" x="-81.609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-51.609375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="103.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Write-Through</p></span></div></foreignObject></g></g><g transform="translate(656.671875, 139)" id="flowchart-D-7807" class="node default"><rect height="54" width="153.59375" y="-27" x="-76.796875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.796875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="93.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Write-Behind</p></span></div></foreignObject></g></g><g transform="translate(135.015625, 267)" id="flowchart-B1-7809" class="node default"><rect height="102" width="254.03125" y="-51" x="-127.015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-97.015625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="194.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>应用程序管理缓存<br>读：先查缓存，miss则查DB<br>写：先写DB，再删缓存</p></span></div></foreignObject></g></g><g transform="translate(415.5859375, 267)" id="flowchart-C1-7811" class="node default"><rect height="102" width="207.109375" y="-51" x="-103.5546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-73.5546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="147.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>写入时同步更新<br>写：同时写DB和缓存<br>读：直接读缓存</p></span></div></foreignObject></g></g><g transform="translate(656.671875, 267)" id="flowchart-D1-7813" class="node default"><rect height="102" width="175.0625" y="-51" x="-87.53125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-57.53125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="115.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>异步写入DB<br>写：先写缓存<br>异步批量写入DB</p></span></div></foreignObject></g></g></g></g></g></svg></section></section><section class="chapter"><h3 id="2" data-toc="2">2. 分布式锁</h3><section class="chapter"><h4 id="-sncu0e_85" data-toc="-sncu0e_85">应用场景</h4><ul class="list _bullet" id="-sncu0e_87"><li class="list__item" id="-sncu0e_88"><p id="-sncu0e_91">防止重复操作</p></li><li class="list__item" id="-sncu0e_89"><p id="-sncu0e_92">资源互斥访问</p></li><li class="list__item" id="-sncu0e_90"><p id="-sncu0e_93">分布式事务</p></li></ul></section><section class="chapter"><h4 id="-sncu0e_86" data-toc="-sncu0e_86">实现方案</h4><div class="code-block" data-lang="python">
import redis
import uuid
import time

class DistributedLock:
    def __init__(self, redis_client, lock_key, timeout=10):
        self.redis_client = redis_client
        self.lock_key = lock_key
        self.timeout = timeout
        self.identifier = str(uuid.uuid4())
    
    def acquire(self):
        &quot;&quot;&quot;获取锁&quot;&quot;&quot;
        end_time = time.time() + self.timeout
        
        while time.time() &lt; end_time:
            # 使用SET NX EX原子操作
            if self.redis_client.set(
                self.lock_key, 
                self.identifier, 
                nx=True, 
                ex=self.timeout
            ):
                return True
            time.sleep(0.001)  # 1ms
        
        return False
    
    def release(self):
        &quot;&quot;&quot;释放锁&quot;&quot;&quot;
        # 使用Lua脚本保证原子性
        lua_script = &quot;&quot;&quot;
        if redis.call(&quot;GET&quot;, KEYS[1]) == ARGV[1] then
            return redis.call(&quot;DEL&quot;, KEYS[1])
        else
            return 0
        end
        &quot;&quot;&quot;
        
        return self.redis_client.eval(
            lua_script, 
            1, 
            self.lock_key, 
            self.identifier
        )
    
    def __enter__(self):
        if self.acquire():
            return self
        raise Exception(&quot;Failed to acquire lock&quot;)
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        self.release()

# 使用示例
def process_order(order_id):
    redis_client = redis.Redis()
    lock_key = f&quot;order_lock:{order_id}&quot;
    
    with DistributedLock(redis_client, lock_key, timeout=30):
        # 处理订单逻辑
        print(f&quot;Processing order {order_id}&quot;)
        time.sleep(2)  # 模拟处理时间
        print(f&quot;Order {order_id} processed&quot;)
</div></section></section><section class="chapter"><h3 id="3" data-toc="3">3. 消息队列</h3><section class="chapter"><h4 id="-sncu0e_95" data-toc="-sncu0e_95">应用场景</h4><ul class="list _bullet" id="-sncu0e_97"><li class="list__item" id="-sncu0e_98"><p id="-sncu0e_101">异步任务处理</p></li><li class="list__item" id="-sncu0e_99"><p id="-sncu0e_102">系统解耦</p></li><li class="list__item" id="-sncu0e_100"><p id="-sncu0e_103">流量削峰</p></li></ul></section><section class="chapter"><h4 id="-sncu0e_96" data-toc="-sncu0e_96">实现方案</h4><div class="code-block" data-lang="python">
import redis
import json
import time
from typing import Optional

class RedisQueue:
    def __init__(self, redis_client, queue_name):
        self.redis_client = redis_client
        self.queue_name = queue_name
    
    def enqueue(self, message):
        &quot;&quot;&quot;入队&quot;&quot;&quot;
        message_data = {
            'id': str(uuid.uuid4()),
            'data': message,
            'timestamp': time.time()
        }
        
        self.redis_client.lpush(
            self.queue_name, 
            json.dumps(message_data)
        )
    
    def dequeue(self, timeout=0) -&gt; Optional[dict]:
        &quot;&quot;&quot;出队&quot;&quot;&quot;
        result = self.redis_client.brpop(self.queue_name, timeout=timeout)
        if result:
            return json.loads(result[1])
        return None
    
    def size(self):
        &quot;&quot;&quot;队列长度&quot;&quot;&quot;
        return self.redis_client.llen(self.queue_name)

# 生产者
def producer():
    redis_client = redis.Redis()
    queue = RedisQueue(redis_client, 'task_queue')
    
    for i in range(100):
        task = {
            'task_id': i,
            'action': 'process_data',
            'data': f'data_{i}'
        }
        queue.enqueue(task)
        print(f&quot;Enqueued task {i}&quot;)

# 消费者
def consumer():
    redis_client = redis.Redis()
    queue = RedisQueue(redis_client, 'task_queue')
    
    while True:
        message = queue.dequeue(timeout=5)
        if message:
            print(f&quot;Processing task: {message['data']['task_id']}&quot;)
            # 处理任务
            time.sleep(1)
        else:
            print(&quot;No tasks, waiting...&quot;)
</div></section></section><section class="chapter"><h3 id="4" data-toc="4">4. 限流器</h3><section class="chapter"><h4 id="-sncu0e_105" data-toc="-sncu0e_105">应用场景</h4><ul class="list _bullet" id="-sncu0e_107"><li class="list__item" id="-sncu0e_108"><p id="-sncu0e_111">API限流</p></li><li class="list__item" id="-sncu0e_109"><p id="-sncu0e_112">防止恶意攻击</p></li><li class="list__item" id="-sncu0e_110"><p id="-sncu0e_113">资源保护</p></li></ul></section><section class="chapter"><h4 id="-sncu0e_106" data-toc="-sncu0e_106">实现方案</h4><div class="code-block" data-lang="python">
import redis
import time

class RateLimiter:
    def __init__(self, redis_client):
        self.redis_client = redis_client
    
    def sliding_window_limiter(self, key, limit, window_size):
        &quot;&quot;&quot;滑动窗口限流&quot;&quot;&quot;
        now = time.time()
        pipeline = self.redis_client.pipeline()
        
        # 删除窗口外的记录
        pipeline.zremrangebyscore(key, 0, now - window_size)
        
        # 获取当前窗口内的请求数
        pipeline.zcard(key)
        
        # 添加当前请求
        pipeline.zadd(key, {str(now): now})
        
        # 设置过期时间
        pipeline.expire(key, int(window_size) + 1)
        
        results = pipeline.execute()
        current_requests = results[1]
        
        return current_requests &lt; limit
    
    def token_bucket_limiter(self, key, capacity, refill_rate):
        &quot;&quot;&quot;令牌桶限流&quot;&quot;&quot;
        lua_script = &quot;&quot;&quot;
        local key = KEYS[1]
        local capacity = tonumber(ARGV[1])
        local refill_rate = tonumber(ARGV[2])
        local now = tonumber(ARGV[3])
        
        local bucket = redis.call('HMGET', key, 'tokens', 'last_refill')
        local tokens = tonumber(bucket[1]) or capacity
        local last_refill = tonumber(bucket[2]) or now
        
        -- 计算需要添加的令牌数
        local elapsed = now - last_refill
        local tokens_to_add = math.floor(elapsed * refill_rate)
        tokens = math.min(capacity, tokens + tokens_to_add)
        
        if tokens &gt;= 1 then
            tokens = tokens - 1
            redis.call('HMSET', key, 'tokens', tokens, 'last_refill', now)
            redis.call('EXPIRE', key, 3600)
            return 1
        else
            redis.call('HMSET', key, 'tokens', tokens, 'last_refill', now)
            redis.call('EXPIRE', key, 3600)
            return 0
        end
        &quot;&quot;&quot;
        
        return self.redis_client.eval(
            lua_script, 
            1, 
            key, 
            capacity, 
            refill_rate, 
            time.time()
        )

# 使用示例
def api_endpoint(user_id):
    redis_client = redis.Redis()
    limiter = RateLimiter(redis_client)
    
    # 每分钟最多100次请求
    if not limiter.sliding_window_limiter(
        f&quot;rate_limit:{user_id}&quot;, 
        limit=100, 
        window_size=60
    ):
        return {&quot;error&quot;: &quot;Rate limit exceeded&quot;}, 429
    
    # 正常处理请求
    return {&quot;message&quot;: &quot;Success&quot;}, 200
</div></section></section><section class="chapter"><h3 id="5" data-toc="5">5. 排行榜系统</h3><section class="chapter"><h4 id="-sncu0e_115" data-toc="-sncu0e_115">应用场景</h4><ul class="list _bullet" id="-sncu0e_117"><li class="list__item" id="-sncu0e_118"><p id="-sncu0e_121">游戏排行榜</p></li><li class="list__item" id="-sncu0e_119"><p id="-sncu0e_122">热门内容排序</p></li><li class="list__item" id="-sncu0e_120"><p id="-sncu0e_123">积分排名</p></li></ul></section><section class="chapter"><h4 id="-sncu0e_116" data-toc="-sncu0e_116">实现方案</h4><div class="code-block" data-lang="python">
import redis
import time

class Leaderboard:
    def __init__(self, redis_client, leaderboard_name):
        self.redis_client = redis_client
        self.leaderboard_name = leaderboard_name
    
    def add_score(self, user_id, score):
        &quot;&quot;&quot;添加分数&quot;&quot;&quot;
        self.redis_client.zadd(self.leaderboard_name, {user_id: score})
    
    def increment_score(self, user_id, increment):
        &quot;&quot;&quot;增加分数&quot;&quot;&quot;
        return self.redis_client.zincrby(self.leaderboard_name, increment, user_id)
    
    def get_top_users(self, count=10):
        &quot;&quot;&quot;获取前N名用户&quot;&quot;&quot;
        return self.redis_client.zrevrange(
            self.leaderboard_name, 
            0, 
            count - 1, 
            withscores=True
        )
    
    def get_user_rank(self, user_id):
        &quot;&quot;&quot;获取用户排名&quot;&quot;&quot;
        rank = self.redis_client.zrevrank(self.leaderboard_name, user_id)
        return rank + 1 if rank is not None else None
    
    def get_user_score(self, user_id):
        &quot;&quot;&quot;获取用户分数&quot;&quot;&quot;
        return self.redis_client.zscore(self.leaderboard_name, user_id)
    
    def get_users_around(self, user_id, count=5):
        &quot;&quot;&quot;获取用户周围的排名&quot;&quot;&quot;
        rank = self.redis_client.zrevrank(self.leaderboard_name, user_id)
        if rank is None:
            return []
        
        start = max(0, rank - count)
        end = rank + count
        
        return self.redis_client.zrevrange(
            self.leaderboard_name,
            start,
            end,
            withscores=True
        )

# 使用示例
def game_leaderboard_example():
    redis_client = redis.Redis()
    leaderboard = Leaderboard(redis_client, 'game_scores')
    
    # 添加玩家分数
    players = [
        ('player1', 1000),
        ('player2', 1500),
        ('player3', 800),
        ('player4', 2000),
        ('player5', 1200)
    ]
    
    for player_id, score in players:
        leaderboard.add_score(player_id, score)
    
    # 获取前3名
    top_3 = leaderboard.get_top_users(3)
    print(&quot;前3名:&quot;, top_3)
    
    # 获取player2的排名
    rank = leaderboard.get_user_rank('player2')
    print(f&quot;player2排名: {rank}&quot;)
    
    # 获取player2周围的玩家
    around = leaderboard.get_users_around('player2', 2)
    print(&quot;player2周围的玩家:&quot;, around)
</div></section></section><section class="chapter"><h3 id="-sncu0e_71" data-toc="-sncu0e_71">应用场景选择指南</h3><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1822.078125 302"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1822.078125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M820.867,42.995L732.07,50.33C643.273,57.664,465.68,72.332,376.883,81.749C288.086,91.167,288.086,95.333,288.086,98.833C288.086,102.333,288.086,105.167,288.086,106.583L288.086,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M917.672,62L917.672,66.167C917.672,70.333,917.672,78.667,917.672,84.917C917.672,91.167,917.672,95.333,917.672,98.833C917.672,102.333,917.672,105.167,917.672,106.583L917.672,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M1014.477,43.204L1100.602,50.504C1186.727,57.803,1358.977,72.401,1445.102,81.784C1531.227,91.167,1531.227,95.333,1531.227,98.833C1531.227,102.333,1531.227,105.167,1531.227,106.583L1531.227,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_3" d="M226.031,154.865L202.475,160.888C178.919,166.91,131.807,178.955,108.251,187.061C84.695,195.167,84.695,199.333,84.695,202.833C84.695,206.333,84.695,209.167,84.695,210.583L84.695,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B2_4" d="M288.086,166L288.086,170.167C288.086,174.333,288.086,182.667,288.086,188.917C288.086,195.167,288.086,199.333,288.086,202.833C288.086,206.333,288.086,209.167,288.086,210.583L288.086,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B3_5" d="M350.141,153.707L376.367,159.922C402.594,166.138,455.047,178.569,481.273,186.868C507.5,195.167,507.5,199.333,507.5,202.833C507.5,206.333,507.5,209.167,507.5,210.583L507.5,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_6" d="M855.617,155.551L833.465,161.459C811.313,167.367,767.008,179.184,744.855,187.175C722.703,195.167,722.703,199.333,722.703,202.833C722.703,206.333,722.703,209.167,722.703,210.583L722.703,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C2_7" d="M917.672,166L917.672,170.167C917.672,174.333,917.672,182.667,917.672,188.917C917.672,195.167,917.672,199.333,917.672,202.833C917.672,206.333,917.672,209.167,917.672,210.583L917.672,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C3_8" d="M979.727,154.575L1003.915,160.645C1028.104,166.716,1076.482,178.858,1100.671,187.012C1124.859,195.167,1124.859,199.333,1124.859,202.833C1124.859,206.333,1124.859,209.167,1124.859,210.583L1124.859,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_9" d="M1461.164,157.291L1439.645,162.909C1418.125,168.528,1375.086,179.764,1353.566,187.465C1332.047,195.167,1332.047,199.333,1332.047,202.833C1332.047,206.333,1332.047,209.167,1332.047,210.583L1332.047,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D2_10" d="M1531.227,166L1531.227,170.167C1531.227,174.333,1531.227,182.667,1531.227,188.917C1531.227,195.167,1531.227,199.333,1531.227,202.833C1531.227,206.333,1531.227,209.167,1531.227,210.583L1531.227,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D3_11" d="M1601.289,156.792L1623.741,162.493C1646.193,168.194,1691.096,179.597,1713.548,187.382C1736,195.167,1736,199.333,1736,202.833C1736,206.333,1736,209.167,1736,210.583L1736,212"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(917.671875, 35)" id="flowchart-A-7965" class="node default"><rect height="54" width="193.609375" y="-27" x="-96.8046875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.8046875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="133.609375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Redis应用场景选择</p></span></div></foreignObject></g></g><g transform="translate(288.0859375, 139)" id="flowchart-B-7966" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据特征</p></span></div></foreignObject></g></g><g transform="translate(917.671875, 139)" id="flowchart-C-7968" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>访问模式</p></span></div></foreignObject></g></g><g transform="translate(1531.2265625, 139)" id="flowchart-D-7970" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>一致性要求</p></span></div></foreignObject></g></g><g transform="translate(84.6953125, 255)" id="flowchart-B1-7972" class="node default"><rect height="78" width="153.390625" y="-39" x="-76.6953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.6953125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="93.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>小数据量<br>→ 缓存/会话</p></span></div></foreignObject></g></g><g transform="translate(288.0859375, 255)" id="flowchart-B2-7974" class="node default"><rect height="78" width="153.390625" y="-39" x="-76.6953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.6953125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="93.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>大数据量<br>→ 集群/分片</p></span></div></foreignObject></g></g><g transform="translate(507.5, 255)" id="flowchart-B3-7976" class="node default"><rect height="78" width="185.4375" y="-39" x="-92.71875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-62.71875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="125.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>有序数据<br>→ 排行榜/时间线</p></span></div></foreignObject></g></g><g transform="translate(722.703125, 255)" id="flowchart-C1-7978" class="node default"><rect height="78" width="144.96875" y="-39" x="-72.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.484375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="84.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>读多写少<br>→ 缓存系统</p></span></div></foreignObject></g></g><g transform="translate(917.671875, 255)" id="flowchart-C2-7980" class="node default"><rect height="78" width="144.96875" y="-39" x="-72.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.484375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="84.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高并发写<br>→ 消息队列</p></span></div></foreignObject></g></g><g transform="translate(1124.859375, 255)" id="flowchart-C3-7982" class="node default"><rect height="78" width="169.40625" y="-39" x="-84.703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-54.703125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="109.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实时性要求<br>→ 计数器/限流</p></span></div></foreignObject></g></g><g transform="translate(1332.046875, 255)" id="flowchart-D1-7984" class="node default"><rect height="78" width="144.96875" y="-39" x="-72.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.484375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="84.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>强一致性<br>→ 分布式锁</p></span></div></foreignObject></g></g><g transform="translate(1531.2265625, 255)" id="flowchart-D2-7986" class="node default"><rect height="78" width="153.390625" y="-39" x="-76.6953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.6953125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="93.390625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>最终一致性<br>→ 缓存/队列</p></span></div></foreignObject></g></g><g transform="translate(1736, 255)" id="flowchart-D3-7988" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>无一致性要求<br>→ 统计/分析</p></span></div></foreignObject></g></g></g></g></g></svg><p id="-sncu0e_127"><span class="control" id="-sncu0e_128">第六阶段完成！</span> 已创建Redis性能优化与应用场景的QA文档，涵盖了集群模式、性能优化策略、监控指标和5个主要应用场景的详细实现。</p></section></section><section class="chapter"><h2 id="-sncu0e_6" data-toc="-sncu0e_6">总结</h2><p id="-sncu0e_129">我已经完成了Redis技术大纲的完整QA创建，共分为6个阶段：</p><ol class="list _decimal" id="-sncu0e_130" type="1"><li class="list__item" id="-sncu0e_134"><p id="-sncu0e_140"><span class="control" id="-sncu0e_141">Redis基础概念QA</span> - 涵盖Redis简介、特点、对比分析</p></li><li class="list__item" id="-sncu0e_135"><p id="-sncu0e_142"><span class="control" id="-sncu0e_143">Redis数据结构QA</span> - 详解5种基本数据类型和4种高级数据类型</p></li><li class="list__item" id="-sncu0e_136"><p id="-sncu0e_144"><span class="control" id="-sncu0e_145">Redis持久化QA</span> - 深入RDB、AOF和混合持久化机制</p></li><li class="list__item" id="-sncu0e_137"><p id="-sncu0e_146"><span class="control" id="-sncu0e_147">Redis内存管理QA</span> - 内存淘汰策略、过期策略、内存优化</p></li><li class="list__item" id="-sncu0e_138"><p id="-sncu0e_148"><span class="control" id="-sncu0e_149">Redis事务与集群QA</span> - 事务机制、主从复制、哨兵模式</p></li><li class="list__item" id="-sncu0e_139"><p id="-sncu0e_150"><span class="control" id="-sncu0e_151">Redis性能优化与应用场景QA</span> - 集群模式、性能优化、实际应用</p></li></ol><p id="-sncu0e_131">每个QA文档都包含：</p><ul class="list _bullet" id="-sncu0e_132"><li class="list__item" id="-sncu0e_152"><p id="-sncu0e_157">标准的技术答案</p></li><li class="list__item" id="-sncu0e_153"><p id="-sncu0e_158">详细的mermaid流程图和架构图</p></li><li class="list__item" id="-sncu0e_154"><p id="-sncu0e_159">实际的代码示例</p></li><li class="list__item" id="-sncu0e_155"><p id="-sncu0e_160">最佳实践建议</p></li><li class="list__item" id="-sncu0e_156"><p id="-sncu0e_161">常见问题解决方案</p></li></ul><p id="-sncu0e_133">这些文档可以作为Redis面试准备、技术学习和实际项目开发的参考资料。</p></section><div class="last-modified">28 五月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="redis事务与集群qa.html" class="navigation-links__prev">Redis 事务与集群 QA</a><a href="es面试大纲.html" class="navigation-links__next">Elasticsearch面试大纲</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>