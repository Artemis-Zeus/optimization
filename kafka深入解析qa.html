<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-10T01:18:22.6551531"><title>Kafka深入解析QA | 技术知识库</title><script type="application/json" id="virtual-toc-data">[{"id":"-maunsn_4","level":0,"title":"📋 知识结构","anchor":"#-maunsn_4"},{"id":"kafka","level":0,"title":"🏗️ Kafka架构原理","anchor":"#kafka"},{"id":"-maunsn_6","level":0,"title":"📊 分区机制","anchor":"#-maunsn_6"},{"id":"-maunsn_7","level":0,"title":"💡 面试技巧","anchor":"#-maunsn_7"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Kafka深入解析QA | 技术知识库"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术知识库 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/kafka深入解析qa.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Kafka深入解析QA | 技术知识库"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/kafka深入解析qa.html#webpage",
    "url": "writerside-documentation/kafka深入解析qa.html",
    "name": "Kafka深入解析QA | 技术知识库",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术知识库 Help"
}</script><!-- End Schema.org --></head><body data-id="Kafka深入解析QA" data-main-title="Kafka深入解析QA" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="消息队列面试大纲.md|消息队列面试大纲"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术知识库  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Kafka深入解析QA" id="Kafka深入解析QA.md">Kafka深入解析QA</h1><p id="-maunsn_3">Apache Kafka是一个分布式流处理平台，以其高吞吐量、低延迟和强大的持久化能力著称。本文档深入解析Kafka的核心架构和技术特性。</p><section class="chapter"><h2 id="-maunsn_4" data-toc="-maunsn_4">📋 知识结构</h2><svg aria-roledescription="mindmap" role="graphics-document document" viewBox="5 5 863.9414672851562 450.87298583984375" style="max-width: 863.9414672851562px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g></g><g class="mindmap-edges"><path class="edge section-edge-0 edge-depth-1" d="M 253.2694999518313,325.0087877718396 L 257.5766847378463,357.4161139465909 L261.8838695238612,389.8234401213422"></path><path class="edge section-edge-0 edge-depth-1" d="M 266.07275297243154,307.5769952238919 L 311.422787549149,299.7139663826232 L356.77282212586647,291.8509375413545"></path><path class="edge section-edge-0 edge-depth-1" d="M 236.34440202758228,308.9019679274809 L 166.33163232396856,303.10580970234406 L96.31886262035485,297.30965147720724"></path><path class="edge section-edge-0 edge-depth-1" d="M 237.6529998688934,316.3799943942787 L 181.87344116670693,341.8992772978102 L126.09388246452045,367.41856020134173"></path><path class="edge section-edge-0 edge-depth-0" d="M 395.2313676752788,237.0023821227198 L 329.9486734374211,270.1735204444847 L264.6659791995634,303.34465876624967"></path><path class="edge section-edge-1 edge-depth-1" d="M 492.0227910807867,325.06930486954485 L 524.8526112581611,302.7898193502865 L557.6824314355356,280.51033383102816"></path><path class="edge section-edge-1 edge-depth-1" d="M 494.05368750737523,337.543234657769 L 549.6535434456669,353.13782404979014 L605.2533993839585,368.7324134418113"></path><path class="edge section-edge-1 edge-depth-1" d="M 483.76665162390685,347.90523973489854 L 493.0875386021662,380.2326637135196 L502.40842558042556,412.5600876921407"></path><path class="edge section-edge-1 edge-depth-1" d="M 467.42799832697506,342.24302132569807 L 432.152256817731,367.5803755135022 L396.8765153084869,392.9177297013063"></path><path class="edge section-edge-1 edge-depth-0" d="M 417.1019027289249,242.5682069790647 L 444.10755482988554,281.8499355229437 L471.11320693084616,321.13166406682274"></path><path class="edge section-edge-2 edge-depth-1" d="M 628.5804244190373,211.7481587556175 L 701.642194181339,223.4783211889623 L774.7039639436408,235.20848362230714"></path><path class="edge section-edge-2 edge-depth-1" d="M 623.922058058862,220.4128746164545 L 650.9847761746121,249.84963161288488 L678.0474942903621,279.2863886093153"></path><path class="edge section-edge-2 edge-depth-1" d="M 618.2341371963407,195.04999505543094 L 628.4995730391908,162.11920188456412 L638.7650088820408,129.18840871369736"></path><path class="edge section-edge-2 edge-depth-1" d="M 628.1228486814505,205.0116314912827 L 689.8055736010507,186.27954910350675 L751.4882985206509,167.5474667157308"></path><path class="edge section-edge-2 edge-depth-0" d="M 423.5273164021843,228.69185962934077 L 511.18708792224265,219.7889198621705 L598.846859442301,210.88598009500024"></path><path class="edge section-edge-3 edge-depth-1" d="M 238.25821392586562,172.88558036656335 L 230.73895333545494,199.9034799189936 L223.21969274504426,226.92137947142388"></path><path class="edge section-edge-3 edge-depth-1" d="M 232.7991951348543,146.81088741077906 L 206.1580257485083,114.14748906352727 L179.5168563621623,81.48409071627549"></path><path class="edge section-edge-3 edge-depth-1" d="M 227.62392477015015,155.24097044324375 L 163.53359257990735,141.27453969544584 L99.44326038966454,127.30810894764791"></path><path class="edge section-edge-3 edge-depth-1" d="M 227.74085448947187,162.12453057931234 L 164.84302659409974,178.08678683599467 L101.94519869872761,194.049043092677"></path><path class="edge section-edge-3 edge-depth-0" d="M 394.8316714706667,224.26438346238973 L 325.4420256354413,194.32114180319726 L256.05237980021593,164.3779001440048"></path><path class="edge section-edge-4 edge-depth-1" d="M 382.44168572803403,123.96481145898247 L 337.1520269124016,101.71124812994734 L291.86236809676916,79.4576848009122"></path><path class="edge section-edge-4 edge-depth-1" d="M 395.58632901899847,115.58317964574212 L 394.87937197700626,82.23990461137495 L394.17241493501405,48.896629577007786"></path><path class="edge section-edge-4 edge-depth-1" d="M 408.8462372697212,122.99653234808463 L 453.2633713925718,96.97050189205126 L497.6805055154224,70.94447143601789"></path><path class="edge section-edge-4 edge-depth-1" d="M 410.4676927224394,134.17249615183505 L 456.5415622986941,145.53859173296067 L502.6154318749488,156.9046873140863"></path><path class="edge section-edge-4 edge-depth-0" d="M 406.70734553186145,215.32790325814625 L 402.25418917292893,180.39365428022344 L397.8010328139964,145.45940530230064"></path></g><g class="mindmap-nodes"><g transform="translate(346.00417805210043, 211.30749933769698)" class="mindmap-node section--1 section-root"><g transform="translate(62.59990692138672, 18.9)"><circle r="62.59990692138672" class="node-bkg node-circle" id="node-0"></circle></g><g transform="translate(62.59990692138672, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Kafka核心技术</tspan></tspan></text></g></g></g><g transform="translate(208.2572626032594, 291.2395415512725)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-1"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">架构原理</tspan></tspan></text></g></g></g><g transform="translate(437.05633718628394, 314.5923717081905)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-6"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">分区机制</tspan></tspan></text></g></g></g><g transform="translate(570.7340915729025, 190.470340386644)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-11"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">消费者组</tspan></tspan></text></g></g></g><g transform="translate(190.36002916360644, 139.53478426869754)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h93.83987426757812 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-16"></path><line y2="37.8" x2="103.83987426757812" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(51.91993713378906, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Stream处理</tspan></tspan></text></g></g></g><g transform="translate(353.368294074275, 111.6798092227499)" class="mindmap-node section-4"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-21"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-4"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">高可用性</tspan></tspan></text></g></g></g><g transform="translate(213.8386079405484, 385.7926863419093)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h90.04299926757812 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-2"></path><line y2="37.8" x2="100.04299926757812" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(50.02149963378906, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Broker集群</tspan></tspan></text></g></g></g><g transform="translate(326.3257506969429, 270.38839121397393)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h80.453125 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-3"></path><line y2="37.8" x2="90.453125" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(45.2265625, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Topic分区</tspan></tspan></text></g></g></g><g transform="translate(15, 277.17207785341566)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h122.74000549316406 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-4"></path><line y2="37.8" x2="132.74000549316406" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(66.37000274658203, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Producer客户端</tspan></tspan></text></g></g></g><g transform="translate(42.661742685476725, 354.75901304434797)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h129.58375549316406 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-5"></path><line y2="37.8" x2="139.58375549316406" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(69.79187774658203, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Consumer客户端</tspan></tspan></text></g></g></g><g transform="translate(527.0581985319426, 253.18726699238252)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-7"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">分区策略</tspan></tspan></text></g></g></g><g transform="translate(577.6413747050498, 353.8832763913898)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h74.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-8"></path><line y2="37.8" x2="84.109375" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.0546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">副本机制</tspan></tspan></text></g></g></g><g transform="translate(455.4331778842594, 408.0729557188488)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h92.26174926757812 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-9"></path><line y2="37.8" x2="102.26174926757812" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(51.13087463378906, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Leader选举</tspan></tspan></text></g></g></g><g transform="translate(347.896613949178, 382.7683793188139)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h63.59375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-10"></path><line y2="37.8" x2="73.59375" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(36.796875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">ISR机制</tspan></tspan></text></g></g></g><g transform="translate(720.0871086183889, 218.68630199128063)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h128.85437774658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-12"></path><line y2="37.8" x2="138.85437774658203" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(69.42718887329102, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Consumer</tspan><tspan font-weight="normal" class="text-inner-tspan" font-style="normal"> Group</tspan></tspan></text></g></g></g><g transform="translate(645.1634621801303, 271.4289228391258)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-13"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">分区分配</tspan></tspan></text></g></g></g><g transform="translate(580.4790552073833, 95.96806338248427)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h115.5 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-14"></path><line y2="37.8" x2="125.5" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(62.75, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Rebalance机制</tspan></tspan></text></g></g></g><g transform="translate(717.1789316973142, 144.28875782036948)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h87.32424926757812 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-15"></path><line y2="37.8" x2="97.32424926757812" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(48.66212463378906, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Offset管理</tspan></tspan></text></g></g></g><g transform="translate(157.79753067502804, 222.47217556928967)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h112.80081939697266 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-17"></path><line y2="37.8" x2="122.80081939697266" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(61.40040969848633, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Kafka</tspan><tspan font-weight="normal" class="text-inner-tspan" font-style="normal"> Streams</tspan></tspan></text></g></g></g><g transform="translate(127.98139769962108, 50.96019385835701)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h74.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-18"></path><line y2="37.8" x2="84.109375" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(42.0546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">事件时间</tspan></tspan></text></g></g></g><g transform="translate(41.75121956432349, 105.21429512219413)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-19"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">窗口操作</tspan></tspan></text></g></g></g><g transform="translate(44.37008759270827, 178.8387894032918)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-20"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">状态存储</tspan></tspan></text></g></g></g><g transform="translate(235.36376115433677, 53.94268703714477)" class="mindmap-node section-4"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-22"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-4"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">集群部署</tspan></tspan></text></g></g></g><g transform="translate(351.3184512835461, 15)" class="mindmap-node section-4"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-23"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-4"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">故障恢复</tspan></tspan></text></g></g></g><g transform="translate(467.5864501146772, 44.46119456135261)" class="mindmap-node section-4"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-24"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-4"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">数据备份</tspan></tspan></text></g></g></g><g transform="translate(474.64283192692176, 141.59737424317143)" class="mindmap-node section-4"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-25"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-4"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">监控告警</tspan></tspan></text></g></g></g></g></svg></section><section class="chapter"><h2 id="kafka" data-toc="kafka">🏗️ Kafka架构原理</h2><section class="chapter"><h3 id="q1-kafka" data-toc="q1-kafka">Q1: Kafka的整体架构是怎样的？各个组件的作用是什么？</h3><p id="-maunsn_11"><span class="control" id="-maunsn_27">答案：</span></p><p id="-maunsn_12"><span class="control" id="-maunsn_28">Kafka整体架构：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 958.9375 756"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="958.9375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="Kafka集群架构" class="cluster"><rect height="740" width="942.9375" y="8" x="8" style=""></rect><g transform="translate(427.3515625, 8)" class="cluster-label"><foreignObject height="24" width="104.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Kafka集群架构</p></span></div></foreignObject></g></g><g data-look="classic" id="客户端" class="cluster"><rect height="228" width="867.9375" y="28" x="45.5" style=""></rect><g transform="translate(455.4296875, 28)" class="cluster-label"><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>客户端</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="452" width="261.796875" y="276" x="346.03125" style=""></rect><g transform="translate(414.90625, 276)" class="cluster-label"><foreignObject height="24" width="124.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Kafka Broker集群</p></span></div></foreignObject></g></g><g data-look="classic" id="ZooKeeper集群" class="cluster"><rect height="416" width="225.53125" y="300" x="45.5" style=""></rect><g transform="translate(104.1328125, 300)" class="cluster-label"><foreignObject height="24" width="108.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ZooKeeper集群</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Z1_B1_0" d="M233.531,362L239.781,362C246.031,362,258.531,362,271.031,362C283.531,362,296.031,362,308.531,362C321.031,362,333.531,362,343.46,362C353.389,362,360.747,362,367.439,362C374.13,362,380.155,362,383.167,362L386.18,362"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Z2_B2_1" d="M233.531,514L239.781,514C246.031,514,258.531,514,271.031,514C283.531,514,296.031,514,308.531,514C321.031,514,333.531,514,343.46,514C353.389,514,360.747,514,367.439,514C374.13,514,380.155,514,383.167,514L386.18,514"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Z3_B3_2" d="M233.531,654L239.781,654C246.031,654,258.531,654,271.031,654C283.531,654,296.031,654,308.531,654C321.031,654,333.531,654,342.906,654C352.281,654,358.531,654,364.115,654C369.698,654,374.615,654,377.073,654L379.531,654"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1_B1_3" d="M227.273,90L234.566,90C241.859,90,256.445,90,269.988,90C283.531,90,296.031,90,308.531,90C321.031,90,333.531,90,348.644,108.417C363.757,126.833,381.483,163.667,398.92,199.899C416.356,236.132,433.504,271.764,442.078,289.58L450.652,307.396"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2_B2_4" d="M227.273,194L234.566,194C241.859,194,256.445,194,269.988,194C283.531,194,296.031,194,308.531,194C321.031,194,333.531,194,348.951,216.417C364.371,238.833,382.71,283.667,400.797,327.883C418.884,372.099,436.719,415.699,445.636,437.498L454.553,459.298"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B1_C1_5" d="M563.68,362L571.038,362C578.396,362,593.112,362,606.72,316.667C620.328,271.333,632.828,180.667,642.203,135.333C651.578,90,657.828,90,663.411,90C668.995,90,673.911,90,676.37,90L678.828,90"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B2_C2_6" d="M563.68,514L571.038,514C578.396,514,593.112,514,606.72,460.667C620.328,407.333,632.828,300.667,642.203,247.333C651.578,194,657.828,194,663.411,194C668.995,194,673.911,194,676.37,194L678.828,194"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(158.265625, 90)" id="flowchart-P1-6987" class="node default"><rect height="54" width="138.015625" y="-27" x="-69.0078125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-39.0078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="78.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Producer-1</p></span></div></foreignObject></g></g><g transform="translate(158.265625, 362)" id="flowchart-Z1-6981" class="node default"><rect height="54" width="150.53125" y="-27" x="-75.265625" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-45.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ZooKeeper-1</p></span></div></foreignObject></g></g><g transform="translate(476.9296875, 362)" id="flowchart-B1-6984" class="node default"><rect height="102" width="173.5" y="-51" x="-86.75" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-56.75, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="113.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Broker-1<br>Leader: T1-P0<br>Follower: T1-P1</p></span></div></foreignObject></g></g><g transform="translate(158.265625, 514)" id="flowchart-Z2-6982" class="node default"><rect height="54" width="150.53125" y="-27" x="-75.265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ZooKeeper-2</p></span></div></foreignObject></g></g><g transform="translate(476.9296875, 514)" id="flowchart-B2-6985" class="node default"><rect height="102" width="173.5" y="-51" x="-86.75" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.75, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="113.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Broker-2<br>Leader: T1-P1<br>Follower: T1-P0</p></span></div></foreignObject></g></g><g transform="translate(158.265625, 654)" id="flowchart-Z3-6983" class="node default"><rect height="54" width="150.53125" y="-27" x="-75.265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.265625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.53125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ZooKeeper-3</p></span></div></foreignObject></g></g><g transform="translate(476.9296875, 654)" id="flowchart-B3-6986" class="node default"><rect height="78" width="186.796875" y="-39" x="-93.3984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.3984375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="126.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Broker-3<br>Replica: T1-P0,P1</p></span></div></foreignObject></g></g><g transform="translate(158.265625, 194)" id="flowchart-P2-6988" class="node default"><rect height="54" width="138.015625" y="-27" x="-69.0078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-39.0078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="78.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Producer-2</p></span></div></foreignObject></g></g><g transform="translate(779.3828125, 90)" id="flowchart-C1-6989" class="node default"><rect height="54" width="193.109375" y="-27" x="-96.5546875" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-66.5546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="133.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer Group-1</p></span></div></foreignObject></g></g><g transform="translate(779.3828125, 194)" id="flowchart-C2-6990" class="node default"><rect height="54" width="193.109375" y="-27" x="-96.5546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.5546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="133.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer Group-2</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-maunsn_14"><span class="control" id="-maunsn_29">核心组件详解：</span></p><p id="-maunsn_15"><span class="control" id="-maunsn_30">1. Broker（代理节点）</span></p><ul class="list _bullet" id="-maunsn_16"><li class="list__item" id="-maunsn_31"><p id="-maunsn_35">Kafka集群的核心服务器节点</p></li><li class="list__item" id="-maunsn_32"><p id="-maunsn_36">负责消息的存储、转发和管理</p></li><li class="list__item" id="-maunsn_33"><p id="-maunsn_37">每个Broker有唯一的ID标识</p></li><li class="list__item" id="-maunsn_34"><p id="-maunsn_38">支持水平扩展和故障转移</p></li></ul><p id="-maunsn_17"><span class="control" id="-maunsn_39">2. Topic（主题）</span></p><ul class="list _bullet" id="-maunsn_18"><li class="list__item" id="-maunsn_40"><p id="-maunsn_43">消息的逻辑分类和组织单位</p></li><li class="list__item" id="-maunsn_41"><p id="-maunsn_44">支持多分区并行处理</p></li><li class="list__item" id="-maunsn_42"><p id="-maunsn_45">每个Topic可配置副本数和保留策略</p></li></ul><p id="-maunsn_19"><span class="control" id="-maunsn_46">3. Partition（分区）</span></p><ul class="list _bullet" id="-maunsn_20"><li class="list__item" id="-maunsn_47"><p id="-maunsn_50">Topic的物理存储单位</p></li><li class="list__item" id="-maunsn_48"><p id="-maunsn_51">每个分区是一个有序的消息序列</p></li><li class="list__item" id="-maunsn_49"><p id="-maunsn_52">支持并发读写和负载均衡</p></li></ul><p id="-maunsn_21"><span class="control" id="-maunsn_53">4. Producer（生产者）</span></p><ul class="list _bullet" id="-maunsn_22"><li class="list__item" id="-maunsn_54"><p id="-maunsn_57">消息的发送端</p></li><li class="list__item" id="-maunsn_55"><p id="-maunsn_58">负责选择分区和发送策略</p></li><li class="list__item" id="-maunsn_56"><p id="-maunsn_59">支持同步/异步发送和批量操作</p></li></ul><p id="-maunsn_23"><span class="control" id="-maunsn_60">5. Consumer（消费者）</span></p><ul class="list _bullet" id="-maunsn_24"><li class="list__item" id="-maunsn_61"><p id="-maunsn_64">消息的接收端</p></li><li class="list__item" id="-maunsn_62"><p id="-maunsn_65">支持Consumer Group概念</p></li><li class="list__item" id="-maunsn_63"><p id="-maunsn_66">管理消费进度和分区分配</p></li></ul><p id="-maunsn_25"><span class="control" id="-maunsn_67">Kafka核心特性：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 748.453125 346"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="748.453125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="Kafka核心特性" class="cluster"><rect height="330" width="732.453125" y="8" x="8" style=""></rect><g transform="translate(322.109375, 8)" class="cluster-label"><foreignObject height="24" width="104.234375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Kafka核心特性</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_A1_0" d="M113.063,99.5L113.063,105.75C113.063,112,113.063,124.5,113.063,133.875C113.063,143.25,113.063,149.5,113.063,155.083C113.063,160.667,113.063,165.583,113.063,168.042L113.063,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_1" d="M295.18,99.5L295.18,105.75C295.18,112,295.18,124.5,295.18,133.875C295.18,143.25,295.18,149.5,295.18,155.083C295.18,160.667,295.18,165.583,295.18,168.042L295.18,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_2" d="M469.289,99.5L469.289,105.75C469.289,112,469.289,124.5,469.289,133.875C469.289,143.25,469.289,149.5,469.289,155.083C469.289,160.667,469.289,165.583,469.289,168.042L469.289,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_3" d="M643.398,99.5L643.398,105.75C643.398,112,643.398,124.5,643.398,133.875C643.398,143.25,643.398,149.5,643.398,155.083C643.398,160.667,643.398,165.583,643.398,168.042L643.398,170.5"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(113.0625, 72.5)" id="flowchart-A-7156" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>高吞吐量</p></span></div></foreignObject></g></g><g transform="translate(113.0625, 237.5)" id="flowchart-A1-7157" class="node default"><rect height="126" width="140.125" y="-63" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分区并行<br>批量处理<br>零拷贝技术<br>顺序写入</p></span></div></foreignObject></g></g><g transform="translate(295.1796875, 72.5)" id="flowchart-B-7158" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>持久化</p></span></div></foreignObject></g></g><g transform="translate(295.1796875, 237.5)" id="flowchart-B1-7159" class="node default"><rect height="126" width="124.109375" y="-63" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>磁盘存储<br>副本机制<br>日志结构<br>压缩存储</p></span></div></foreignObject></g></g><g transform="translate(469.2890625, 72.5)" id="flowchart-C-7160" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分布式</p></span></div></foreignObject></g></g><g transform="translate(469.2890625, 237.5)" id="flowchart-C1-7161" class="node default"><rect height="126" width="124.109375" y="-63" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>集群部署<br>负载均衡<br>故障转移<br>水平扩展</p></span></div></foreignObject></g></g><g transform="translate(643.3984375, 72.5)" id="flowchart-D-7162" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>实时性</p></span></div></foreignObject></g></g><g transform="translate(643.3984375, 237.5)" id="flowchart-D1-7163" class="node default"><rect height="126" width="124.109375" y="-63" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>推拉结合<br>低延迟<br>流处理<br>事件驱动</p></span></div></foreignObject></g></g></g></g></g></g></g></svg></section><section class="chapter"><h3 id="q2-kafka" data-toc="q2-kafka">Q2: Kafka为什么能实现高吞吐量？有哪些关键技术？</h3><p id="-maunsn_68"><span class="control" id="-maunsn_77">答案：</span></p><p id="-maunsn_69"><span class="control" id="-maunsn_78">高吞吐量实现机制：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1043.625 322"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1043.625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="Kafka高吞吐量技术" class="cluster"><rect height="306" width="1027.625" y="8" x="8" style=""></rect><g transform="translate(453.671875, 8)" class="cluster-label"><foreignObject height="24" width="136.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Kafka高吞吐量技术</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_A1_0" d="M113.063,99.5L113.063,105.75C113.063,112,113.063,124.5,113.063,133.875C113.063,143.25,113.063,149.5,113.063,155.083C113.063,160.667,113.063,165.583,113.063,168.042L113.063,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_B1_1" d="M295.18,99.5L295.18,105.75C295.18,112,295.18,124.5,295.18,133.875C295.18,143.25,295.18,149.5,295.18,155.083C295.18,160.667,295.18,165.583,295.18,168.042L295.18,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_C1_2" d="M497.773,99.5L497.773,105.75C497.773,112,497.773,124.5,497.773,133.875C497.773,143.25,497.773,149.5,497.773,155.083C497.773,160.667,497.773,165.583,497.773,168.042L497.773,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_D1_3" d="M716.391,99.5L716.391,105.75C716.391,112,716.391,124.5,716.391,133.875C716.391,143.25,716.391,149.5,716.391,155.083C716.391,160.667,716.391,165.583,716.391,168.042L716.391,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_E1_4" d="M922.547,99.5L922.547,105.75C922.547,112,922.547,124.5,922.547,133.875C922.547,143.25,922.547,149.5,922.547,155.083C922.547,160.667,922.547,165.583,922.547,168.042L922.547,170.5"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(113.0625, 72.5)" id="flowchart-A-7400" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#e1f5fe !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分区并行</p></span></div></foreignObject></g></g><g transform="translate(113.0625, 225.5)" id="flowchart-A1-7401" class="node default"><rect height="102" width="140.125" y="-51" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>多分区写入<br>并发消费<br>负载分散</p></span></div></foreignObject></g></g><g transform="translate(295.1796875, 72.5)" id="flowchart-B-7402" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>批量处理</p></span></div></foreignObject></g></g><g transform="translate(295.1796875, 225.5)" id="flowchart-B1-7403" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>批量发送<br>批量写入<br>批量压缩</p></span></div></foreignObject></g></g><g transform="translate(497.7734375, 72.5)" id="flowchart-C-7404" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>零拷贝</p></span></div></foreignObject></g></g><g transform="translate(497.7734375, 225.5)" id="flowchart-C1-7405" class="node default"><rect height="102" width="181.078125" y="-51" x="-90.5390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-60.5390625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="121.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sendfile系统调用<br>减少内存拷贝<br>直接文件传输</p></span></div></foreignObject></g></g><g transform="translate(716.390625, 72.5)" id="flowchart-D-7406" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="fill:#f3e5f5 !important" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>顺序写入</p></span></div></foreignObject></g></g><g transform="translate(716.390625, 225.5)" id="flowchart-D1-7407" class="node default"><rect height="102" width="156.15625" y="-51" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>磁盘顺序I/O<br>避免随机写入<br>充分利用缓存</p></span></div></foreignObject></g></g><g transform="translate(922.546875, 72.5)" id="flowchart-E-7408" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>页缓存</p></span></div></foreignObject></g></g><g transform="translate(922.546875, 225.5)" id="flowchart-E1-7409" class="node default"><rect height="102" width="156.15625" y="-51" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>操作系统缓存<br>预读机制<br>延迟写入</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-maunsn_71"><span class="control" id="-maunsn_79">1. 分区并行技术</span></p><div class="code-block" data-lang="java">
// 生产者分区策略
public class KafkaProducerConfig {
    
    // 自定义分区器
    public static class CustomPartitioner implements Partitioner {
        @Override
        public int partition(String topic, Object key, byte[] keyBytes, 
                           Object value, byte[] valueBytes, Cluster cluster) {
            // 根据key的hash值分区
            if (keyBytes == null) {
                return ThreadLocalRandom.current().nextInt(
                    cluster.partitionCountForTopic(topic));
            }
            // 保证相同key的消息分配到同一分区
            return Math.abs(key.hashCode()) % cluster.partitionCountForTopic(topic);
        }
    }
    
    // 配置生产者实现并行发送
    public Properties getProducerConfig() {
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        props.put(ProducerConfig.PARTITIONER_CLASS_CONFIG, CustomPartitioner.class);
        
        // 批量配置提高吞吐量
        props.put(ProducerConfig.BATCH_SIZE_CONFIG, 16384); // 16KB批量大小
        props.put(ProducerConfig.LINGER_MS_CONFIG, 10);     // 10ms延迟发送
        props.put(ProducerConfig.BUFFER_MEMORY_CONFIG, 33554432); // 32MB缓冲区
        
        // 压缩配置
        props.put(ProducerConfig.COMPRESSION_TYPE_CONFIG, &quot;lz4&quot;);
        
        return props;
    }
}

// 消费者并行消费
public class ParallelConsumer {
    
    public void startConsumers() {
        // 启动多个消费者实例并行消费不同分区
        for (int i = 0; i &lt; PARTITION_COUNT; i++) {
            Thread consumerThread = new Thread(() -&gt; {
                KafkaConsumer&lt;String, String&gt; consumer = createConsumer();
                consumer.subscribe(Arrays.asList(&quot;my-topic&quot;));
                
                while (true) {
                    ConsumerRecords&lt;String, String&gt; records = consumer.poll(1000);
                    // 并行处理消息
                    records.forEach(record -&gt; processMessage(record));
                }
            });
            consumerThread.start();
        }
    }
}
</div><p id="-maunsn_73"><span class="control" id="-maunsn_80">2. 批量处理优化</span></p><div class="code-block" data-lang="java">
// 批量发送配置
public class BatchProducer {
    
    public void sendBatchMessages() {
        Producer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(getProducerConfig());
        
        // 收集批量消息
        List&lt;ProducerRecord&lt;String, String&gt;&gt; batch = new ArrayList&lt;&gt;();
        
        for (int i = 0; i &lt; 1000; i++) {
            batch.add(new ProducerRecord&lt;&gt;(&quot;my-topic&quot;, &quot;key-&quot; + i, &quot;message-&quot; + i));
        }
        
        // 异步批量发送
        List&lt;Future&lt;RecordMetadata&gt;&gt; futures = new ArrayList&lt;&gt;();
        for (ProducerRecord&lt;String, String&gt; record : batch) {
            Future&lt;RecordMetadata&gt; future = producer.send(record, 
                (metadata, exception) -&gt; {
                    if (exception != null) {
                        log.error(&quot;发送失败&quot;, exception);
                    } else {
                        log.info(&quot;发送成功: partition={}, offset={}&quot;, 
                               metadata.partition(), metadata.offset());
                    }
                });
            futures.add(future);
        }
        
        // 等待所有消息发送完成
        futures.forEach(future -&gt; {
            try {
                future.get();
            } catch (Exception e) {
                log.error(&quot;等待发送结果失败&quot;, e);
            }
        });
        
        producer.close();
    }
}
</div><p id="-maunsn_75"><span class="control" id="-maunsn_81">3. 零拷贝技术</span></p><div class="code-block" data-lang="java">
// Kafka中的零拷贝实现示例（简化说明）
public class ZeroCopyExample {
    
    // 传统拷贝方式（4次拷贝）
    public void traditionalCopy(FileInputStream in, SocketChannel out) {
        byte[] buffer = new byte[8192];
        int bytesRead;
        try {
            while ((bytesRead = in.read(buffer)) != -1) {
                // 数据从内核空间拷贝到用户空间，再从用户空间拷贝到内核空间
                out.write(ByteBuffer.wrap(buffer, 0, bytesRead));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    // 零拷贝方式（2次拷贝）
    public void zeroCopy(FileChannel in, SocketChannel out) {
        try {
            // 直接在内核空间进行数据传输，避免用户空间拷贝
            long transferred = in.transferTo(0, in.size(), out);
            log.info(&quot;零拷贝传输字节数: {}&quot;, transferred);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
</div></section></section><section class="chapter"><h2 id="-maunsn_6" data-toc="-maunsn_6">📊 分区机制</h2><section class="chapter"><h3 id="q3-kafka" data-toc="q3-kafka">Q3: Kafka的分区机制是如何工作的？如何保证数据的可靠性？</h3><p id="-maunsn_84"><span class="control" id="-maunsn_95">答案：</span></p><p id="-maunsn_85"><span class="control" id="-maunsn_96">分区机制架构：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1611.9375 592"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1611.9375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="Topic分区架构" class="cluster"><rect height="576" width="1595.9375" y="8" x="8" style=""></rect><g transform="translate(755.21875, 8)" class="cluster-label"><foreignObject height="24" width="101.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Topic分区架构</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(37.5, 35)" class="root"><g class="clusters"><g data-look="classic" id="subGraph3" class="cluster"><rect height="506" width="1520.9375" y="8" x="8" style=""></rect><g transform="translate(668.46875, 8)" class="cluster-label"><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Topic: user-events (3分区，3副本)</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(35, 50)" class="root"><g class="clusters"><g data-look="classic" id="Partition-2" class="cluster"><rect height="406" width="364.125" y="8" x="8" style=""></rect><g transform="translate(151.828125, 8)" class="cluster-label"><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-2</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2L_P2F1_4" d="M157.006,148.5L148.177,158.917C139.348,169.333,121.69,190.167,112.86,205.792C104.031,221.417,104.031,231.833,104.031,241.583C104.031,251.333,104.031,260.417,104.031,264.958L104.031,269.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2L_P2F2_5" d="M223.119,148.5L231.948,158.917C240.777,169.333,258.435,190.167,267.265,205.792C276.094,221.417,276.094,231.833,276.094,241.583C276.094,251.333,276.094,260.417,276.094,264.958L276.094,269.5"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(190.0625, 109.5)" id="flowchart-P2L-7689" class="node default"><rect height="78" width="121.34375" y="-39" x="-60.671875" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-30.671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="61.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Leader<br>Broker-3</p></span></div></foreignObject></g></g><g transform="translate(104.03125, 312.5)" id="flowchart-P2F1-7690" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-1</p></span></div></foreignObject></g></g><g transform="translate(276.09375, 312.5)" id="flowchart-P2F2-7691" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-2</p></span></div></foreignObject></g></g></g></g><g transform="translate(449.125, 115)" class="root"><g class="clusters"><g data-look="classic" id="Partition-1" class="cluster"><rect height="276" width="493.40625" y="8" x="8" style=""></rect><g transform="translate(216.46875, 8)" class="cluster-label"><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-1</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1L_P1F1_2" d="M191.844,114.475L202.26,109.062C212.677,103.65,233.51,92.825,249.135,87.412C264.76,82,275.177,82,284.927,82C294.677,82,303.76,82,308.302,82L312.844,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1L_P1F2_3" d="M191.844,177.525L202.26,182.938C212.677,188.35,233.51,199.175,249.135,204.588C264.76,210,275.177,210,284.927,210C294.677,210,303.76,210,308.302,210L312.844,210"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(131.171875, 146)" id="flowchart-P1L-7686" class="node default"><rect height="78" width="121.34375" y="-39" x="-60.671875" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-30.671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="61.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Leader<br>Broker-2</p></span></div></foreignObject></g></g><g transform="translate(377.875, 82)" id="flowchart-P1F1-7687" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-1</p></span></div></foreignObject></g></g><g transform="translate(377.875, 210)" id="flowchart-P1F2-7688" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-3</p></span></div></foreignObject></g></g></g></g><g transform="translate(992.53125, 115)" class="root"><g class="clusters"><g data-look="classic" id="Partition-0" class="cluster"><rect height="276" width="493.40625" y="8" x="8" style=""></rect><g transform="translate(216.46875, 8)" class="cluster-label"><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-0</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P0L_P0F1_0" d="M191.844,114.475L202.26,109.062C212.677,103.65,233.51,92.825,249.135,87.412C264.76,82,275.177,82,284.927,82C294.677,82,303.76,82,308.302,82L312.844,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P0L_P0F2_1" d="M191.844,177.525L202.26,182.938C212.677,188.35,233.51,199.175,249.135,204.588C264.76,210,275.177,210,284.927,210C294.677,210,303.76,210,308.302,210L312.844,210"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(131.171875, 146)" id="flowchart-P0L-7683" class="node default"><rect height="78" width="121.34375" y="-39" x="-60.671875" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-30.671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="61.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Leader<br>Broker-1</p></span></div></foreignObject></g></g><g transform="translate(377.875, 82)" id="flowchart-P0F1-7684" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-2</p></span></div></foreignObject></g></g><g transform="translate(377.875, 210)" id="flowchart-P0F2-7685" class="node default"><rect height="78" width="122.0625" y="-39" x="-61.03125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-31.03125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="62.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Follower<br>Broker-3</p></span></div></foreignObject></g></g></g></g></g></g></g></g></g></g></g></svg><p id="-maunsn_87"><span class="control" id="-maunsn_97">分区的作用和特点：</span></p><ol class="list _decimal" id="-maunsn_88" type="1"><li class="list__item" id="-maunsn_98"><p id="-maunsn_102"><span class="control" id="-maunsn_103">并行处理</span>: 多个分区可以并行读写</p></li><li class="list__item" id="-maunsn_99"><p id="-maunsn_104"><span class="control" id="-maunsn_105">负载均衡</span>: 分区分布在不同Broker上</p></li><li class="list__item" id="-maunsn_100"><p id="-maunsn_106"><span class="control" id="-maunsn_107">顺序保证</span>: 分区内消息严格有序</p></li><li class="list__item" id="-maunsn_101"><p id="-maunsn_108"><span class="control" id="-maunsn_109">扩展性</span>: 可以增加分区数量扩展性能</p></li></ol><p id="-maunsn_89"><span class="control" id="-maunsn_110">副本机制详解：</span></p><div class="code-block" data-lang="java">
// Topic创建时的副本配置
public class TopicManagement {
    
    public void createTopicWithReplicas() {
        Properties config = new Properties();
        config.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        
        AdminClient adminClient = AdminClient.create(config);
        
        // 创建Topic配置
        NewTopic newTopic = new NewTopic(&quot;user-events&quot;, 3, (short) 3);
        
        // 设置Topic级别配置
        Map&lt;String, String&gt; configs = new HashMap&lt;&gt;();
        configs.put(&quot;min.insync.replicas&quot;, &quot;2&quot;);  // 最小同步副本数
        configs.put(&quot;unclean.leader.election.enable&quot;, &quot;false&quot;); // 禁止非ISR副本成为Leader
        configs.put(&quot;retention.ms&quot;, &quot;604800000&quot;); // 7天保留期
        
        newTopic.configs(configs);
        
        CreateTopicsResult result = adminClient.createTopics(Arrays.asList(newTopic));
        
        result.all().whenComplete((ignored, exception) -&gt; {
            if (exception != null) {
                log.error(&quot;Topic创建失败&quot;, exception);
            } else {
                log.info(&quot;Topic创建成功&quot;);
            }
            adminClient.close();
        });
    }
}
</div><p id="-maunsn_91"><span class="control" id="-maunsn_111">ISR (In-Sync Replicas) 机制：</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 867 843" style="max-width: 867px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="F2" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="617"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="692"><tspan dy="0" x="692">Follower-2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="F1" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="417"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="492"><tspan dy="0" x="492">Follower-1</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="217"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="292"><tspan dy="0" x="292">Leader</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="P" height="65" width="150" stroke="#666" fill="#eaeaea" y="757" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="789.5" x="75"><tspan dy="0" x="75">Producer</tspan></text></g><g><line name="F2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="692" y1="5" x1="692" id="actor262"></line><g id="root-262"><rect class="actor actor-top" ry="3" rx="3" name="F2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="617"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="692"><tspan dy="0" x="692">Follower-2</tspan></text></g></g><g><line name="F1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="492" y1="5" x1="492" id="actor261"></line><g id="root-261"><rect class="actor actor-top" ry="3" rx="3" name="F1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="417"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="492"><tspan dy="0" x="492">Follower-1</tspan></text></g></g><g><line name="L" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="292" y1="5" x1="292" id="actor260"></line><g id="root-260"><rect class="actor actor-top" ry="3" rx="3" name="L" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="217"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="292"><tspan dy="0" x="292">Leader</tspan></text></g></g><g><line name="P" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="757" x2="75" y1="5" x1="75" id="actor259"></line><g id="root-259"><rect class="actor actor-top" ry="3" rx="3" name="P" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Producer</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="450" stroke="#666" fill="#EDF2AE" y="75" x="267"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="492"><tspan x="492">ISR: [Leader, Follower-1, Follower-2]</tspan></text></g><g><line class="loopLine" y2="250" x2="703" y1="250" x1="281"></line><line class="loopLine" y2="391" x2="703" y1="250" x1="703"></line><line class="loopLine" y2="391" x2="703" y1="391" x1="281"></line><line class="loopLine" y2="391" x2="281" y1="250" x1="281"></line><polygon class="labelBox" points="281,250 331,250 331,263 322.6,270 281,270"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="263" x="306">par</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="268" x="517"><tspan x="517">[同步复制]</tspan></text></g><g><rect class="note" height="39" width="150" stroke="#666" fill="#EDF2AE" y="497" x="217"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="502" x="292"><tspan x="292">检查ISR状态</tspan></text></g><g><rect class="note" height="39" width="450" stroke="#666" fill="#EDF2AE" y="591" x="267"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="596" x="492"><tspan x="492">将F2从ISR中移除</tspan></text></g><g><rect class="note" height="39" width="250" stroke="#666" fill="#EDF2AE" y="640" x="267"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="645" x="392"><tspan x="392">ISR: [Leader, Follower-1]</tspan></text></g><g><line class="loopLine" y2="546" x2="727" y1="546" x1="257"></line><line class="loopLine" y2="689" x2="727" y1="546" x1="727"></line><line class="loopLine" y2="689" x2="727" y1="689" x1="257"></line><line class="loopLine" y2="689" x2="257" y1="546" x1="257"></line><polygon class="labelBox" points="257,546 307,546 307,559 298.6,566 257,566"></polygon><text style="font-size: 16px; font-weight: 400;" class="labelText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="559" x="282">alt</text><text style="font-size: 16px; font-weight: 400;" class="loopText" text-anchor="middle" y="564" x="517"><tspan x="517">[F2响应超时]</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="182">1. 发送消息</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="162" x2="288" y1="162" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="177" x="293">2. 写入本地Log</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 293,210 C 353,200 353,240 293,230"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="300" x="391">3a. 复制消息</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="333" x2="488" y1="333" x1="293"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="348" x="491">3b. 复制消息</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="381" x2="688" y1="381" x1="293"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="406" x="394">4a. 确认接收</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="439" x2="296" y1="439" x1="491"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="454" x="494">4b. 确认接收 (延迟)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="487" x2="296" y1="487" x1="691"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="704" x="185">5. 返回确认 (ack=all)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="737" x2="79" y1="737" x1="291"></line></svg><p id="-maunsn_93"><span class="control" id="-maunsn_112">生产者可靠性配置：</span></p><div class="code-block" data-lang="java">
// 生产者可靠性配置
public class ReliableKafkaProducer {
    
    public Properties getReliableProducerConfig() {
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        
        // 可靠性配置
        props.put(ProducerConfig.ACKS_CONFIG, &quot;all&quot;);           // 等待所有ISR副本确认
        props.put(ProducerConfig.RETRIES_CONFIG, Integer.MAX_VALUE); // 无限重试
        props.put(ProducerConfig.MAX_IN_FLIGHT_REQUESTS_PER_CONNECTION, 1); // 保证顺序
        props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, true);    // 幂等性
        
        // 超时配置
        props.put(ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG, 30000);
        props.put(ProducerConfig.DELIVERY_TIMEOUT_MS_CONFIG, 300000);
        
        return props;
    }
    
    public void sendReliableMessage() {
        Producer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(getReliableProducerConfig());
        
        try {
            // 同步发送确保可靠性
            RecordMetadata metadata = producer.send(
                new ProducerRecord&lt;&gt;(&quot;user-events&quot;, &quot;user-123&quot;, &quot;login-event&quot;)
            ).get();
            
            log.info(&quot;消息发送成功: topic={}, partition={}, offset={}&quot;, 
                   metadata.topic(), metadata.partition(), metadata.offset());
                   
        } catch (Exception e) {
            log.error(&quot;消息发送失败&quot;, e);
            // 实现补偿逻辑
            handleSendFailure();
        } finally {
            producer.close();
        }
    }
}
</div></section><section class="chapter"><h3 id="q4-consumer-group-rebalance" data-toc="q4-consumer-group-rebalance">Q4: Consumer Group是如何工作的？Rebalance机制是什么？</h3><p id="-maunsn_113"><span class="control" id="-maunsn_124">答案：</span></p><p id="-maunsn_114"><span class="control" id="-maunsn_125">Consumer Group架构：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 656.9375 701"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="656.9375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="subGraph3" class="cluster"><rect height="685" width="640.9375" y="8" x="8" style=""></rect><g transform="translate(253.046875, 8)" class="cluster-label"><foreignObject height="24" width="150.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer Group架构</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph2" class="cluster"><rect height="274" width="279.46875" y="28" x="331.96875" style=""></rect><g transform="translate(375.09375, 28)" class="cluster-label"><foreignObject height="24" width="193.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer Group: analytics</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="351" width="279.46875" y="322" x="331.96875" style=""></rect><g transform="translate(371.703125, 322)" class="cluster-label"><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer Group: order-processors</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="622" width="211.46875" y="28" x="45.5" style=""></rect><g transform="translate(67.953125, 28)" class="cluster-label"><foreignObject height="24" width="166.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Topic: orders (4个分区)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P0_C1_0" d="M165.026,199L180.35,229C195.673,259,226.321,319,247.895,349C269.469,379,281.969,379,294.469,379C306.969,379,319.469,379,331.186,381.034C342.902,383.069,353.836,387.138,364.145,390.974C374.454,394.81,384.137,398.414,388.979,400.216L393.821,402.018"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1_C1_1" d="M164.894,303L180.24,333.333C195.585,363.667,226.277,424.333,247.873,454.667C269.469,485,281.969,485,294.469,485C306.969,485,319.469,485,331.186,482.887C342.902,480.775,353.836,476.549,364.148,472.565C374.459,468.58,384.149,464.835,388.994,462.963L393.839,461.09"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2_C2_2" d="M168.329,407L183.102,430.333C197.876,453.667,227.422,500.333,248.445,523.667C269.469,547,281.969,547,294.469,547C306.969,547,319.469,547,331.186,549.034C342.902,551.069,353.836,555.138,364.145,558.974C374.454,562.81,384.137,566.414,388.979,568.216L393.821,570.018"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P3_C2_3" d="M174.073,511L187.889,527.333C201.705,543.667,229.337,576.333,249.403,592.667C269.469,609,281.969,609,294.469,609C306.969,609,319.469,609,331.186,608.609C342.902,608.218,353.836,607.435,364.105,606.7C374.373,605.965,383.977,605.278,388.779,604.934L393.581,604.591"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P0_C3_4" d="M181.931,145L194.438,134C206.944,123,231.956,101,250.713,90C269.469,79,281.969,79,294.469,79C306.969,79,319.469,79,328.844,79.649C338.219,80.297,344.469,81.594,350.066,82.756C355.663,83.917,360.608,84.944,363.08,85.457L365.552,85.97"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P1_C3_5" d="M172.381,249L186.479,231C200.577,213,228.773,177,249.121,159C269.469,141,281.969,141,294.469,141C306.969,141,319.469,141,328.844,140.262C338.219,139.524,344.469,138.048,350.07,136.725C355.671,135.402,360.623,134.233,363.1,133.648L365.576,133.063"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P2_C3_6" d="M167.363,353L182.298,328C197.232,303,227.1,253,248.285,228C269.469,203,281.969,203,294.469,203C306.969,203,319.469,203,332.583,198.333C345.697,193.667,359.425,184.333,372.602,175.375C385.779,166.416,398.405,157.833,404.718,153.541L411.031,149.249"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_P3_C3_7" d="M164.27,457L179.72,425C195.17,393,226.069,329,247.769,297C269.469,265,281.969,265,294.469,265C306.969,265,319.469,265,334.471,255.167C349.473,245.333,366.977,225.667,384.037,206.498C401.098,187.329,417.715,168.659,426.024,159.323L434.333,149.988"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(471.703125, 108)" id="flowchart-C3-8031" class="node default"><rect height="78" width="204.46875" y="-39" x="-102.234375" data-et="node" data-id="abc" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-72.234375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="144.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer-3<br>分配: P0, P1, P2, P3</p></span></div></foreignObject></g></g><g transform="translate(151.234375, 172)" id="flowchart-P0-8025" class="node default"><rect height="54" width="136.46875" y="-27" x="-68.234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-38.234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-0</p></span></div></foreignObject></g></g><g transform="translate(471.703125, 431)" id="flowchart-C1-8029" class="node default"><rect height="78" width="148.265625" y="-39" x="-74.1328125" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-44.1328125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="88.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer-1<br>分配: P0, P1</p></span></div></foreignObject></g></g><g transform="translate(151.234375, 276)" id="flowchart-P1-8026" class="node default"><rect height="54" width="136.46875" y="-27" x="-68.234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-38.234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-1</p></span></div></foreignObject></g></g><g transform="translate(151.234375, 380)" id="flowchart-P2-8027" class="node default"><rect height="54" width="136.46875" y="-27" x="-68.234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-38.234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-2</p></span></div></foreignObject></g></g><g transform="translate(471.703125, 599)" id="flowchart-C2-8030" class="node default"><rect height="78" width="148.265625" y="-39" x="-74.1328125" data-et="node" data-id="abc" style="fill:#c8e6c9 !important" class="basic label-container"></rect><g transform="translate(-44.1328125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="88.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer-2<br>分配: P2, P3</p></span></div></foreignObject></g></g><g transform="translate(151.234375, 484)" id="flowchart-P3-8028" class="node default"><rect height="54" width="136.46875" y="-27" x="-68.234375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-38.234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="76.46875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Partition-3</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-maunsn_116"><span class="control" id="-maunsn_126">Consumer Group特性：</span></p><ol class="list _decimal" id="-maunsn_117" type="1"><li class="list__item" id="-maunsn_127"><p id="-maunsn_131"><span class="control" id="-maunsn_132">负载均衡</span>: 分区在Consumer之间平均分配</p></li><li class="list__item" id="-maunsn_128"><p id="-maunsn_133"><span class="control" id="-maunsn_134">故障转移</span>: Consumer故障时自动重新分配分区</p></li><li class="list__item" id="-maunsn_129"><p id="-maunsn_135"><span class="control" id="-maunsn_136">独立消费</span>: 不同Consumer Group独立消费所有消息</p></li><li class="list__item" id="-maunsn_130"><p id="-maunsn_137"><span class="control" id="-maunsn_138">扩展性</span>: 可以动态增减Consumer实例</p></li></ol><p id="-maunsn_118"><span class="control" id="-maunsn_139">Rebalance触发条件：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1102.109375 274"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1102.109375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="Rebalance触发条件" class="cluster"><rect height="258" width="1086.109375" y="8" x="8" style=""></rect><g transform="translate(482.28125, 8)" class="cluster-label"><foreignObject height="24" width="137.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Rebalance触发条件</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_R_0" d="M124.297,99.5L124.297,105.75C124.297,112,124.297,124.5,151.897,135.051C179.497,145.601,234.698,154.202,289.24,162.701C343.782,171.199,397.665,179.595,424.606,183.793L451.548,187.991"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_R_1" d="M336.891,99.5L336.891,105.75C336.891,112,336.891,124.5,346.775,133.916C356.659,143.332,376.427,149.664,395.56,155.793C414.694,161.922,433.192,167.848,442.441,170.81L451.691,173.773"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_R_2" d="M538.25,99.5L538.25,105.75C538.25,112,538.25,124.5,538.25,133.875C538.25,143.25,538.25,149.5,538.25,155.083C538.25,160.667,538.25,165.583,538.25,168.042L538.25,170.5"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_R_3" d="M755.633,99.5L755.633,105.75C755.633,112,755.633,124.5,744.413,134.079C733.194,143.658,710.755,150.316,688.956,156.784C667.156,163.252,645.995,169.531,635.415,172.67L624.835,175.809"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_R_4" d="M981.031,99.5L981.031,105.75C981.031,112,981.031,124.5,951.029,135.12C921.026,145.741,861.021,154.482,801.675,163.127C742.33,171.772,683.644,180.32,654.301,184.595L624.958,188.869"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(124.296875, 72.5)" id="flowchart-A-8142" class="node default"><rect height="54" width="162.59375" y="-27" x="-81.296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-51.296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer加入</p></span></div></foreignObject></g></g><g transform="translate(538.25, 201.5)" id="flowchart-R-8143" class="node default"><rect height="54" width="165.5" y="-27" x="-82.75" data-et="node" data-id="abc" style="fill:#ffcdd2 !important" class="basic label-container"></rect><g transform="translate(-52.75, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="105.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>触发Rebalance</p></span></div></foreignObject></g></g><g transform="translate(336.890625, 72.5)" id="flowchart-B-8144" class="node default"><rect height="54" width="162.59375" y="-27" x="-81.296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-51.296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="102.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer离开</p></span></div></foreignObject></g></g><g transform="translate(538.25, 72.5)" id="flowchart-C-8146" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分区数变化</p></span></div></foreignObject></g></g><g transform="translate(755.6328125, 72.5)" id="flowchart-D-8148" class="node default"><rect height="54" width="194.640625" y="-27" x="-97.3203125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-67.3203125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="134.640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Consumer心跳超时</p></span></div></foreignObject></g></g><g transform="translate(981.03125, 72.5)" id="flowchart-E-8150" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>处理时间超时</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-maunsn_120"><span class="control" id="-maunsn_140">Rebalance过程详解：</span></p><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1084.5 1068" style="max-width: 1084.5px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g><rect class="actor actor-bottom" ry="3" rx="3" name="C3" height="65" width="179" stroke="#666" fill="#eaeaea" y="982" x="805.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1014.5" x="895"><tspan dy="0" x="895">Consumer-3 (新加入)</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GC" height="65" width="163" stroke="#666" fill="#eaeaea" y="982" x="503.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1014.5" x="585"><tspan dy="0" x="585">Group Coordinator</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C2" height="65" width="150" stroke="#666" fill="#eaeaea" y="982" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1014.5" x="275"><tspan dy="0" x="275">Consumer-2</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="C1" height="65" width="150" stroke="#666" fill="#eaeaea" y="982" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="1014.5" x="75"><tspan dy="0" x="75">Consumer-1</tspan></text></g><g><line name="C3" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="982" x2="895" y1="5" x1="895" id="actor273"></line><g id="root-273"><rect class="actor actor-top" ry="3" rx="3" name="C3" height="65" width="179" stroke="#666" fill="#eaeaea" y="0" x="805.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="895"><tspan dy="0" x="895">Consumer-3 (新加入)</tspan></text></g></g><g><line name="GC" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="982" x2="585" y1="5" x1="585" id="actor272"></line><g id="root-272"><rect class="actor actor-top" ry="3" rx="3" name="GC" height="65" width="163" stroke="#666" fill="#eaeaea" y="0" x="503.5"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="585"><tspan dy="0" x="585">Group Coordinator</tspan></text></g></g><g><line name="C2" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="982" x2="275" y1="5" x1="275" id="actor271"></line><g id="root-271"><rect class="actor actor-top" ry="3" rx="3" name="C2" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="200"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="275"><tspan dy="0" x="275">Consumer-2</tspan></text></g></g><g><line name="C1" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="982" x2="75" y1="5" x1="75" id="actor270"></line><g id="root-270"><rect class="actor actor-top" ry="3" rx="3" name="C1" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor: middle; font-size: 16px; font-weight: 400;" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Consumer-1</tspan></text></g></g><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray: 0, 0;" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><g><rect class="note" height="39" width="250" stroke="#666" fill="#EDF2AE" y="75" x="50"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="175"><tspan x="175">当前分区分配: C1=[P0,P1], C2=[P2,P3]</tspan></text></g><g><rect class="note" height="39" width="364" stroke="#666" fill="#EDF2AE" y="364" x="403"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="369" x="585"><tspan x="585">4. 选举Leader Consumer (通常是第一个加入的)</tspan></text></g><g><rect class="note" height="39" width="870" stroke="#666" fill="#EDF2AE" y="923" x="50"></rect><text style="font-size: 16px; font-weight: 400;" dy="1em" class="noteText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="928" x="485"><tspan x="485">新的分区分配完成，开始消费</tspan></text></g><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="129" x="742">1. 发送JoinGroup请求</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="162" x2="589" y1="162" x1="894"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="177" x="332">2. 发送Rebalance通知</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="210" x2="79" y1="210" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="225" x="432">2. 发送Rebalance通知</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="258" x2="279" y1="258" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="273" x="329">3. 停止消费，发送JoinGroup</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="306" x2="581" y1="306" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="321" x="429">3. 停止消费，发送JoinGroup</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="354" x2="581" y1="354" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="418" x="332">5. 返回JoinGroup响应 (Leader)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="451" x2="79" y1="451" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="466" x="432">5. 返回JoinGroup响应 (Follower)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="499" x2="279" y1="499" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="514" x="739">5. 返回JoinGroup响应 (Follower)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="547" x2="891" y1="547" x1="586"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="562" x="76">6. 执行分区分配策略</text><path style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" d="M 76,595 C 136,585 136,625 76,615"></path><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="640" x="329">7. 发送SyncGroup (包含分配结果)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="673" x2="581" y1="673" x1="76"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="688" x="429">7. 发送SyncGroup (空)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="721" x2="581" y1="721" x1="276"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="736" x="742">7. 发送SyncGroup (空)</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="769" x2="589" y1="769" x1="894"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="784" x="332">8. 返回分配结果: [P0]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="817" x2="79" y1="817" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="832" x="432">8. 返回分配结果: [P1,P2]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="865" x2="279" y1="865" x1="584"></line><text style="font-size: 16px; font-weight: 400;" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="880" x="739">8. 返回分配结果: [P3]</text><line style="fill: none;" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="913" x2="891" y1="913" x1="586"></line></svg><p id="-maunsn_122"><span class="control" id="-maunsn_141">Consumer实现代码：</span></p><div class="code-block" data-lang="java">
// Consumer Group配置和实现
public class KafkaConsumerGroup {
    
    public Properties getConsumerConfig(String groupId) {
        Properties props = new Properties();
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        props.put(ConsumerConfig.GROUP_ID_CONFIG, groupId);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        
        // 消费配置
        props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, &quot;earliest&quot;);
        props.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, false); // 手动提交
        props.put(ConsumerConfig.MAX_POLL_RECORDS_CONFIG, 100);     // 每次拉取记录数
        
        // Rebalance配置
        props.put(ConsumerConfig.SESSION_TIMEOUT_MS_CONFIG, 30000);      // 会话超时
        props.put(ConsumerConfig.HEARTBEAT_INTERVAL_MS_CONFIG, 10000);   // 心跳间隔
        props.put(ConsumerConfig.MAX_POLL_INTERVAL_MS_CONFIG, 300000);   // 处理超时
        
        return props;
    }
    
    // 消费者实现
    public void startConsumer(String groupId, String topic) {
        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(getConsumerConfig(groupId));
        
        // 注册Rebalance监听器
        consumer.subscribe(Arrays.asList(topic), new ConsumerRebalanceListener() {
            @Override
            public void onPartitionsRevoked(Collection&lt;TopicPartition&gt; partitions) {
                log.info(&quot;分区被回收: {}&quot;, partitions);
                // 提交当前偏移量
                consumer.commitSync();
            }
            
            @Override
            public void onPartitionsAssigned(Collection&lt;TopicPartition&gt; partitions) {
                log.info(&quot;分区被分配: {}&quot;, partitions);
                // 可以在这里设置消费位置
                for (TopicPartition partition : partitions) {
                    long position = getStoredOffset(partition);
                    if (position &gt;= 0) {
                        consumer.seek(partition, position);
                    }
                }
            }
        });
        
        try {
            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(1000);
                
                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    try {
                        // 处理消息
                        processMessage(record);
                        
                        // 存储处理结果和偏移量
                        storeProcessResult(record);
                        
                    } catch (Exception e) {
                        log.error(&quot;消息处理失败: {}&quot;, record, e);
                        // 错误处理逻辑
                        handleProcessError(record, e);
                    }
                }
                
                // 手动提交偏移量
                consumer.commitAsync((offsets, exception) -&gt; {
                    if (exception != null) {
                        log.error(&quot;偏移量提交失败&quot;, exception);
                    } else {
                        log.debug(&quot;偏移量提交成功: {}&quot;, offsets);
                    }
                });
            }
        } catch (Exception e) {
            log.error(&quot;消费者异常&quot;, e);
        } finally {
            consumer.close();
        }
    }
    
    // 分区分配策略
    public static class CustomAssignor extends AbstractPartitionAssignor {
        @Override
        public String name() {
            return &quot;custom&quot;;
        }
        
        @Override
        public Map&lt;String, List&lt;TopicPartition&gt;&gt; assign(Map&lt;String, Integer&gt; partitionsPerTopic,
                                                        Map&lt;String, Subscription&gt; subscriptions) {
            // 自定义分区分配逻辑
            Map&lt;String, List&lt;TopicPartition&gt;&gt; assignment = new HashMap&lt;&gt;();
            
            // 获取所有消费者和分区
            List&lt;String&gt; consumers = new ArrayList&lt;&gt;(subscriptions.keySet());
            List&lt;TopicPartition&gt; allPartitions = new ArrayList&lt;&gt;();
            
            for (Map.Entry&lt;String, Integer&gt; entry : partitionsPerTopic.entrySet()) {
                String topic = entry.getKey();
                int numPartitions = entry.getValue();
                for (int i = 0; i &lt; numPartitions; i++) {
                    allPartitions.add(new TopicPartition(topic, i));
                }
            }
            
            // 平均分配分区
            int partitionsPerConsumer = allPartitions.size() / consumers.size();
            int extraPartitions = allPartitions.size() % consumers.size();
            
            for (int i = 0; i &lt; consumers.size(); i++) {
                String consumer = consumers.get(i);
                int start = i * partitionsPerConsumer + Math.min(i, extraPartitions);
                int length = partitionsPerConsumer + (i &lt; extraPartitions ? 1 : 0);
                
                assignment.put(consumer, allPartitions.subList(start, start + length));
            }
            
            return assignment;
        }
    }
}
</div></section></section><section class="chapter"><h2 id="-maunsn_7" data-toc="-maunsn_7">💡 面试技巧</h2><section class="chapter"><h3 id="-maunsn_142" data-toc="-maunsn_142">高频考点</h3><ol class="list _decimal" id="-maunsn_144" type="1"><li class="list__item" id="-maunsn_145"><p id="-maunsn_150"><span class="control" id="-maunsn_151">架构理解</span>: Kafka整体架构和各组件作用</p></li><li class="list__item" id="-maunsn_146"><p id="-maunsn_152"><span class="control" id="-maunsn_153">高吞吐量</span>: 实现高吞吐量的关键技术</p></li><li class="list__item" id="-maunsn_147"><p id="-maunsn_154"><span class="control" id="-maunsn_155">分区机制</span>: 分区的作用和副本机制</p></li><li class="list__item" id="-maunsn_148"><p id="-maunsn_156"><span class="control" id="-maunsn_157">Consumer Group</span>: Rebalance机制和分区分配</p></li><li class="list__item" id="-maunsn_149"><p id="-maunsn_158"><span class="control" id="-maunsn_159">可靠性保证</span>: 如何确保消息不丢失</p></li></ol></section><section class="chapter"><h3 id="-maunsn_143" data-toc="-maunsn_143">回答策略</h3><ol class="list _decimal" id="-maunsn_160" type="1"><li class="list__item" id="-maunsn_163"><p id="-maunsn_167"><span class="control" id="-maunsn_168">从整体到细节</span>: 先说架构，再讲具体实现</p></li><li class="list__item" id="-maunsn_164"><p id="-maunsn_169"><span class="control" id="-maunsn_170">结合实际场景</span>: 说明不同配置的适用场景</p></li><li class="list__item" id="-maunsn_165"><p id="-maunsn_171"><span class="control" id="-maunsn_172">性能权衡</span>: 解释可靠性和性能之间的平衡</p></li><li class="list__item" id="-maunsn_166"><p id="-maunsn_173"><span class="control" id="-maunsn_174">故障处理</span>: 说明各种异常情况的处理机制</p></li></ol><p id="-maunsn_162"><span class="control" id="-maunsn_175">学习建议</span>: Kafka是目前最流行的消息队列之一，重点要理解其高性能实现原理和分布式特性。建议通过搭建Kafka集群来实践各种配置和特性，加深对架构和机制的理解。</p></section></section><div class="last-modified">09 六月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="消息队列基础概念qa.html" class="navigation-links__prev">消息队列基础概念QA</a><a href="rabbitmq应用实践qa.html" class="navigation-links__next">RabbitMQ应用实践QA</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>