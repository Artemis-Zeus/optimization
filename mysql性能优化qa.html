<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-10T01:18:28.9366322"><title>MySQL性能优化QA | 技术知识库</title><script type="application/json" id="virtual-toc-data">[{"id":"-tuqa9y_4","level":0,"title":"📋 知识结构","anchor":"#-tuqa9y_4"},{"id":"-tuqa9y_5","level":0,"title":"🔍 查询优化","anchor":"#-tuqa9y_5"},{"id":"-tuqa9y_6","level":0,"title":"⚙️ 配置优化","anchor":"#-tuqa9y_6"},{"id":"-tuqa9y_7","level":0,"title":"📊 监控分析","anchor":"#-tuqa9y_7"},{"id":"-tuqa9y_8","level":0,"title":"🚀 架构优化","anchor":"#-tuqa9y_8"},{"id":"-tuqa9y_9","level":0,"title":"💡 性能调优最佳实践","anchor":"#-tuqa9y_9"},{"id":"-tuqa9y_10","level":0,"title":"💡 面试技巧","anchor":"#-tuqa9y_10"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="MySQL性能优化QA | 技术知识库"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="技术知识库 Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/mysql性能优化qa.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="MySQL性能优化QA | 技术知识库"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/mysql性能优化qa.html#webpage",
    "url": "writerside-documentation/mysql性能优化qa.html",
    "name": "MySQL性能优化QA | 技术知识库",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "技术知识库 Help"
}</script><!-- End Schema.org --></head><body data-id="MySQL性能优化QA" data-main-title="MySQL性能优化QA" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="MySQL面试大纲.md|MySQL面试大纲"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>技术知识库  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="MySQL性能优化QA" id="MySQL性能优化QA.md">MySQL性能优化QA</h1><p id="-tuqa9y_3">本文档系统总结MySQL性能优化的方法和技巧，涵盖查询优化、配置调优、监控分析等核心内容。</p><section class="chapter"><h2 id="-tuqa9y_4" data-toc="-tuqa9y_4">📋 知识结构</h2><svg aria-roledescription="mindmap" role="graphics-document document" viewBox="5 5 773.3067626953125 436.2735595703125" style="max-width: 773.3067626953125px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid"><g></g><g class="mindmap-edges"><path class="edge section-edge-0 edge-depth-1" d="M 569.2049777643412,225.39726765643013 L 633.3381447289414,230.16544066812753 L697.4713116935417,234.933613679825"></path><path class="edge section-edge-0 edge-depth-1" d="M 543.8032713233464,235.052842349022 L 518.9947070921676,260.632847462036 L494.18614286098875,286.2128525750501"></path><path class="edge section-edge-0 edge-depth-1" d="M 564.9302077594682,234.81380854672727 L 593.9173746154379,263.3797518356772 L622.9045414714076,291.9456951246272"></path><path class="edge section-edge-0 edge-depth-1" d="M 567.049046929305,216.46918812560324 L 608.8232967073166,190.9665635145287 L650.5975464853282,165.46393890345416"></path><path class="edge section-edge-0 edge-depth-0" d="M 392.2943573639229,217.48114156163248 L 465.77692075278526,220.5683146381979 L539.2594841416476,223.65548771476332"></path><path class="edge section-edge-1 edge-depth-1" d="M 439.33085805774493,119.42522380421643 L 494.0323945965696,108.61902030907234 L548.7339311353943,97.81281681392825"></path><path class="edge section-edge-1 edge-depth-1" d="M 409.67543975464235,120.98986950655897 L 359.8202789036327,116.51019135595132 L309.96511805262304,112.03051320534367"></path><path class="edge section-edge-1 edge-depth-1" d="M 432.2419123205652,109.41584392105571 L 450.72320853875215,78.11613453851062 L469.2045047569391,46.81642515596555"></path><path class="edge section-edge-1 edge-depth-1" d="M 414.9604999125803,110.8524703297679 L 389.9519280043843,81.11650235580603 L364.94335609618827,51.38053438184417"></path><path class="edge section-edge-1 edge-depth-0" d="M 384.0212364328921,203.43783311030978 L 400.9614143707431,169.59189061522008 L417.9015923085941,135.74594812013038"></path><path class="edge section-edge-2 edge-depth-1" d="M 324.7949117283059,319.299913804816 L 263.619133376411,324.8872296087135 L202.44335502451608,330.47454541261095"></path><path class="edge section-edge-2 edge-depth-1" d="M 343.3544466385912,332.4918192274904 L 351.48122019161565,365.15459036462755 L359.6079937446401,397.8173615017647"></path><path class="edge section-edge-2 edge-depth-1" d="M 353.439001239675,324.0297354786195 L 409.43701585519557,348.92776551688144 L465.43503047071613,373.8257955551434"></path><path class="edge section-edge-2 edge-depth-1" d="M 328.1890178433097,327.513840825099 L 293.92712816424955,355.9421350653528 L259.6652384851894,384.37042930560654"></path><path class="edge section-edge-2 edge-depth-0" d="M 372.08119645140073,230.91155979847616 L 358.52015816584344,267.39356099858196 L344.95911988028615,303.8755621986878"></path><path class="edge section-edge-3 edge-depth-1" d="M 187.19548913491988,175.7985411346624 L 131.08838515973804,197.59698614498984 L74.9812811845562,219.39543115531723"></path><path class="edge section-edge-3 edge-depth-1" d="M 186.58235190023177,166.9041994184789 L 129.6066621120953,153.3885398870743 L72.63097232395884,139.8728803556697"></path><path class="edge section-edge-3 edge-depth-1" d="M 196.4573128927373,156.12836023675283 L 186.01095712137266,124.61667733095615 L175.56460135000802,93.10499442515946"></path><path class="edge section-edge-3 edge-depth-1" d="M 197.79673032248732,184.98047823212391 L 191.3407172369873,212.88939872870196 L184.88470415148728,240.79831922527995"></path><path class="edge section-edge-3 edge-depth-0" d="M 362.80420036247847,213.02371280514595 L 289.2424512777941,193.60895098656087 L215.68070219310968,174.1941891679758"></path></g><g class="mindmap-nodes"><g transform="translate(311.28579570810655, 197.9515121534189)" class="mindmap-node section--1 section-root"><g transform="translate(66.02178192138672, 18.9)"><circle r="66.02178192138672" class="node-bkg node-circle" id="node-0"></circle></g><g transform="translate(66.02178192138672, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">MySQL性能优化</tspan></tspan></text></g></g></g><g transform="translate(511.21026457798155, 205.3851171229769)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-1"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">查询优化</tspan></tspan></text></g></g></g><g transform="translate(382.07925181389726, 103.43226907702126)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-6"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">配置优化</tspan></tspan></text></g></g></g><g transform="translate(297.1967394040979, 299.0356098437451)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-11"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">监控分析</tspan></tspan></text></g></g></g><g transform="translate(158.1413256279992, 151.46638981970284)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-16"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">架构优化</tspan></tspan></text></g></g></g><g transform="translate(656.5533356709169, 217.1457642132782)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h101.75337982177734 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-2"></path><line y2="37.8" x2="111.75337982177734" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(55.87668991088867, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">SQL语句优化</tspan></tspan></text></g></g></g><g transform="translate(440.7071510101622, 278.08057780109516)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-3"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">索引优化</tspan></tspan></text></g></g></g><g transform="translate(574.5284839815075, 283.57438654837756)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h108.12000274658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-4"></path><line y2="37.8" x2="118.12000274658203" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(59.060001373291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">执行计划分析</tspan></tspan></text></g></g></g><g transform="translate(622.0825156652649, 138.74800990608048)" class="mindmap-node section-0"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h72.63562774658203 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-5"></path><line y2="37.8" x2="82.63562774658203" y1="37.8" x1="0" class="node-line-0"></line></g><g transform="translate(41.317813873291016, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">Join优化</tspan></tspan></text></g></g></g><g transform="translate(520.9135387830505, 76.00577154112341)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-7"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">内存参数</tspan></tspan></text></g></g></g><g transform="translate(256.6648063595791, 91.78811363488137)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h66.72100067138672 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-8"></path><line y2="37.8" x2="76.72100067138672" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(38.36050033569336, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">I/O参数</tspan></tspan></text></g></g></g><g transform="translate(433.79516666741563, 15)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-9"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">连接参数</tspan></tspan></text></g></g></g><g transform="translate(312.7526055986799, 21.000735634590797)" class="mindmap-node section-1"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-10"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-1"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">缓存配置</tspan></tspan></text></g></g></g><g transform="translate(136.45752771493505, 312.93884937368193)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h92.09600067138672 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-12"></path><line y2="37.8" x2="102.09600067138672" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(51.04800033569336, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">慢查询日志</tspan></tspan></text></g></g></g><g transform="translate(320.193702382942, 393.47357088551007)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-13"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">性能指标</tspan></tspan></text></g></g></g><g transform="translate(437.0866055081975, 361.01992119001784)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h74.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-14"></path><line y2="37.8" x2="84.109375" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(42.0546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">工具使用</tspan></tspan></text></g></g></g><g transform="translate(205.0855183282098, 375.0486602869605)" class="mindmap-node section-2"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-15"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-2"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">瓶颈定位</tspan></tspan></text></g></g></g><g transform="translate(18.444757893381166, 205.92758247027677)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.109375 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-17"></path><line y2="37.8" x2="85.109375" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(42.5546875, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">读写分离</tspan></tspan></text></g></g></g><g transform="translate(15, 117.51068995444575)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h76.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-18"></path><line y2="37.8" x2="86.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(43.0359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">分库分表</tspan></tspan></text></g></g></g><g transform="translate(128.3085900185547, 59.96696484220946)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h75.0719985961914 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-19"></path><line y2="37.8" x2="85.0719985961914" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(42.5359992980957, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">缓存策略</tspan></tspan></text></g></g></g><g transform="translate(146.480109380033, 236.51240763770102)" class="mindmap-node section-3"><g><path d="M0 32.8 v-27.799999999999997 q0,-5 5,-5 h60.04800033569336 q5,0 5,5 v32.8 H0 Z" class="node-bkg node-no-border" id="node-20"></path><line y2="37.8" x2="70.04800033569336" y1="37.8" x1="0" class="node-line-3"></line></g><g transform="translate(35.02400016784668, 5)" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" dy="1em"><g><rect style="stroke: none" class="background"></rect><text style="" y="-10.1"><tspan dy="1.1em" y="-0.1em" x="0" class="text-outer-tspan"><tspan font-weight="normal" class="text-inner-tspan" font-style="normal">连接池</tspan></tspan></text></g></g></g></g></svg></section><section class="chapter"><h2 id="-tuqa9y_5" data-toc="-tuqa9y_5">🔍 查询优化</h2><section class="chapter"><h3 id="q1" data-toc="q1">Q1: 如何分析和优化慢查询？</h3><p id="-tuqa9y_15"><span class="control" id="-tuqa9y_20">答案：</span></p><p id="-tuqa9y_16"><span class="control" id="-tuqa9y_21">慢查询分析流程：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 785.234375 886.109375" height="886.109375" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="785.234375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M403.289,62L403.289,66.167C403.289,70.333,403.289,78.667,403.289,84.917C403.289,91.167,403.289,95.333,403.289,98.833C403.289,102.333,403.289,105.167,403.289,106.583L403.289,108"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M403.289,166L403.289,170.167C403.289,174.333,403.289,182.667,403.289,188.917C403.289,195.167,403.289,199.333,403.289,202.833C403.289,206.333,403.289,209.167,403.289,210.583L403.289,212"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_2" d="M403.289,270L403.289,274.167C403.289,278.333,403.289,286.667,403.289,292.917C403.289,299.167,403.289,303.333,403.289,306.833C403.289,310.333,403.289,313.167,403.289,314.583L403.289,316"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_3" d="M403.289,374L403.289,378.167C403.289,382.333,403.289,390.667,403.289,396.917C403.289,403.167,403.289,407.333,403.289,410.833C403.289,414.333,403.289,417.167,403.289,418.583L403.289,420"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_4" d="M403.289,478L403.289,482.167C403.289,486.333,403.289,494.667,403.331,500.958C403.372,507.25,403.456,511.5,403.526,515.083C403.596,518.667,403.653,521.584,403.682,523.042L403.711,524.501"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_5" d="M358.732,601.552L314.624,615.145C270.516,628.738,182.301,655.924,138.194,672.6C94.086,689.276,94.086,695.443,94.086,700.943C94.086,706.443,94.086,711.276,94.086,713.693L94.086,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_H_6" d="M374.007,616.827L362.6,627.874C351.192,638.921,328.377,661.015,316.97,675.146C305.563,689.276,305.563,695.443,305.563,700.943C305.563,706.443,305.563,711.276,305.563,713.693L305.563,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_I_7" d="M433.571,616.827L444.812,627.874C456.053,638.921,478.534,661.015,489.775,675.146C501.016,689.276,501.016,695.443,501.016,700.943C501.016,706.443,501.016,711.276,501.016,713.693L501.016,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_J_8" d="M448.37,602.028L490.168,615.542C531.966,629.055,615.561,656.082,657.359,672.679C699.156,689.276,699.156,695.443,699.156,700.943C699.156,706.443,699.156,711.276,699.156,713.693L699.156,716.109"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_K_9" d="M94.086,774.109L94.086,778.276C94.086,782.443,94.086,790.776,113.346,798.182C132.607,805.588,171.128,812.066,208.991,818.433C246.854,824.801,284.06,831.058,302.663,834.187L321.266,837.315"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_K_10" d="M305.563,774.109L305.563,778.276C305.563,782.443,305.563,790.776,309.478,797.026C313.393,803.276,321.224,807.443,328.466,811.296C335.708,815.15,342.362,818.69,345.688,820.46L349.015,822.23"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_K_11" d="M501.016,774.109L501.016,778.276C501.016,782.443,501.016,790.776,497.1,797.026C493.185,803.276,485.354,807.443,478.112,811.296C470.87,815.15,464.217,818.69,460.89,820.46L457.563,822.23"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_K_12" d="M699.156,774.109L699.156,778.276C699.156,782.443,699.156,790.776,681.007,798.132C662.858,805.489,626.56,811.869,590.918,818.133C555.277,824.397,520.292,830.546,502.799,833.62L485.307,836.694"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(94.0859375, 683.109375)" class="edgeLabel"><g transform="translate(-32.0546875, -12)" class="label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>索引问题</p></span></div></foreignObject></g></g><g transform="translate(305.5625, 683.109375)" class="edgeLabel"><g transform="translate(-45.390625, -12)" class="label"><foreignObject height="24" width="90.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>SQL写法问题</p></span></div></foreignObject></g></g><g transform="translate(501.015625, 683.109375)" class="edgeLabel"><g transform="translate(-40.0625, -12)" class="label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>数据量问题</p></span></div></foreignObject></g></g><g transform="translate(699.15625, 683.109375)" class="edgeLabel"><g transform="translate(-32.609375, -12)" class="label"><foreignObject height="24" width="65.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>JOIN问题</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(403.2890625, 35)" id="flowchart-A-11739" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>发现慢查询</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 139)" id="flowchart-B-11740" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>开启慢查询日志</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 243)" id="flowchart-C-11742" class="node default"><rect height="54" width="150.78125" y="-27" x="-75.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分析SQL语句</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 347)" id="flowchart-D-11744" class="node default"><rect height="54" width="246.96875" y="-27" x="-123.484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-93.484375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="186.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>使用EXPLAIN分析执行计划</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 451)" id="flowchart-E-11746" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>识别性能瓶颈</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 587.0546875)" id="flowchart-F-11748" class="node default"><polygon transform="translate(-59.0546875,59.0546875)" class="label-container" points="59.0546875,0 118.109375,-59.0546875 59.0546875,-118.109375 0,-59.0546875"></polygon><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>瓶颈类型</p></span></div></foreignObject></g></g><g transform="translate(94.0859375, 747.109375)" id="flowchart-G-11750" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>创建或优化索引</p></span></div></foreignObject></g></g><g transform="translate(305.5625, 747.109375)" id="flowchart-H-11752" class="node default"><rect height="54" width="150.78125" y="-27" x="-75.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>重写SQL语句</p></span></div></foreignObject></g></g><g transform="translate(501.015625, 747.109375)" id="flowchart-I-11754" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分页或分区</p></span></div></foreignObject></g></g><g transform="translate(699.15625, 747.109375)" id="flowchart-J-11756" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>优化关联查询</p></span></div></foreignObject></g></g><g transform="translate(403.2890625, 851.109375)" id="flowchart-K-11758" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>验证优化效果</p></span></div></foreignObject></g></g></g></g></g></svg><p id="-tuqa9y_18"><span class="control" id="-tuqa9y_22">慢查询日志配置：</span></p><div class="code-block" data-lang="sql">
-- 开启慢查询日志
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL slow_query_log_file = '/var/log/mysql/slow.log';
SET GLOBAL long_query_time = 2;  -- 超过2秒的查询记录

-- 查看慢查询统计
SHOW GLOBAL STATUS LIKE 'Slow_queries';

-- 分析慢查询日志工具
mysqldumpslow -s c -t 10 /var/log/mysql/slow.log
</div></section><section class="chapter"><h3 id="q2-explain" data-toc="q2-explain">Q2: EXPLAIN执行计划如何分析？重点关注哪些指标？</h3><p id="-tuqa9y_23"><span class="control" id="-tuqa9y_30">答案：</span></p><p id="-tuqa9y_24"><span class="control" id="-tuqa9y_31">EXPLAIN关键字段分析：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 911.375 572"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="911.375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 60)" class="root"><g class="clusters"><g data-look="classic" id="优化目标" class="cluster"><rect height="436" width="295.25" y="8" x="8" style=""></rect><g transform="translate(123.5703125, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>优化目标</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(155.625, 70)" id="flowchart-I-11799" class="node default"><rect height="54" width="181.859375" y="-27" x="-90.9296875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-60.9296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="121.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>避免ALL全表扫描</p></span></div></foreignObject></g></g><g transform="translate(155.625, 174)" id="flowchart-J-11800" class="node default"><rect height="54" width="204.21875" y="-27" x="-102.109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.109375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="144.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>确保使用了合适索引</p></span></div></foreignObject></g></g><g transform="translate(155.625, 278)" id="flowchart-K-11801" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>减少扫描行数</p></span></div></foreignObject></g></g><g transform="translate(155.625, 382)" id="flowchart-L-11802" class="node default"><rect height="54" width="220.25" y="-27" x="-110.125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-80.125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="160.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>避免文件排序和临时表</p></span></div></foreignObject></g></g></g></g><g transform="translate(345.25, 0)" class="root"><g class="clusters"><g data-look="classic" id="EXPLAIN重点字段" class="cluster"><rect height="556" width="550.125" y="8" x="8" style=""></rect><g transform="translate(221.625, 8)" class="cluster-label"><foreignObject height="24" width="122.875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>EXPLAIN重点字段</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M177.617,94L185.202,94C192.786,94,207.956,94,218.665,94C229.375,94,235.625,94,241.208,94C246.792,94,251.708,94,254.167,94L256.625,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M185.625,234L191.875,234C198.125,234,210.625,234,222.122,234C233.62,234,244.115,234,253.943,234C263.771,234,272.932,234,277.513,234L282.094,234"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M177.617,362L185.202,362C192.786,362,207.956,362,222.325,362C236.694,362,250.263,362,263.165,362C276.068,362,288.303,362,294.421,362L300.539,362"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M177.617,490L185.202,490C192.786,490,207.956,490,221.416,490C234.876,490,246.628,490,257.712,490C268.797,490,279.215,490,284.424,490L289.633,490"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 94)" id="flowchart-A-11791" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>type<br>访问类型</p></span></div></foreignObject></g></g><g transform="translate(390.625, 94)" id="flowchart-B-11792" class="node default"><rect height="102" width="260" y="-51" x="-130" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-100, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能排序<br>system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 234)" id="flowchart-C-11793" class="node default"><rect height="78" width="140.125" y="-39" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>key<br>使用的索引</p></span></div></foreignObject></g></g><g transform="translate(390.625, 234)" id="flowchart-D-11794" class="node default"><rect height="78" width="209.0625" y="-39" x="-104.53125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-74.53125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="149.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>NULL表示未使用索引<br>需要优化</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 362)" id="flowchart-E-11795" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>rows<br>扫描行数</p></span></div></foreignObject></g></g><g transform="translate(390.625, 362)" id="flowchart-F-11796" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>估算的检查行数<br>越少越好</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 490)" id="flowchart-G-11797" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Extra<br>额外信息</p></span></div></foreignObject></g></g><g transform="translate(390.625, 490)" id="flowchart-H-11798" class="node default"><rect height="78" width="193.984375" y="-39" x="-96.9921875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.9921875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="133.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>关注Using filesort<br>Using temporary等</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_26"><span class="control" id="-tuqa9y_32">重点关注的Extra信息：</span></p><div class="table-wrapper"><table class="wide" id="-tuqa9y_27"><thead><tr class="ijRowHead" id="-tuqa9y_33"><th id="-tuqa9y_39"><p>Extra信息</p></th><th id="-tuqa9y_40"><p>含义</p></th><th id="-tuqa9y_41"><p>优化建议</p></th></tr></thead><tbody><tr id="-tuqa9y_34"><td id="-tuqa9y_42"><p><span class="control" id="-tuqa9y_45">Using filesort</span></p></td><td id="-tuqa9y_43"><p>使用外部排序</p></td><td id="-tuqa9y_44"><p>创建ORDER BY相关索引</p></td></tr><tr id="-tuqa9y_35"><td id="-tuqa9y_46"><p><span class="control" id="-tuqa9y_49">Using temporary</span></p></td><td id="-tuqa9y_47"><p>使用临时表</p></td><td id="-tuqa9y_48"><p>优化GROUP BY或DISTINCT</p></td></tr><tr id="-tuqa9y_36"><td id="-tuqa9y_50"><p><span class="control" id="-tuqa9y_53">Using where</span></p></td><td id="-tuqa9y_51"><p>使用WHERE过滤</p></td><td id="-tuqa9y_52"><p>确保WHERE条件有索引</p></td></tr><tr id="-tuqa9y_37"><td id="-tuqa9y_54"><p><span class="control" id="-tuqa9y_57">Using index</span></p></td><td id="-tuqa9y_55"><p>覆盖索引</p></td><td id="-tuqa9y_56"><p>✅ 性能很好</p></td></tr><tr id="-tuqa9y_38"><td id="-tuqa9y_58"><p><span class="control" id="-tuqa9y_61">Using index condition</span></p></td><td id="-tuqa9y_59"><p>索引条件下推</p></td><td id="-tuqa9y_60"><p>✅ 较好的优化</p></td></tr></tbody></table></div><p id="-tuqa9y_28"><span class="control" id="-tuqa9y_62">实际分析示例：</span></p><div class="code-block" data-lang="sql">
-- 问题查询
EXPLAIN SELECT * FROM orders o 
JOIN users u ON o.user_id = u.id 
WHERE o.status = 1 AND o.create_time &gt; '2023-01-01'
ORDER BY o.create_time DESC 
LIMIT 10;

-- 分析结果优化
-- 1. 创建复合索引
CREATE INDEX idx_status_time ON orders(status, create_time);
-- 2. 确保JOIN字段有索引
CREATE INDEX idx_user_id ON orders(user_id);
-- 3. 只查询需要的字段，避免SELECT *
</div></section><section class="chapter"><h3 id="q3-join-join" data-toc="q3-join-join">Q3: JOIN查询如何优化？不同JOIN类型的性能差异？</h3><p id="-tuqa9y_63"><span class="control" id="-tuqa9y_70">答案：</span></p><p id="-tuqa9y_64"><span class="control" id="-tuqa9y_71">JOIN类型性能对比：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 540 676"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="540" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="JOIN类型性能排序" class="cluster"><rect height="660" width="524" y="8" x="8" style=""></rect><g transform="translate(205.34375, 8)" class="cluster-label"><foreignObject height="24" width="129.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>JOIN类型性能排序</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M208.844,82L218.836,82C228.828,82,248.813,82,261.93,82C275.047,82,281.297,82,286.88,82C292.464,82,297.38,82,299.839,82L302.297,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M204.492,210L215.21,210C225.927,210,247.362,210,261.204,210C275.047,210,281.297,210,286.88,210C292.464,210,297.38,210,299.839,210L302.297,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M209.492,338L219.376,338C229.26,338,249.029,338,262.038,338C275.047,338,281.297,338,286.88,338C292.464,338,297.38,338,299.839,338L302.297,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M231.297,466L237.547,466C243.797,466,256.297,466,265.76,466C275.223,466,281.648,466,287.408,466C293.167,466,298.259,466,300.805,466L303.352,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_4" d="M209.992,594L219.793,594C229.594,594,249.195,594,264.792,594C280.388,594,291.979,594,302.904,594C313.828,594,324.086,594,329.215,594L334.344,594"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(138.3984375, 82)" id="flowchart-A-11829" class="node default"><rect height="78" width="140.890625" y="-39" x="-70.4453125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.4453125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80.890625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>INNER JOIN<br>内连接</p></span></div></foreignObject></g></g><g transform="translate(400.3984375, 82)" id="flowchart-B-11830" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能最好<br>只返回匹配的记录</p></span></div></foreignObject></g></g><g transform="translate(138.3984375, 210)" id="flowchart-C-11831" class="node default"><rect height="78" width="132.1875" y="-39" x="-66.09375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-36.09375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="72.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LEFT JOIN<br>左连接</p></span></div></foreignObject></g></g><g transform="translate(400.3984375, 210)" id="flowchart-D-11832" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能较好<br>包含左表所有记录</p></span></div></foreignObject></g></g><g transform="translate(138.3984375, 338)" id="flowchart-E-11833" class="node default"><rect height="78" width="142.1875" y="-39" x="-71.09375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.09375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="82.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>RIGHT JOIN<br>右连接</p></span></div></foreignObject></g></g><g transform="translate(400.3984375, 338)" id="flowchart-F-11834" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能一般<br>包含右表所有记录</p></span></div></foreignObject></g></g><g transform="translate(138.3984375, 466)" id="flowchart-G-11835" class="node default"><rect height="78" width="185.796875" y="-39" x="-92.8984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-62.8984375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="125.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>FULL OUTER JOIN<br>全外连接</p></span></div></foreignObject></g></g><g transform="translate(400.3984375, 466)" id="flowchart-H-11836" class="node default"><rect height="78" width="186.09375" y="-39" x="-93.046875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.046875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="126.09375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能较差<br>MySQL不直接支持</p></span></div></foreignObject></g></g><g transform="translate(138.3984375, 594)" id="flowchart-I-11837" class="node default"><rect height="78" width="143.1875" y="-39" x="-71.59375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.59375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="83.1875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CROSS JOIN<br>交叉连接</p></span></div></foreignObject></g></g><g transform="translate(400.3984375, 594)" id="flowchart-J-11838" class="node default"><rect height="78" width="124.109375" y="-39" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能最差<br>笛卡尔积</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_66"><span class="control" id="-tuqa9y_72">JOIN优化策略：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 778.53125 548"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="778.53125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="JOIN优化技巧" class="cluster"><rect height="532" width="762.53125" y="8" x="8" style=""></rect><g transform="translate(340.6328125, 8)" class="cluster-label"><foreignObject height="24" width="97.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>JOIN优化技巧</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M122.187,247L136.526,219.5C150.864,192,179.542,137,197.834,109.5C216.126,82,224.034,82,231.275,82C238.516,82,245.09,82,248.377,82L251.664,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M150.343,247L159.989,240.833C169.635,234.667,188.927,222.333,201.812,216.167C214.698,210,221.177,210,226.99,210C232.802,210,237.948,210,240.521,210L243.094,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M150.343,301L159.989,307.167C169.635,313.333,188.927,325.667,203.086,331.833C217.245,338,226.271,338,234.63,338C242.99,338,250.682,338,254.529,338L258.375,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M122.187,301L136.526,328.5C150.864,356,179.542,411,197.005,438.5C214.469,466,220.719,466,226.302,466C231.885,466,236.802,466,239.26,466L241.719,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_F_4" d="M443.867,82L451.775,82C459.682,82,475.497,82,487.865,82C500.233,82,509.154,82,517.408,82C525.661,82,533.249,82,537.042,82L540.836,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_G_5" d="M452.438,210L458.917,210C465.396,210,478.354,210,488.626,210C498.897,210,506.482,210,513.4,210C520.318,210,526.569,210,529.695,210L532.82,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_H_6" d="M437.156,338L446.182,338C455.208,338,473.26,338,485.411,338C497.563,338,503.813,338,509.396,338C514.979,338,519.896,338,522.354,338L524.813,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_I_7" d="M453.813,466L460.063,466C466.313,466,478.813,466,490.19,466C501.568,466,511.823,466,521.411,466C531,466,539.922,466,544.383,466L548.844,466"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(108.109375, 274)" id="flowchart-A-11871" class="node default"><rect height="54" width="125.21875" y="-27" x="-62.609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.609375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="65.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>JOIN优化</p></span></div></foreignObject></g></g><g transform="translate(349.765625, 82)" id="flowchart-B-11872" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>小表驱动大表<br>选择合适的驱动表</p></span></div></foreignObject></g></g><g transform="translate(349.765625, 210)" id="flowchart-C-11874" class="node default"><rect height="78" width="205.34375" y="-39" x="-102.671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="145.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>索引优化<br>确保JOIN字段有索引</p></span></div></foreignObject></g></g><g transform="translate(349.765625, 338)" id="flowchart-D-11876" class="node default"><rect height="78" width="174.78125" y="-39" x="-87.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-57.390625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="114.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>WHERE条件优化<br>先过滤再JOIN</p></span></div></foreignObject></g></g><g transform="translate(349.765625, 466)" id="flowchart-E-11878" class="node default"><rect height="78" width="208.09375" y="-39" x="-104.046875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-74.046875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="148.09375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>字段选择<br>只SELECT需要的字段</p></span></div></foreignObject></g></g><g transform="translate(630.921875, 82)" id="flowchart-F-11880" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>LEFT JOIN时<br>左表应该是小表</p></span></div></foreignObject></g></g><g transform="translate(630.921875, 210)" id="flowchart-G-11882" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>两个表的关联字段<br>都要建立索引</p></span></div></foreignObject></g></g><g transform="translate(630.921875, 338)" id="flowchart-H-11884" class="node default"><rect height="78" width="204.21875" y="-39" x="-102.109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.109375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="144.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>能在子查询中过滤的<br>不要在主查询中过滤</p></span></div></foreignObject></g></g><g transform="translate(630.921875, 466)" id="flowchart-I-11886" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>避免SELECT *<br>减少数据传输</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_68"><span class="control" id="-tuqa9y_73">具体优化案例：</span></p><div class="code-block" data-lang="sql">
-- ❌ 未优化的查询
SELECT * FROM orders o
LEFT JOIN users u ON o.user_id = u.id
LEFT JOIN products p ON o.product_id = p.id
WHERE o.status = 1 AND u.city = '北京'
ORDER BY o.create_time DESC;

-- ✅ 优化后的查询
SELECT o.id, o.amount, u.name, p.title
FROM (
    SELECT id, user_id, product_id, amount, create_time
    FROM orders 
    WHERE status = 1 
    ORDER BY create_time DESC 
    LIMIT 1000
) o
INNER JOIN users u ON o.user_id = u.id AND u.city = '北京'
INNER JOIN products p ON o.product_id = p.id
ORDER BY o.create_time DESC
LIMIT 10;

-- 对应索引设计
CREATE INDEX idx_orders_status_time ON orders(status, create_time);
CREATE INDEX idx_users_city ON users(city);
CREATE INDEX idx_orders_user_id ON orders(user_id);
CREATE INDEX idx_orders_product_id ON orders(product_id);
</div></section></section><section class="chapter"><h2 id="-tuqa9y_6" data-toc="-tuqa9y_6">⚙️ 配置优化</h2><section class="chapter"><h3 id="q4-mysql" data-toc="q4-mysql">Q4: MySQL有哪些重要的性能参数？如何调优？</h3><p id="-tuqa9y_76"><span class="control" id="-tuqa9y_83">答案：</span></p><p id="-tuqa9y_77"><span class="control" id="-tuqa9y_84">核心配置参数分类：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 618.53125 1188"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="618.53125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="MySQL性能参数" class="cluster"><rect height="1172" width="602.53125" y="8" x="8" style=""></rect><g transform="translate(254.2265625, 8)" class="cluster-label"><foreignObject height="24" width="110.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MySQL性能参数</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M147.958,183L163.158,166.167C178.357,149.333,208.757,115.667,229.565,98.833C250.372,82,261.589,82,272.138,82C282.688,82,292.57,82,297.512,82L302.453,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M201.656,210L207.906,210C214.156,210,226.656,210,240.361,210C254.066,210,268.977,210,283.22,210C297.464,210,311.04,210,317.829,210L324.617,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M147.958,237L163.158,253.833C178.357,270.667,208.757,304.333,231.649,321.167C254.542,338,269.927,338,284.646,338C299.365,338,313.417,338,320.443,338L327.469,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_3" d="M147.958,567L163.158,550.167C178.357,533.333,208.757,499.667,231.772,482.833C254.786,466,270.417,466,285.38,466C300.344,466,314.641,466,321.789,466L328.938,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_G_4" d="M201.656,594L207.906,594C214.156,594,226.656,594,239.782,594C252.908,594,266.659,594,279.743,594C292.828,594,305.246,594,311.455,594L317.664,594"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_H_5" d="M147.958,621L163.158,637.833C178.357,654.667,208.757,688.333,231.833,705.167C254.91,722,270.664,722,285.751,722C300.839,722,315.259,722,322.469,722L329.68,722"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_6" d="M147.958,951L163.158,934.167C178.357,917.333,208.757,883.667,230.817,866.833C252.876,850,266.596,850,279.65,850C292.703,850,305.09,850,311.283,850L317.477,850"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_K_7" d="M197.477,978L204.423,978C211.37,978,225.263,978,235.335,978C245.406,978,251.656,978,257.24,978C262.823,978,267.74,978,270.198,978L272.656,978"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_L_8" d="M147.958,1005L163.158,1021.833C178.357,1038.667,208.757,1072.333,232.257,1089.167C255.757,1106,272.357,1106,288.29,1106C304.224,1106,319.491,1106,327.124,1106L334.758,1106"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(123.578125, 210)" id="flowchart-A-11907" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>内存相关参数</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 82)" id="flowchart-B-11908" class="node default"><rect height="78" width="236.78125" y="-39" x="-118.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-88.390625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="176.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_buffer_pool_size<br>InnoDB缓冲池大小</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 210)" id="flowchart-C-11910" class="node default"><rect height="78" width="192.453125" y="-39" x="-96.2265625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.2265625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="132.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>key_buffer_size<br>MyISAM索引缓冲区</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 338)" id="flowchart-D-11912" class="node default"><rect height="78" width="186.75" y="-39" x="-93.375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="126.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>query_cache_size<br>查询缓存大小</p></span></div></foreignObject></g></g><g transform="translate(123.578125, 594)" id="flowchart-E-11913" class="node default"><rect height="54" width="156.15625" y="-27" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>连接相关参数</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 466)" id="flowchart-F-11914" class="node default"><rect height="78" width="183.8125" y="-39" x="-91.90625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-61.90625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="123.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>max_connections<br>最大连接数</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 594)" id="flowchart-G-11916" class="node default"><rect height="78" width="206.359375" y="-39" x="-103.1796875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-73.1796875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="146.359375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>max_connect_errors<br>最大连接错误数</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 722)" id="flowchart-H-11918" class="node default"><rect height="78" width="182.328125" y="-39" x="-91.1640625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-61.1640625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="122.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>connect_timeout<br>连接超时时间</p></span></div></foreignObject></g></g><g transform="translate(123.578125, 978)" id="flowchart-I-11919" class="node default"><rect height="54" width="147.796875" y="-27" x="-73.8984375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-43.8984375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="87.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>I/O相关参数</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 850)" id="flowchart-J-11920" class="node default"><rect height="78" width="206.734375" y="-39" x="-103.3671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-73.3671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="146.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_log_file_size<br>日志文件大小</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 978)" id="flowchart-K-11922" class="node default"><rect height="78" width="296.375" y="-39" x="-148.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-118.1875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="236.375"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_flush_log_at_trx_commit<br>日志刷新策略</p></span></div></foreignObject></g></g><g transform="translate(424.84375, 1106)" id="flowchart-L-11924" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sync_binlog<br>二进制日志同步</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_79"><span class="control" id="-tuqa9y_85">重要参数调优建议：</span></p><div class="table-wrapper"><table class="wide" id="-tuqa9y_80"><thead><tr class="ijRowHead" id="-tuqa9y_86"><th id="-tuqa9y_91"><p>参数名</p></th><th id="-tuqa9y_92"><p>作用</p></th><th id="-tuqa9y_93"><p>推荐值</p></th><th id="-tuqa9y_94"><p>调优原则</p></th></tr></thead><tbody><tr id="-tuqa9y_87"><td id="-tuqa9y_95"><p><span class="control" id="-tuqa9y_99">innodb_buffer_pool_size</span></p></td><td id="-tuqa9y_96"><p>InnoDB缓冲池</p></td><td id="-tuqa9y_97"><p>物理内存的70-80%</p></td><td id="-tuqa9y_98"><p>越大越好，但要预留系统内存</p></td></tr><tr id="-tuqa9y_88"><td id="-tuqa9y_100"><p><span class="control" id="-tuqa9y_104">max_connections</span></p></td><td id="-tuqa9y_101"><p>最大连接数</p></td><td id="-tuqa9y_102"><p>根据业务需求</p></td><td id="-tuqa9y_103"><p>过大会消耗过多内存</p></td></tr><tr id="-tuqa9y_89"><td id="-tuqa9y_105"><p><span class="control" id="-tuqa9y_109">innodb_log_file_size</span></p></td><td id="-tuqa9y_106"><p>日志文件大小</p></td><td id="-tuqa9y_107"><p>128M-2G</p></td><td id="-tuqa9y_108"><p>影响崩溃恢复时间</p></td></tr><tr id="-tuqa9y_90"><td id="-tuqa9y_110"><p><span class="control" id="-tuqa9y_114">query_cache_size</span></p></td><td id="-tuqa9y_111"><p>查询缓存</p></td><td id="-tuqa9y_112"><p>0（建议关闭）</p></td><td id="-tuqa9y_113"><p>高并发下反而影响性能</p></td></tr></tbody></table></div><p id="-tuqa9y_81"><span class="control" id="-tuqa9y_115">配置文件示例（my.cnf）：</span></p><div class="code-block" data-lang="ini">
[mysqld]
# 内存配置
innodb_buffer_pool_size = 8G          # 根据物理内存调整
innodb_buffer_pool_instances = 8      # 缓冲池实例数
key_buffer_size = 256M                 # MyISAM索引缓冲

# 连接配置
max_connections = 1000
max_connect_errors = 10000
connect_timeout = 60
interactive_timeout = 3600
wait_timeout = 3600

# I/O配置
innodb_log_file_size = 512M
innodb_log_buffer_size = 64M
innodb_flush_log_at_trx_commit = 1
sync_binlog = 1

# 查询优化
query_cache_type = 0                   # 关闭查询缓存
query_cache_size = 0
tmp_table_size = 256M
max_heap_table_size = 256M
</div></section><section class="chapter"><h3 id="q5-innodb" data-toc="q5-innodb">Q5: 如何调优InnoDB存储引擎？有哪些关键参数？</h3><p id="-tuqa9y_116"><span class="control" id="-tuqa9y_121">答案：</span></p><p id="-tuqa9y_117"><span class="control" id="-tuqa9y_122">InnoDB核心参数优化：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 602.5 1316"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="602.5" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="InnoDB调优参数" class="cluster"><rect height="1300" width="586.5" y="8" x="8" style=""></rect><g transform="translate(244.4296875, 8)" class="cluster-label"><foreignObject height="24" width="113.640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>InnoDB调优参数</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M160.94,119L171.305,112.833C181.669,106.667,202.397,94.333,218.369,88.167C234.341,82,245.557,82,256.107,82C266.656,82,276.539,82,281.48,82L286.422,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M160.94,173L171.305,179.167C181.669,185.333,202.397,197.667,216.737,203.833C231.077,210,239.029,210,246.314,210C253.599,210,260.217,210,263.527,210L266.836,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_2" d="M138.251,439L152.397,422.167C166.543,405.333,194.834,371.667,215.839,354.833C236.845,338,250.565,338,263.618,338C276.672,338,289.059,338,295.252,338L301.445,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_F_3" d="M177.617,466L185.202,466C192.786,466,207.956,466,221.544,466C235.132,466,247.138,466,258.478,466C269.818,466,280.491,466,285.827,466L291.164,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_G_4" d="M138.251,493L152.397,509.833C166.543,526.667,194.834,560.333,212.104,577.167C229.375,594,235.625,594,241.208,594C246.792,594,251.708,594,254.167,594L256.625,594"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_5" d="M138.251,823L152.397,806.167C166.543,789.333,194.834,755.667,216.153,738.833C237.473,722,251.82,722,265.501,722C279.182,722,292.197,722,298.704,722L305.211,722"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_J_6" d="M173.438,850L181.719,850C190,850,206.563,850,220.592,850C234.622,850,246.12,850,256.951,850C267.781,850,277.945,850,283.027,850L288.109,850"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_K_7" d="M138.251,877L152.397,893.833C166.543,910.667,194.834,944.333,214.498,961.167C234.163,978,245.201,978,255.572,978C265.943,978,275.647,978,280.499,978L285.352,978"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_M_8" d="M160.94,1143L171.305,1136.833C181.669,1130.667,202.397,1118.333,217.764,1112.167C233.13,1106,243.135,1106,252.474,1106C261.813,1106,270.484,1106,274.82,1106L279.156,1106"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_N_9" d="M160.94,1197L171.305,1203.167C181.669,1209.333,202.397,1221.667,218.359,1227.833C234.322,1234,245.518,1234,256.048,1234C266.578,1234,276.441,1234,281.373,1234L286.305,1234"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 146)" id="flowchart-A-11925" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>缓冲池优化</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 82)" id="flowchart-B-11926" class="node default"><rect height="78" width="236.78125" y="-39" x="-118.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-88.390625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="176.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_buffer_pool_size<br>缓冲池大小</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 210)" id="flowchart-C-11928" class="node default"><rect height="78" width="275.953125" y="-39" x="-137.9765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-107.9765625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="215.953125"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_buffer_pool_instances<br>缓冲池实例数</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 466)" id="flowchart-D-11929" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>日志优化</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 338)" id="flowchart-E-11930" class="node default"><rect height="78" width="206.734375" y="-39" x="-103.3671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-73.3671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="146.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_log_file_size<br>重做日志大小</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 466)" id="flowchart-F-11932" class="node default"><rect height="78" width="227.296875" y="-39" x="-113.6484375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-83.6484375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="167.296875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_log_buffer_size<br>日志缓冲区大小</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 594)" id="flowchart-G-11934" class="node default"><rect height="78" width="296.375" y="-39" x="-148.1875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-118.1875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="236.375"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_flush_log_at_trx_commit<br>日志刷新策略</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 850)" id="flowchart-H-11935" class="node default"><rect height="54" width="115.75" y="-27" x="-57.875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>I/O优化</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 722)" id="flowchart-I-11936" class="node default"><rect height="78" width="199.203125" y="-39" x="-99.6015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-69.6015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="139.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_io_capacity<br>I/O容量设置</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 850)" id="flowchart-J-11938" class="node default"><rect height="78" width="233.40625" y="-39" x="-116.703125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-86.703125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="173.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_read_io_threads<br>读I/O线程数</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 978)" id="flowchart-K-11940" class="node default"><rect height="78" width="238.921875" y="-39" x="-119.4609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-89.4609375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="178.921875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_write_io_threads<br>写I/O线程数</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 1170)" id="flowchart-L-11941" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>锁优化</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 1106)" id="flowchart-M-11942" class="node default"><rect height="78" width="251.3125" y="-39" x="-125.65625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-95.65625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="191.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_lock_wait_timeout<br>锁等待超时</p></span></div></foreignObject></g></g><g transform="translate(408.8125, 1234)" id="flowchart-N-11944" class="node default"><rect height="78" width="237.015625" y="-39" x="-118.5078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-88.5078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="177.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>innodb_deadlock_detect<br>死锁检测</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_119"><span class="control" id="-tuqa9y_123">详细参数说明：</span></p><ol class="list _decimal" id="-tuqa9y_120" type="1"><li class="list__item" id="-tuqa9y_124"><p id="-tuqa9y_126"><span class="control" id="-tuqa9y_128">缓冲池优化</span></p><div class="code-block" data-lang="sql">
-- 查看缓冲池使用情况
SHOW ENGINE INNODB STATUS\G

-- 缓冲池命中率应该大于99%
SELECT 
    (1 - (Innodb_buffer_pool_reads / Innodb_buffer_pool_read_requests)) * 100 
    AS buffer_pool_hit_rate
FROM 
    (SELECT variable_value AS Innodb_buffer_pool_reads 
     FROM performance_schema.global_status 
     WHERE variable_name = 'Innodb_buffer_pool_reads') AS reads,
    (SELECT variable_value AS Innodb_buffer_pool_read_requests 
     FROM performance_schema.global_status 
     WHERE variable_name = 'Innodb_buffer_pool_read_requests') AS requests;
</div></li><li class="list__item" id="-tuqa9y_125"><p id="-tuqa9y_129"><span class="control" id="-tuqa9y_131">I/O容量设置</span></p><div class="code-block" data-lang="sql">
-- 根据存储设备调整I/O容量
-- SSD: 2000-20000 IOPS
-- HDD: 200-2000 IOPS
SET GLOBAL innodb_io_capacity = 2000;
SET GLOBAL innodb_io_capacity_max = 4000;
</div></li></ol></section></section><section class="chapter"><h2 id="-tuqa9y_7" data-toc="-tuqa9y_7">📊 监控分析</h2><section class="chapter"><h3 id="q6-mysql" data-toc="q6-mysql">Q6: 如何监控MySQL性能？有哪些重要指标？</h3><p id="-tuqa9y_134"><span class="control" id="-tuqa9y_141">答案：</span></p><p id="-tuqa9y_135"><span class="control" id="-tuqa9y_142">MySQL性能监控体系：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 522.65625 1188"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="522.65625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="性能监控维度" class="cluster"><rect height="1172" width="506.65625" y="8" x="8" style=""></rect><g transform="translate(213.25, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>性能监控维度</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M149.554,119L159.147,112.833C168.739,106.667,187.924,94.333,204.195,88.167C220.466,82,233.823,82,246.513,82C259.203,82,271.227,82,277.238,82L283.25,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M149.554,173L159.147,179.167C168.739,185.333,187.924,197.667,201.029,203.833C214.134,210,221.159,210,227.517,210C233.875,210,239.566,210,242.412,210L245.258,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_2" d="M128.555,439L141.647,422.167C154.739,405.333,180.924,371.667,201.428,354.833C221.931,338,236.753,338,250.908,338C265.063,338,278.551,338,285.295,338L292.039,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_F_3" d="M169.609,466L175.859,466C182.109,466,194.609,466,207.259,466C219.909,466,232.708,466,244.841,466C256.974,466,268.44,466,274.173,466L279.906,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_G_4" d="M128.555,493L141.647,509.833C154.739,526.667,180.924,560.333,197.142,577.167C213.359,594,219.609,594,225.193,594C230.776,594,235.693,594,238.151,594L240.609,594"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_5" d="M149.554,759L159.147,752.833C168.739,746.667,187.924,734.333,203.825,728.167C219.725,722,232.341,722,244.29,722C256.24,722,267.522,722,273.163,722L278.805,722"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_J_6" d="M149.554,813L159.147,819.167C168.739,825.333,187.924,837.667,202.527,843.833C217.129,850,227.148,850,236.501,850C245.854,850,254.54,850,258.883,850L263.227,850"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_L_7" d="M149.554,1015L159.147,1008.833C168.739,1002.667,187.924,990.333,202.001,984.167C216.078,978,225.047,978,233.349,978C241.651,978,249.286,978,253.104,978L256.922,978"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_M_8" d="M149.554,1069L159.147,1075.167C168.739,1081.333,187.924,1093.667,200.842,1099.833C213.76,1106,220.411,1106,226.396,1106C232.38,1106,237.698,1106,240.357,1106L243.016,1106"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(107.5546875, 146)" id="flowchart-A-11962" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>连接监控</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 82)" id="flowchart-B-11963" class="node default"><rect height="78" width="147.265625" y="-39" x="-73.6328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-43.6328125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="87.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Connections<br>当前连接数</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 210)" id="flowchart-C-11965" class="node default"><rect height="78" width="223.25" y="-39" x="-111.625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-81.625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="163.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Max_used_connections<br>历史最大连接数</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 466)" id="flowchart-D-11966" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询监控</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 338)" id="flowchart-E-11967" class="node default"><rect height="78" width="129.6875" y="-39" x="-64.84375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-34.84375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="69.6875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Questions<br>总查询数</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 466)" id="flowchart-F-11969" class="node default"><rect height="78" width="153.953125" y="-39" x="-76.9765625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-46.9765625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="93.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Slow_queries<br>慢查询数</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 594)" id="flowchart-G-11971" class="node default"><rect height="78" width="232.546875" y="-39" x="-116.2734375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-86.2734375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="172.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Com_select/Com_insert<br>各类操作统计</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 786)" id="flowchart-H-11972" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>缓存监控</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 722)" id="flowchart-I-11973" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Qcache_hits<br>查询缓存命中</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 850)" id="flowchart-J-11975" class="node default"><rect height="78" width="187.3125" y="-39" x="-93.65625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-63.65625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="127.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Key_buffer_usage<br>索引缓冲使用率</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 1042)" id="flowchart-K-11976" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>锁监控</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 978)" id="flowchart-L-11977" class="node default"><rect height="78" width="199.921875" y="-39" x="-99.9609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-69.9609375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="139.921875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Table_locks_waited<br>表锁等待</p></span></div></foreignObject></g></g><g transform="translate(360.8828125, 1106)" id="flowchart-M-11979" class="node default"><rect height="78" width="227.734375" y="-39" x="-113.8671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-83.8671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="167.734375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Innodb_row_lock_waits<br>行锁等待</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_137"><span class="control" id="-tuqa9y_143">重要性能指标：</span></p><div class="table-wrapper"><table class="wide" id="-tuqa9y_138"><thead><tr class="ijRowHead" id="-tuqa9y_144"><th id="-tuqa9y_149"><p>指标类型</p></th><th id="-tuqa9y_150"><p>关键指标</p></th><th id="-tuqa9y_151"><p>正常范围</p></th><th id="-tuqa9y_152"><p>异常处理</p></th></tr></thead><tbody><tr id="-tuqa9y_145"><td id="-tuqa9y_153"><p><span class="control" id="-tuqa9y_157">连接</span></p></td><td id="-tuqa9y_154"><p>Threads_connected</p></td><td id="-tuqa9y_155"><p>&lt; max_connections的80%</p></td><td id="-tuqa9y_156"><p>增加连接池，优化连接管理</p></td></tr><tr id="-tuqa9y_146"><td id="-tuqa9y_158"><p><span class="control" id="-tuqa9y_162">查询</span></p></td><td id="-tuqa9y_159"><p>Questions/second</p></td><td id="-tuqa9y_160"><p>根据业务</p></td><td id="-tuqa9y_161"><p>分析慢查询，优化SQL</p></td></tr><tr id="-tuqa9y_147"><td id="-tuqa9y_163"><p><span class="control" id="-tuqa9y_167">缓存</span></p></td><td id="-tuqa9y_164"><p>Innodb_buffer_pool_hit_rate</p></td><td id="-tuqa9y_165"><p>&gt; 99%</p></td><td id="-tuqa9y_166"><p>增加buffer_pool_size</p></td></tr><tr id="-tuqa9y_148"><td id="-tuqa9y_168"><p><span class="control" id="-tuqa9y_172">锁</span></p></td><td id="-tuqa9y_169"><p>Innodb_row_lock_time_avg</p></td><td id="-tuqa9y_170"><p>&lt; 100ms</p></td><td id="-tuqa9y_171"><p>优化索引，减少锁竞争</p></td></tr></tbody></table></div><p id="-tuqa9y_139"><span class="control" id="-tuqa9y_173">监控命令示例：</span></p><div class="code-block" data-lang="sql">
-- 查看服务器状态
SHOW GLOBAL STATUS;

-- 查看当前连接
SHOW PROCESSLIST;

-- 查看InnoDB状态
SHOW ENGINE INNODB STATUS\G

-- 查看表状态
SHOW TABLE STATUS LIKE 'table_name'\G

-- 实时监控脚本
SELECT 
    CONCAT(ROUND(variable_value/1024/1024, 2), ' MB') AS buffer_pool_size
FROM performance_schema.global_variables 
WHERE variable_name = 'innodb_buffer_pool_size';

-- 查看慢查询统计
SELECT 
    schema_name,
    SUM(count_star) as total_queries,
    SUM(sum_timer_wait)/1000000000000 as total_time_sec,
    AVG(avg_timer_wait)/1000000000000 as avg_time_sec
FROM performance_schema.events_statements_summary_by_digest 
WHERE schema_name IS NOT NULL 
GROUP BY schema_name 
ORDER BY total_time_sec DESC;
</div></section><section class="chapter"><h3 id="q7-performance-schema" data-toc="q7-performance-schema">Q7: 如何使用Performance Schema进行性能分析？</h3><p id="-tuqa9y_174"><span class="control" id="-tuqa9y_179">答案：</span></p><p id="-tuqa9y_175"><span class="control" id="-tuqa9y_180">Performance Schema核心功能：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 499.953125 676"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="499.953125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="subGraph0" class="cluster"><rect height="660" width="483.953125" y="8" x="8" style=""></rect><g transform="translate(158.4765625, 8)" class="cluster-label"><foreignObject height="24" width="183"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Performance Schema组件</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M169.609,82L175.859,82C182.109,82,194.609,82,203.984,82C213.359,82,219.609,82,225.193,82C230.776,82,235.693,82,238.151,82L240.609,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M169.609,210L175.859,210C182.109,210,194.609,210,205.747,210C216.884,210,226.659,210,235.767,210C244.875,210,253.316,210,257.537,210L261.758,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M165.43,338L172.376,338C179.323,338,193.216,338,204.897,338C216.578,338,226.047,338,234.849,338C243.651,338,251.786,338,255.854,338L259.922,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M161.594,466L169.18,466C176.766,466,191.938,466,204.169,466C216.401,466,225.693,466,234.318,466C242.943,466,250.901,466,254.88,466L258.859,466"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_4" d="M169.609,594L175.859,594C182.109,594,194.609,594,206.221,594C217.833,594,228.557,594,238.615,594C248.672,594,258.063,594,262.758,594L267.453,594"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(107.5546875, 82)" id="flowchart-A-12006" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>语句分析</p></span></div></foreignObject></g></g><g transform="translate(349.53125, 82)" id="flowchart-B-12007" class="node default"><rect height="78" width="209.84375" y="-39" x="-104.921875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-74.921875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="149.84375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>events_statements_*<br>SQL语句性能统计</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 210)" id="flowchart-C-12008" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>等待事件</p></span></div></foreignObject></g></g><g transform="translate(349.53125, 210)" id="flowchart-D-12009" class="node default"><rect height="78" width="167.546875" y="-39" x="-83.7734375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-53.7734375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="107.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>events_waits_*<br>等待事件分析</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 338)" id="flowchart-E-12010" class="node default"><rect height="54" width="115.75" y="-27" x="-57.875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-27.875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="55.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>I/O分析</p></span></div></foreignObject></g></g><g transform="translate(349.53125, 338)" id="flowchart-F-12011" class="node default"><rect height="78" width="171.21875" y="-39" x="-85.609375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-55.609375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="111.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>file_summary_*<br>文件I/O统计</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 466)" id="flowchart-G-12012" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>锁分析</p></span></div></foreignObject></g></g><g transform="translate(349.53125, 466)" id="flowchart-H-12013" class="node default"><rect height="78" width="173.34375" y="-39" x="-86.671875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.671875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="113.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>metadata_locks<br>元数据锁信息</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 594)" id="flowchart-I-12014" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>连接分析</p></span></div></foreignObject></g></g><g transform="translate(349.53125, 594)" id="flowchart-J-12015" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>accounts<br>用户连接统计</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_177"><span class="control" id="-tuqa9y_181">常用分析查询：</span></p><div class="code-block" data-lang="sql">
-- 1. 查看最耗时的SQL语句
SELECT 
    digest_text,
    count_star,
    avg_timer_wait/1000000000000 as avg_time_sec,
    sum_timer_wait/1000000000000 as total_time_sec
FROM performance_schema.events_statements_summary_by_digest 
ORDER BY avg_timer_wait DESC 
LIMIT 10;

-- 2. 查看表的I/O统计
SELECT 
    object_schema,
    object_name,
    count_read,
    count_write,
    sum_timer_read/1000000000000 as read_time_sec,
    sum_timer_write/1000000000000 as write_time_sec
FROM performance_schema.table_io_waits_summary_by_table 
WHERE object_schema NOT IN ('mysql', 'performance_schema', 'information_schema')
ORDER BY sum_timer_read + sum_timer_write DESC 
LIMIT 10;

-- 3. 查看当前锁等待
SELECT 
    r.trx_id waiting_trx_id,
    r.trx_mysql_thread_id waiting_thread,
    r.trx_query waiting_query,
    b.trx_id blocking_trx_id,
    b.trx_mysql_thread_id blocking_thread,
    b.trx_query blocking_query
FROM information_schema.innodb_lock_waits w
INNER JOIN information_schema.innodb_trx b ON b.trx_id = w.blocking_trx_id
INNER JOIN information_schema.innodb_trx r ON r.trx_id = w.requesting_trx_id;

-- 4. 查看文件I/O统计
SELECT 
    file_name,
    event_name,
    count_star,
    sum_timer_wait/1000000000000 as total_time_sec,
    avg_timer_wait/1000000000000 as avg_time_sec
FROM performance_schema.file_summary_by_event_name 
WHERE event_name LIKE '%write%' OR event_name LIKE '%read%'
ORDER BY sum_timer_wait DESC 
LIMIT 10;
</div></section></section><section class="chapter"><h2 id="-tuqa9y_8" data-toc="-tuqa9y_8">🚀 架构优化</h2><section class="chapter"><h3 id="q8-mysql" data-toc="q8-mysql">Q8: 如何实现MySQL读写分离？有什么注意事项？</h3><p id="-tuqa9y_184"><span class="control" id="-tuqa9y_193">答案：</span></p><p id="-tuqa9y_185"><span class="control" id="-tuqa9y_194">读写分离架构：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1571.03125 312"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1571.03125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 34)" class="root"><g class="clusters"><g data-look="classic" id="数据流向" class="cluster"><rect height="228" width="430.25" y="8" x="8" style=""></rect><g transform="translate(191.0703125, 8)" class="cluster-label"><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据流向</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_7" d="M153.578,70L159.828,70C166.078,70,178.578,70,189.288,70C199.999,70,208.919,70,217.173,70C225.427,70,233.014,70,236.808,70L240.602,70"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_8" d="M153.578,174L159.828,174C166.078,174,178.578,174,187.953,174C197.328,174,203.578,174,209.161,174C214.745,174,219.661,174,222.12,174L224.578,174"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(99.5390625, 70)" id="flowchart-G-12045" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>写请求</p></span></div></foreignObject></g></g><g transform="translate(314.6640625, 70)" id="flowchart-H-12046" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>路由到主库</p></span></div></foreignObject></g></g><g transform="translate(99.5390625, 174)" id="flowchart-I-12047" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>读请求</p></span></div></foreignObject></g></g><g transform="translate(314.6640625, 174)" id="flowchart-J-12048" class="node default"><rect height="54" width="172.171875" y="-27" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>负载均衡到从库</p></span></div></foreignObject></g></g></g></g><g transform="translate(480.25, 0)" class="root"><g class="clusters"><g data-look="classic" id="读写分离架构" class="cluster"><rect height="296" width="1074.78125" y="8" x="8" style=""></rect><g transform="translate(497.3125, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>读写分离架构</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M153.578,129L159.828,129C166.078,129,178.578,129,187.953,129C197.328,129,203.578,129,209.161,129C214.745,129,219.661,129,222.12,129L224.578,129"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_1" d="M408.797,129L415.047,129C421.297,129,433.797,129,443.172,129C452.547,129,458.797,129,464.38,129C469.964,129,474.88,129,477.339,129L479.797,129"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_D_2" d="M385.941,90L396,84.167C406.06,78.333,426.178,66.667,454.534,60.833C482.891,55,519.484,55,556.078,55C592.672,55,629.266,55,664.155,55C699.044,55,732.229,55,765.414,55C798.599,55,831.784,55,851.501,56.062C871.219,57.123,877.469,59.247,883.088,61.156C888.706,63.065,893.694,64.759,896.188,65.606L898.681,66.454"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_E_3" d="M385.941,168L396,173.833C406.06,179.667,426.178,191.333,454.534,197.167C482.891,203,519.484,203,556.078,203C592.672,203,629.266,203,664.155,203C699.044,203,732.229,203,765.414,203C798.599,203,831.784,203,851.501,203.775C871.219,204.549,877.469,206.099,883.072,207.488C888.675,208.877,893.63,210.106,896.108,210.72L898.586,211.334"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_F_4" d="M628.359,129L634.609,129C640.859,129,653.359,129,662.734,129C672.109,129,678.359,129,683.943,129C689.526,129,694.443,129,696.901,129L699.359,129"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_D_5" d="M827.469,129L833.719,129C839.969,129,852.469,129,861.844,127.938C871.219,126.877,877.469,124.753,883.088,122.844C888.706,120.935,893.694,119.241,896.188,118.394L898.681,117.546"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_E_6" d="M786.414,156L799.506,172.833C812.599,189.667,838.784,223.333,855.001,239.392C871.219,255.451,877.469,253.901,883.072,252.512C888.675,251.123,893.63,249.894,896.108,249.28L898.586,248.666"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(99.5390625, 129)" id="flowchart-A-12031" class="node default"><rect height="54" width="108.078125" y="-27" x="-54.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-24.0390625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="48.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>应用层</p></span></div></foreignObject></g></g><g transform="translate(318.6875, 129)" id="flowchart-B-12032" class="node default"><rect height="78" width="180.21875" y="-39" x="-90.109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-60.109375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="120.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>代理层<br>MyCAT/ProxySQL</p></span></div></foreignObject></g></g><g transform="translate(556.078125, 129)" id="flowchart-C-12034" class="node default"><rect height="78" width="144.5625" y="-39" x="-72.28125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-42.28125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="84.5625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主库 Master<br>处理写操作</p></span></div></foreignObject></g></g><g transform="translate(973.875, 92)" id="flowchart-D-12036" class="node default"><rect height="78" width="142.8125" y="-39" x="-71.40625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.40625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="82.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>从库 Slave1<br>处理读操作</p></span></div></foreignObject></g></g><g transform="translate(973.875, 230)" id="flowchart-E-12038" class="node default"><rect height="78" width="142.8125" y="-39" x="-71.40625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-41.40625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="82.8125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>从库 Slave2<br>处理读操作</p></span></div></foreignObject></g></g><g transform="translate(765.4140625, 129)" id="flowchart-F-12040" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主从复制</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_187"><span class="control" id="-tuqa9y_195">实现方案对比：</span></p><div class="table-wrapper"><table class="wide" id="-tuqa9y_188"><thead><tr class="ijRowHead" id="-tuqa9y_196"><th id="-tuqa9y_200"><p>实现方式</p></th><th id="-tuqa9y_201"><p>优点</p></th><th id="-tuqa9y_202"><p>缺点</p></th><th id="-tuqa9y_203"><p>适用场景</p></th></tr></thead><tbody><tr id="-tuqa9y_197"><td id="-tuqa9y_204"><p><span class="control" id="-tuqa9y_208">应用层分离</span></p></td><td id="-tuqa9y_205"><p>实现简单，性能好</p></td><td id="-tuqa9y_206"><p>代码耦合度高</p></td><td id="-tuqa9y_207"><p>小型应用</p></td></tr><tr id="-tuqa9y_198"><td id="-tuqa9y_209"><p><span class="control" id="-tuqa9y_213">代理层分离</span></p></td><td id="-tuqa9y_210"><p>透明化，支持多语言</p></td><td id="-tuqa9y_211"><p>增加网络延迟</p></td><td id="-tuqa9y_212"><p>中大型应用</p></td></tr><tr id="-tuqa9y_199"><td id="-tuqa9y_214"><p><span class="control" id="-tuqa9y_218">框架层分离</span></p></td><td id="-tuqa9y_215"><p>配置简单</p></td><td id="-tuqa9y_216"><p>依赖特定框架</p></td><td id="-tuqa9y_217"><p>特定技术栈</p></td></tr></tbody></table></div><p id="-tuqa9y_189"><span class="control" id="-tuqa9y_219">注意事项和解决方案：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 526.375 572"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="526.375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="读写分离问题及解决" class="cluster"><rect height="556" width="510.375" y="8" x="8" style=""></rect><g transform="translate(191.078125, 8)" class="cluster-label"><foreignObject height="24" width="144.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>读写分离问题及解决</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M177.617,94L185.202,94C192.786,94,207.956,94,221.336,94C234.716,94,246.307,94,257.232,94C268.156,94,278.414,94,283.543,94L288.672,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M185.625,234L191.875,234C198.125,234,210.625,234,222.003,234C233.382,234,243.638,234,253.228,234C262.818,234,271.741,234,276.202,234L280.664,234"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M185.625,362L191.875,362C198.125,362,210.625,362,220.668,362C230.711,362,238.297,362,245.216,362C252.135,362,258.388,362,261.514,362L264.641,362"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M177.617,490L185.202,490C192.786,490,207.956,490,218.665,490C229.375,490,235.625,490,241.208,490C246.792,490,251.708,490,254.167,490L256.625,490"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 94)" id="flowchart-A-12049" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主从延迟</p></span></div></foreignObject></g></g><g transform="translate(370.75, 94)" id="flowchart-B-12050" class="node default"><rect height="102" width="156.15625" y="-51" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>强制主库读取<br>设置延迟阈值<br>业务容忍延迟</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 234)" id="flowchart-C-12051" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主从不一致</p></span></div></foreignObject></g></g><g transform="translate(370.75, 234)" id="flowchart-D-12052" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>重要数据走主库<br>最终一致性设计</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 362)" id="flowchart-E-12053" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>连接池管理</p></span></div></foreignObject></g></g><g transform="translate(370.75, 362)" id="flowchart-F-12054" class="node default"><rect height="78" width="204.21875" y="-39" x="-102.109375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-72.109375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="144.21875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主从分别配置连接池<br>监控连接使用情况</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 490)" id="flowchart-G-12055" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>故障切换</p></span></div></foreignObject></g></g><g transform="translate(370.75, 490)" id="flowchart-H-12056" class="node default"><rect height="78" width="220.25" y="-39" x="-110.125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-80.125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="160.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>主库故障时的切换策略<br>从库升级为主库</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_191"><span class="control" id="-tuqa9y_220">配置示例（使用ProxySQL）：</span></p><div class="code-block" data-lang="sql">
-- ProxySQL配置示例
INSERT INTO mysql_servers(hostgroup_id, hostname, port, weight) VALUES
(0, '192.168.1.10', 3306, 1000),  -- 主库
(1, '192.168.1.11', 3306, 800),   -- 从库1
(1, '192.168.1.12', 3306, 800);   -- 从库2

-- 配置路由规则
INSERT INTO mysql_query_rules(rule_id, active, match_pattern, destination_hostgroup) VALUES
(1, 1, '^SELECT.*', 1),    -- 读请求路由到从库
(2, 1, '^INSERT.*', 0),    -- 写请求路由到主库
(3, 1, '^UPDATE.*', 0),
(4, 1, '^DELETE.*', 0);
</div></section><section class="chapter"><h3 id="q9" data-toc="q9">Q9: 什么情况下需要分库分表？如何设计分库分表策略？</h3><p id="-tuqa9y_221"><span class="control" id="-tuqa9y_228">答案：</span></p><p id="-tuqa9y_222"><span class="control" id="-tuqa9y_229">分库分表触发条件：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1074.40625 548"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="1074.40625" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="分库分表策略" class="cluster"><rect height="532" width="510.375" y="8" x="8" style=""></rect><g transform="translate(215.109375, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分库分表策略</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_4" d="M169.609,82L175.859,82C182.109,82,194.609,82,203.984,82C213.359,82,219.609,82,225.193,82C230.776,82,235.693,82,238.151,82L240.609,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_L_5" d="M169.609,210L175.859,210C182.109,210,194.609,210,207.394,210C220.178,210,233.247,210,245.65,210C258.052,210,269.788,210,275.656,210L281.523,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M_N_6" d="M169.609,338L175.859,338C182.109,338,194.609,338,207.322,338C220.035,338,232.961,338,245.22,338C257.479,338,269.072,338,274.868,338L280.664,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_O_P_7" d="M169.609,466L175.859,466C182.109,466,194.609,466,207.322,466C220.035,466,232.961,466,245.22,466C257.479,466,269.072,466,274.868,466L280.664,466"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(107.5546875, 82)" id="flowchart-I-12080" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>水平分库</p></span></div></foreignObject></g></g><g transform="translate(362.7421875, 82)" id="flowchart-J-12081" class="node default"><rect height="78" width="236.265625" y="-39" x="-118.1328125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-88.1328125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="176.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>按业务模块分库<br>用户库、订单库、商品库</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 210)" id="flowchart-K-12082" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>水平分表</p></span></div></foreignObject></g></g><g transform="translate(362.7421875, 210)" id="flowchart-L-12083" class="node default"><rect height="78" width="154.4375" y="-39" x="-77.21875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-47.21875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="94.4375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>按时间分表<br>按用户ID分表</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 338)" id="flowchart-M-12084" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>垂直分库</p></span></div></foreignObject></g></g><g transform="translate(362.7421875, 338)" id="flowchart-N-12085" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>按表功能分库<br>读写分离</p></span></div></foreignObject></g></g><g transform="translate(107.5546875, 466)" id="flowchart-O-12086" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>垂直分表</p></span></div></foreignObject></g></g><g transform="translate(362.7421875, 466)" id="flowchart-P-12087" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>大字段拆分<br>冷热数据分离</p></span></div></foreignObject></g></g></g></g><g transform="translate(560.375, 0)" class="root"><g class="clusters"><g data-look="classic" id="分库分表场景" class="cluster"><rect height="532" width="498.03125" y="8" x="8" style=""></rect><g transform="translate(208.9375, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分库分表场景</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M185.625,82L191.875,82C198.125,82,210.625,82,220,82C229.375,82,235.625,82,241.208,82C246.792,82,251.708,82,254.167,82L256.625,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M177.617,210L185.202,210C192.786,210,207.956,210,219.266,210C230.576,210,238.026,210,244.81,210C251.594,210,257.711,210,260.77,210L263.828,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M177.617,338L185.202,338C192.786,338,207.956,338,219.486,338C231.017,338,238.909,338,246.134,338C253.359,338,259.918,338,263.197,338L266.477,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M177.617,466L185.202,466C192.786,466,207.956,466,219.486,466C231.017,466,238.909,466,246.134,466C253.359,466,259.918,466,263.197,466L266.477,466"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 82)" id="flowchart-A-12072" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据量问题</p></span></div></foreignObject></g></g><g transform="translate(364.578125, 82)" id="flowchart-B-12073" class="node default"><rect height="78" width="207.90625" y="-39" x="-103.953125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-73.953125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="147.90625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>单表数据量 &gt; 1000万<br>查询性能下降明显</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 210)" id="flowchart-C-12074" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>并发问题</p></span></div></foreignObject></g></g><g transform="translate(364.578125, 210)" id="flowchart-D-12075" class="node default"><rect height="78" width="193.5" y="-39" x="-96.75" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-66.75, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="133.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>单库连接数不够<br>CPU/内存资源瓶颈</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 338)" id="flowchart-E-12076" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>存储问题</p></span></div></foreignObject></g></g><g transform="translate(364.578125, 338)" id="flowchart-F-12077" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>单库容量超限<br>备份恢复时间过长</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 466)" id="flowchart-G-12078" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>业务问题</p></span></div></foreignObject></g></g><g transform="translate(364.578125, 466)" id="flowchart-H-12079" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>不同业务模块<br>数据访问模式不同</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_224"><span class="control" id="-tuqa9y_230">分片键选择原则：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 990.609375 548"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="990.609375" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 64)" class="root"><g class="clusters"><g data-look="classic" id="常见分片策略" class="cluster"><rect height="404" width="478.328125" y="8" x="8" style=""></rect><g transform="translate(199.0859375, 8)" class="cluster-label"><foreignObject height="24" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>常见分片策略</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_4" d="M177.617,82L185.202,82C192.786,82,207.956,82,219.333,82C230.711,82,238.297,82,245.216,82C252.135,82,258.388,82,261.514,82L264.641,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_5" d="M177.617,210L185.202,210C192.786,210,207.956,210,218.665,210C229.375,210,235.625,210,241.208,210C246.792,210,251.708,210,254.167,210L256.625,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_K_6" d="M185.625,338L191.875,338C198.125,338,210.625,338,220.668,338C230.711,338,238.297,338,245.216,338C252.135,338,258.388,338,261.514,338L264.641,338"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 82)" id="flowchart-F-12111" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>取模分片</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 82)" id="flowchart-G-12112" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>user_id % 16<br>简单但扩容困难</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 210)" id="flowchart-H-12113" class="node default"><rect height="54" width="124.109375" y="-27" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>范围分片</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 210)" id="flowchart-I-12114" class="node default"><rect height="78" width="188.203125" y="-39" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>按时间范围<br>易扩容但可能倾斜</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 338)" id="flowchart-J-12115" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>一致性哈希</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 338)" id="flowchart-K-12116" class="node default"><rect height="78" width="172.171875" y="-39" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>平衡性和扩展性<br>实现复杂</p></span></div></foreignObject></g></g></g></g><g transform="translate(528.328125, 0)" class="root"><g class="clusters"><g data-look="classic" id="分片键选择" class="cluster"><rect height="532" width="446.28125" y="8" x="8" style=""></rect><g transform="translate(191.078125, 8)" class="cluster-label"><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分片键选择</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M130.688,247L146.095,219.5C161.501,192,192.313,137,210.844,109.5C229.375,82,235.625,82,241.208,82C246.792,82,251.708,82,254.167,82L256.625,82"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_C_1" d="M160.94,247L171.305,240.833C181.669,234.667,202.397,222.333,215.886,216.167C229.375,210,235.625,210,241.208,210C246.792,210,251.708,210,254.167,210L256.625,210"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_D_2" d="M160.94,301L171.305,307.167C181.669,313.333,202.397,325.667,215.886,331.833C229.375,338,235.625,338,241.208,338C246.792,338,251.708,338,254.167,338L256.625,338"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_E_3" d="M130.688,301L146.095,328.5C161.501,356,192.313,411,210.844,438.5C229.375,466,235.625,466,241.208,466C246.792,466,251.708,466,254.167,466L256.625,466"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 274)" id="flowchart-A-12103" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分片键要求</p></span></div></foreignObject></g></g><g transform="translate(338.703125, 82)" id="flowchart-B-12104" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>分布均匀<br>避免数据倾斜</p></span></div></foreignObject></g></g><g transform="translate(338.703125, 210)" id="flowchart-C-12106" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>查询友好<br>避免跨库查询</p></span></div></foreignObject></g></g><g transform="translate(338.703125, 338)" id="flowchart-D-12108" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>扩展性好<br>支持平滑扩容</p></span></div></foreignObject></g></g><g transform="translate(338.703125, 466)" id="flowchart-E-12110" class="node default"><rect height="78" width="156.15625" y="-39" x="-78.078125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-48.078125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="96.15625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>业务相关<br>符合业务逻辑</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_226"><span class="control" id="-tuqa9y_231">分库分表实践案例：</span></p><div class="code-block" data-lang="sql">
-- 分表策略示例：用户表按用户ID取模分16张表
-- 原始表：users
-- 分表：users_00, users_01, ..., users_15

-- 分片路由逻辑
function getTableName(userId) {
    suffix = String.format(&quot;%02d&quot;, userId % 16);
    return &quot;users_&quot; + suffix;
}

-- 查询改写
-- 原查询：SELECT * FROM users WHERE user_id = 12345
-- 路由后：SELECT * FROM users_01 WHERE user_id = 12345

-- 跨分片查询需要union
SELECT * FROM users_00 WHERE create_time &gt; '2023-01-01'
UNION ALL
SELECT * FROM users_01 WHERE create_time &gt; '2023-01-01'
UNION ALL
...
SELECT * FROM users_15 WHERE create_time &gt; '2023-01-01';
</div></section></section><section class="chapter"><h2 id="-tuqa9y_9" data-toc="-tuqa9y_9">💡 性能调优最佳实践</h2><section class="chapter"><h3 id="q10-mysql" data-toc="q10-mysql">Q10: MySQL性能调优的完整方案是什么？</h3><p id="-tuqa9y_233"><span class="control" id="-tuqa9y_238">答案：</span></p><p id="-tuqa9y_234"><span class="control" id="-tuqa9y_239">性能调优层次结构：</span></p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 494.328125 948"  class="flowchart" xmlns="http://www.w3.org/2000/svg" width="494.328125" id="mermaid"><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="MySQL性能调优体系" class="cluster"><rect height="932" width="478.328125" y="8" x="8" style=""></rect><g transform="translate(176.1015625, 8)" class="cluster-label"><foreignObject height="24" width="142.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MySQL性能调优体系</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M185.625,94L191.875,94C198.125,94,210.625,94,220.798,94C230.97,94,238.815,94,245.993,94C253.172,94,259.684,94,262.939,94L266.195,94"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_1" d="M185.625,246L191.875,246C198.125,246,210.625,246,220,246C229.375,246,235.625,246,241.208,246C246.792,246,251.708,246,254.167,246L256.625,246"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_2" d="M185.625,398L191.875,398C198.125,398,210.625,398,220.755,398C230.885,398,238.646,398,245.74,398C252.833,398,259.26,398,262.474,398L265.688,398"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_H_3" d="M185.625,550L191.875,550C198.125,550,210.625,550,220.668,550C230.711,550,238.297,550,245.216,550C252.135,550,258.388,550,261.514,550L264.641,550"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_4" d="M185.625,702L191.875,702C198.125,702,210.625,702,221.559,702C232.493,702,241.862,702,250.564,702C259.266,702,267.301,702,271.318,702L275.336,702"></path><path marker-end="url(#mermaid_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_L_5" d="M185.625,854L191.875,854C198.125,854,210.625,854,222.671,854C234.716,854,246.307,854,257.232,854C268.156,854,278.414,854,283.543,854L288.672,854"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(115.5625, 94)" id="flowchart-A-12136" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>硬件层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 94)" id="flowchart-B-12137" class="node default"><rect height="102" width="169.0625" y="-51" x="-84.53125" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-54.53125, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="109.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CPU：多核高频<br>内存：足够大<br>存储：SSD磁盘</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 246)" id="flowchart-C-12138" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>系统层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 246)" id="flowchart-D-12139" class="node default"><rect height="102" width="188.203125" y="-51" x="-94.1015625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-64.1015625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="128.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>操作系统参数调优<br>文件系统选择<br>网络配置优化</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 398)" id="flowchart-E-12140" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>配置层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 398)" id="flowchart-F-12141" class="node default"><rect height="102" width="170.078125" y="-51" x="-85.0390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-55.0390625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="110.078125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MySQL参数调优<br>存储引擎选择<br>字符集设置</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 550)" id="flowchart-G-12142" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>设计层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 550)" id="flowchart-H-12143" class="node default"><rect height="102" width="172.171875" y="-51" x="-86.0859375" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-56.0859375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="112.171875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>数据库设计规范<br>索引设计策略<br>表结构优化</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 702)" id="flowchart-I-12144" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>应用层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 702)" id="flowchart-J-12145" class="node default"><rect height="102" width="150.78125" y="-51" x="-75.390625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-45.390625, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="90.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>SQL语句优化<br>连接池使用<br>缓存策略</p></span></div></foreignObject></g></g><g transform="translate(115.5625, 854)" id="flowchart-K-12146" class="node default"><rect height="54" width="140.125" y="-27" x="-70.0625" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-40.0625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="80.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>架构层优化</p></span></div></foreignObject></g></g><g transform="translate(354.7265625, 854)" id="flowchart-L-12147" class="node default"><rect height="102" width="124.109375" y="-51" x="-62.0546875" data-et="node" data-id="abc" style="" class="basic label-container"></rect><g transform="translate(-32.0546875, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="64.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>读写分离<br>分库分表<br>集群部署</p></span></div></foreignObject></g></g></g></g></g></g></g></svg><p id="-tuqa9y_236"><span class="control" id="-tuqa9y_240">完整调优检查清单：</span></p><ol class="list _decimal" id="-tuqa9y_237" type="1"><li class="list__item" id="-tuqa9y_241"><p id="-tuqa9y_245"><span class="control" id="-tuqa9y_247">基础检查</span></p><div class="code-block" data-lang="sql">
-- 查看版本和配置
SELECT VERSION();
SHOW VARIABLES LIKE '%innodb%';

-- 查看状态指标
SHOW GLOBAL STATUS;

-- 检查慢查询
SHOW VARIABLES LIKE 'slow_query%';
</div></li><li class="list__item" id="-tuqa9y_242"><p id="-tuqa9y_248"><span class="control" id="-tuqa9y_250">索引优化</span></p><div class="code-block" data-lang="sql">
-- 查找缺失索引的查询
SELECT * FROM sys.statements_with_runtimes_in_95th_percentile 
WHERE query NOT LIKE '%sys.%' 
ORDER BY avg_latency DESC;

-- 查找未使用的索引
SELECT * FROM sys.schema_unused_indexes;
</div></li><li class="list__item" id="-tuqa9y_243"><p id="-tuqa9y_251"><span class="control" id="-tuqa9y_253">配置优化</span></p><div class="code-block" data-lang="ini">
# 核心参数优化模板
[mysqld]
# 内存分配
innodb_buffer_pool_size = 物理内存的70%

# 连接优化
max_connections = 根据业务调整
thread_cache_size = 256

# I/O优化
innodb_io_capacity = 根据磁盘IOPS调整
innodb_read_io_threads = 8
innodb_write_io_threads = 8

# 日志优化
innodb_log_file_size = 512M
innodb_log_buffer_size = 64M
</div></li><li class="list__item" id="-tuqa9y_244"><p id="-tuqa9y_254"><span class="control" id="-tuqa9y_256">监控体系</span></p><div class="code-block" data-lang="sql">
-- 建立监控视图
CREATE VIEW performance_summary AS
SELECT 
    'Connections' as metric,
    variable_value as current_value,
    NULL as threshold
FROM performance_schema.global_status 
WHERE variable_name = 'Threads_connected'

UNION ALL

SELECT 
    'Slow Queries',
    variable_value,
    '&lt; 1% of total queries'
FROM performance_schema.global_status 
WHERE variable_name = 'Slow_queries';
</div></li></ol></section></section><section class="chapter"><h2 id="-tuqa9y_10" data-toc="-tuqa9y_10">💡 面试技巧</h2><section class="chapter"><h3 id="-tuqa9y_257" data-toc="-tuqa9y_257">高频考点</h3><ol class="list _decimal" id="-tuqa9y_259" type="1"><li class="list__item" id="-tuqa9y_260"><p id="-tuqa9y_265"><span class="control" id="-tuqa9y_266">慢查询分析</span> ：如何发现、分析和优化慢查询</p></li><li class="list__item" id="-tuqa9y_261"><p id="-tuqa9y_267"><span class="control" id="-tuqa9y_268">EXPLAIN使用</span> ：执行计划的分析和优化指导</p></li><li class="list__item" id="-tuqa9y_262"><p id="-tuqa9y_269"><span class="control" id="-tuqa9y_270">配置参数</span> ：重要参数的作用和调优方法</p></li><li class="list__item" id="-tuqa9y_263"><p id="-tuqa9y_271"><span class="control" id="-tuqa9y_272">架构设计</span> ：读写分离和分库分表的设计</p></li><li class="list__item" id="-tuqa9y_264"><p id="-tuqa9y_273"><span class="control" id="-tuqa9y_274">监控体系</span> ：性能监控的指标和工具</p></li></ol></section><section class="chapter"><h3 id="-tuqa9y_258" data-toc="-tuqa9y_258">回答策略</h3><ol class="list _decimal" id="-tuqa9y_275" type="1"><li class="list__item" id="-tuqa9y_278"><p id="-tuqa9y_282"><span class="control" id="-tuqa9y_283">系统性思维</span> ：从多个层面分析性能问题</p></li><li class="list__item" id="-tuqa9y_279"><p id="-tuqa9y_284"><span class="control" id="-tuqa9y_285">数据支撑</span> ：用具体的数据和指标说明问题</p></li><li class="list__item" id="-tuqa9y_280"><p id="-tuqa9y_286"><span class="control" id="-tuqa9y_287">实际经验</span> ：结合具体的优化案例</p></li><li class="list__item" id="-tuqa9y_281"><p id="-tuqa9y_288"><span class="control" id="-tuqa9y_289">工具熟练</span> ：展示对各种分析工具的掌握</p></li></ol><p id="-tuqa9y_277"><span class="control" id="-tuqa9y_290">学习建议</span> ：性能优化是一个系统工程，需要从硬件到应用的全方位考虑。建议通过实际的性能测试和调优实践来加深理解，特别要掌握各种分析工具的使用。</p></section></section><div class="last-modified">09 六月 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="mysql事务与锁qa.html" class="navigation-links__prev">MySQL事务与锁QA</a><a href="mysql高可用与集群qa.html" class="navigation-links__next">MySQL高可用与集群QA</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>